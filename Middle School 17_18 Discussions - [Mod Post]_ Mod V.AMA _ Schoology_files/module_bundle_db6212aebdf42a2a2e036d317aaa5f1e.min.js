(function(){if(window._initPendo){return}window._initPendo=function(b,a,c){if(window._pendoInitialized){return}(function(f,j,h,k,g){var s,r,q,m,l;g=f[k]=f[k]||{};g._q=[];s=["initialize","identify","updateOptions","pageLoad"];for(r=0,q=s.length;r<q;++r){(function(d){g[d]=g[d]||function(){g._q[d===s[0]?"unshift":"push"]([d].concat([].slice.call(arguments,0)))}})(s[r])}m=j.createElement(h);m.async=!0;m.src="https://ustats-cdn.schoology.com/agent/static/"+c+"/pendo.js";l=j.getElementsByTagName(h)[0];l.parentNode.insertBefore(m,l)})(window,document,"script","pendo");pendo.initialize({apiKey:c,visitor:b,account:a});window._pendoInitialized=true}})();function extlinkAttach(b){var h=b==document?$(document.body):$(b);if(h.closest(".sExtlink-processed").length){return}h.addClass("sExtlink-processed");var j=window.location.host.replace(/^(([^\/]+?\.)*)([^\.]{4,})((\.[a-z]{1,4})*)$/,"$3$4"),d=window.location.host.replace(/^(([^\/]+?\.)*)([^\.]{4,})((\.[a-z]{1,4})*)$/,"$1"),c=false,f=false,e,a;if(Drupal.settings.extlink.extSubdomains){e="([^/]*.)?"
}else{if(d=="www."||d==""){e="(www.)?"}else{e=d.replace(".",".")}}a=new RegExp("^https?://"+e+j+"/","i");if(Drupal.settings.extlink.extInclude){c=new RegExp(Drupal.settings.extlink.extInclude.replace(/\\/,"\\"))}if(Drupal.settings.extlink.extExclude){f=new RegExp(Drupal.settings.extlink.extExclude.replace(/\\/,"\\"))}function g(k){var k=k.toLowerCase();if(k.indexOf("http")!==0){return false}if(k.match(a)&&!(c&&k.match(c))){return false}if(f&&k.match(f)){return false}return true}h.on("click","a",function(m){var k=$(this),l=this.href;if(k.hasClass("s-extlink-direct")){return}if(g(l)){m.preventDefault();window.open("/link?path="+encodeURIComponent(k.attr("href")))}})}Drupal.behaviors.extlink=function(b){if(Drupal.settings.extlinkExtras&&Drupal.settings.extlinkExtras.disabled){return}if(typeof sAppLdbGetSecurityLevel=="undefined"){extlinkAttach(b)}else{if(typeof sAppLdbGetSecurityLevel!="undefined"&&sAppLdbGetSecurityLevel()!="restricted"){extlinkAttach(b)}}var a=sCommonGetSetting("extlink","mailtoClass");
if(a){$("a:not(.sExtlink-processed)",b).addClass("sExtlink-processed").each(function(){var d=$(this),c=d.attr("href")||"";if(c.indexOf("mailto:")===0&&d.find("img:first").length===0){d.addClass(a);if(d.css("display")=="inline"){d.after("<span class="+a+"></span>")}}})}};Drupal.behaviors.popups=function(b){Popups.saveSettings();var c=$("body");if(!c.hasClass("popups-processed")){c.addClass("popups-processed");$(document).bind("keydown",Popups.keyHandle);var a=$("#popit");if(a.length){a.remove();Popups.message(a.html())}}if(Drupal.settings.popups&&Drupal.settings.popups.links){jQuery.each(Drupal.settings.popups.links,function(e,d){Popups.attach(b,e,Popups.options(d))})}Popups.attach(b,".popups",Popups.options({updateMethod:"none"}));Popups.attach(b,".popups-form",Popups.options({updateMethod:"ajax"}));Popups.attach(b,".popups-form-reload",Popups.options({updateMethod:"reload"}));Popups.attach(b,".popups-form-noupdate",Popups.options({updateMethod:"none"}))};Popups=function(){};Popups.popupStack=[];
Popups.addedCSS=[];Popups.addedJS=[];Popups.originalSettings=null;Popups.originalSettingsStack=[];Popups.ajaxHeaders={"X-Drupal-Render-Mode":"json/popups","Cache-Control":"no-store, no-cache, must-revalidate, post-check=0, pre-check=0"};Popups.defaultOptions={doneTest:null,updateMethod:"ajax",onUpdate:"",updateSource:"initial",href:null,width:null,targetSelectors:null,titleSelectors:null,reloadOnError:false,noMessage:false,forceShowNextActivePopup:false,skipDirtyCheck:false,hijackDestination:true,extraClass:"",ajaxForm:true,disableCursorMod:false,disableAttachBehaviors:false,formOnSubmit:null,disableInputFocus:false,fullScreen:false,hideActive:true,disableRedirectLogging:false,angularScope:null,angularElement:null};Popups.Popup=function(){this.id="popups-"+Popups.nextCounter();this.parent=null;this.path=null;this.element=null;this.options=null};Popups.Popup.prototype.$popup=function(){return $("#"+this.id)};Popups.Popup.prototype.$popupBody=function(){return $("#"+this.id+" .popups-body")
};Popups.Popup.prototype.$popupClose=function(){return $("#"+this.id+" .popups-close")};Popups.Popup.prototype.$popupTitle=function(){return $("#"+this.id+" .popups-title")};Popups.Popup.prototype.$popupButtons=function(){return $("#"+this.id+" .popups-buttons")};Popups.Popup.prototype.$popupFooter=function(){return $("#"+this.id+" .popups-footer")};Popups.Popup.prototype.fill=function(c,a,b){return $(Drupal.theme("popupDialog",this.id,c,a,b))};Popups.Popup.prototype.hide=function(){this.$popup().css("left","-9999px")};Popups.Popup.prototype.show=function(){Popups.resizeAndCenter(this)};Popups.Popup.prototype.open=function(d,a,c,b){return Popups.open(this,d,a,c,b)};Popups.Popup.prototype.removePopup=function(){Popups.removePopup(this)};Popups.Popup.prototype.close=function(){return Popups.close(this)};Popups.Popup.prototype.refocus=function(){var b=this.$popup(),a;if(this.disableInputFocus){a=b.find(".popups-close a")}else{a=b.find(":input:visible:enabled:first:not(.popups-no-focus, .s-tinymce-load-editor)");
if(!a.length){a=b.find(".popups-close a")}}a.focus()};Popups.Popup.prototype.trapTabKey=function(){var a=this.$popup();a.bind("keydown",function(b){if(b.which===9){Drupal.sAccessibility.trapTabKey(a,b)}})};Popups.Popup.prototype.targetLayerSelector=function(){if(this.parent===null){return"body"}else{return"#"+this.parent.id}};Popups.Popup.prototype.isDone=function(b){var a;if(this.options.doneTest){a=(b===this.options.doneTest||b.match(this.options.doneTest))}else{if(this.parent){a=(b===this.parent.path)}else{b=b.replace(/=(&)|=$/,"$1");Popups.originalSettings.popups.originalPath=Popups.originalSettings.popups.originalPath.replace(/=(&)|=$/,"$1");a=(b===Popups.originalSettings.popups.originalPath);if(!a&&Popups.isset(Popups.originalSettings.popups.addlOriginalPath)){Popups.originalSettings.popups.addlOriginalPath.replace(/=(&)|=$/,"$1");a=(b===Popups.originalSettings.popups.addlOriginalPath)}}}return a};Popups.isset=function(a){return(typeof(a)!=="undefined")};Popups.activePopup=function(){if(Popups.popupStack.length){return Popups.popupStack[Popups.popupStack.length-1]
}else{return null}};Popups.push=function(a){Popups.popupStack.push(a)};Popups.pop=function(a){return Popups.popupStack.pop()};Popups.options=function(b){var a=Popups.defaultOptions;return Popups.overrideOptions(a,b)};Popups.overrideOptions=function(d,e){var a={};for(var b in d){var c;if(Popups.isset(e[b])){a[b]=e[b]}else{a[b]=d[b]}}if(e.noReload||e.noUpdate){a.updateMethod="none"}if(e.reloadWhenDone){a.updateMethod="reload"}if(e.afterSubmit){a.updateMethod="callback";a.onUpdate=e.afterSubmit}if(e.forceReturn){a.doneTest=e.forceReturn}return a};Popups.attach=function(c,a,b){$(a,c).not(".popups-processed").each(function(){var d=$(this);d.addClass("popups-processed");var e="";if(d.attr("title")){e=d.attr("title")+" "}d.attr("title",e);d.click(function(f){return Popups.clickPopupElement(this,b)})})};Popups.clickPopupElement=function(b,a){Popups.saveSettings();if($(b).attr("on-popups-options")){var e=$.parseJSON($(b).attr("on-popups-options"));a=Popups.overrideOptions(a,e)}var c=Popups.activePopup();
var d=!(a.updateMethod==="none"||a.skipDirtyCheck);if(d&&Popups.activeLayerIsEdited()){Popups.offerToSave(b,a,c)}else{Popups.openPath(b,a,c)}return false};Popups.activeLayerIsEdited=function(){var b=Popups.activePopup();var a=Popups.getLayerContext(b);var c=a.find("span.tabledrag-changed").length;return c};Popups.offerToSave=function(d,c,e){var b=new Popups.Popup();var a=Drupal.t("There are unsaved changes in the form, which you will lose if you continue.");var f={popup_save:{title:Drupal.t("Save Changes"),func:function(){Popups.saveFormOnLayer(d,c,e)}},popup_submit:{title:Drupal.t("Continue"),func:function(){b.removePopup();Popups.openPath(d,c,e)}},popup_cancel:{title:Drupal.t("Cancel"),func:function(){b.close()}}};b.open(Drupal.t("Warning: Please Confirm"),a,f)};Popups.open=function(b,h,a,e,d,c){Popups.addOverlay();if(b){if(!b.options){if(!c){c={}}var g=Popups.options(c);b.options=g}}if(Popups.activePopup()){if(b.options.hideActive){Popups.activePopup().hide()}}if(!b){b=new Popups.Popup()
}Popups.push(b);var f=b.fill(h,a,e);b.hide();if(d){f.css("width",d)}if(b.extraClass instanceof Array){b.extraClass=b.extraClass[b.extraClass.length-1]}f.addClass(b.extraClass);$("body").append(f);if(e){jQuery.each(e,function(k,j){$("#"+k).click(j.func)})}b.$popupClose().click(function(){return Popups.close(b)});Popups.resizeAndCenter(b);b.refocus();Popups.removeLoading();$(document).trigger("popups_open_done",[b]);b.element=b.element!=null?b.element:$("body")[0];Drupal.sAccessibility.setLastFocus($(b.element));Drupal.sAccessibility.hideFromAT($("#body"));b.trapTabKey();return b};Popups.resizeAndCenter=function(a){var g=a.$popup();if(a&&a.fullScreen){g.css({width:"100%",height:"100%",top:0,left:0});$("html").css("overflow","hidden");return}var e=g.width();var b=Popups.windowWidth();var d=Math.floor((b/2)-(e/2)+Popups.scrollLeft());g.css("height","auto");var f=g.height();g.height(f);var h=Popups.windowHeight();var c=((h/2)-(f/2))/2+Popups.scrollTop();g.css("top",c).css("left",d)};Popups.message=function(d,c){c=c||"";
var a=new Popups.Popup();var b={popup_ok:{title:Drupal.t("OK"),func:function(){a.close()}}};a.open(d,c,b);return a};Popups.keyHandle=function(a){if(!a){a=window.event}switch(a.keyCode){case 27:Popups.close();break;case 191:if(a.shiftKey&&a.ctrlKey){var b=$("a.popups.more-help");if(b.size()){b.click()}else{Popups.message(Drupal.t("Sorry, there is no additional help for this page"))}}break}};Popups.addOverlay=function(){var a=$("#popups-overlay");if(!a.length){a=$(Drupal.theme("popupOverlay"));a.css("opacity","0.4");var b=$(document);a.width(b.width()).height(b.height());if($.browser.msie&&($.browser.version=="6.0"||$.browser.version=="7.0")){a.css("left",0)}$("body").prepend(a)}};Popups.removeOverlay=function(){if(!Popups.popupStack.length){$("#popups-overlay").remove()}};Popups.addLoading=function(){var c=$("#popups-loading");if(!c.length){c=$(Drupal.theme("popupLoading"));$("body").prepend(c);var b=c.width();var a=c.height();var e=(Popups.windowWidth()/2)-(b/2)+Popups.scrollLeft();var d=((Popups.windowHeight()/2)-(a/2))/2+Popups.scrollTop();
c.css({top:d,left:e,display:"block"})}};Popups.removeLoading=function(){$("#popups-loading").remove()};Popups.removePopup=function(a){if(!Popups.isset(a)){a=Popups.activePopup()}if(a){$(document).trigger("popups_before_remove",[a]);a.$popup().detach();Popups.popupStack.splice(jQuery.inArray(a,Popups.popupStack),1)}};Popups.close=function(a){if(!Popups.isset(a)){a=Popups.activePopup()}$(document).trigger("popups_before_close",[a]);var b=false;Popups.removePopup(a);Popups.removeLoading();if(Popups.activePopup()){b=Popups.activePopup();b.show();b.refocus();Drupal.settings=Popups.originalSettingsStack[b.id]}else{Popups.removeOverlay();Popups.restorePage();if(a&&a.fullScreen){$("html").css("overflow","auto")}}$(document).trigger("popups_close",[a,b]);if(Popups.activePopup()==null){Drupal.sAccessibility.revealToAT($("#body"))}Drupal.sAccessibility.returnFocus();return false};Popups.saveSettings=function(){if(!Popups.originalSettings){Popups.originalSettings=Drupal.settings}var a=Popups.activePopup();
if(a&&typeof Popups.originalSettingsStack[a.id]=="undefined"){Popups.originalSettingsStack[a.id]=Drupal.settings}};Popups.restoreSettings=function(){Drupal.settings=Popups.originalSettings};Popups.restorePage=function(){Popups.restoreSettings();for(var a in Popups.addedCSS){var b=Popups.addedCSS[a];$('style[popups_src="'+jqSelector($(b).attr("href"))+'"]').remove()}Popups.addedCSS=[]};Popups.scrollLeft=function(){return Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)};Popups.scrollTop=function(){return Math.max(document.documentElement.scrollTop,document.body.scrollTop)};Popups.windowHeight=function(){if($.browser.opera&&$.browser.version>"9.5"&&$.fn.jquery<="1.2.6"){return document.documentElement.clientHeight}return $(window).height()};Popups.windowWidth=function(){if($.browser.opera&&$.browser.version>"9.5"&&$.fn.jquery<="1.2.6"){return document.documentElement.clientWidth}return $(window).width()};Popups.nextCounter=function(){if(this.counter===undefined){this.counter=0
}else{this.counter++}return this.counter};Popups.addCSS=function(e){Popups.addedCSS=[];if(Drupal.settings.aggregated_css){var f=Drupal.settings.aggregated_css}else{var f=[]}for(var g in e){for(var d in e[g]){var h=e[g][d];var b=$(h).attr("href");var c=$(h).attr("href_orig");var j=$("head");var a=jQuery.inArray(c,f)!=-1;if(!$('link[href="'+jqSelector(c)+'"]').length&&!a){$.ajax({type:"GET",url:b,async:false,success:function(k){j.append('<style popups_src="'+b+'">'+k+"</style>")}});Popups.addedCSS.push(h)}}}};Popups.addJS=function(js){var scripts=[];var inlines=[];for(var type in js){if(type!="setting"){for(var file in js[type]){if(type=="inline"){inlines.push($(js[type][file]).html())}else{var script=$(js[type][file]).attr("src");var src_orig=$(js[type][file]).attr("src_orig");scripts.push([script,src_orig])}}}}var aggregatedCSS=Drupal.settings.aggregated_css;var aggregatedJS=[];if(Drupal.settings.aggregated_js){jQuery.each(Drupal.settings.aggregated_js,function(k,v){aggregatedJS.push(v.split("?")[0])
})}Drupal.settings=js.setting;Drupal.settings.aggregated_js=aggregatedJS;Drupal.settings.aggregated_css=aggregatedCSS;for(var i in scripts){var script=scripts[i];var src=script[0];var srcOrig=script[1];var checkSrc=srcOrig.split("?")[0];var preloadedJS=jQuery.inArray(checkSrc,aggregatedJS)!=-1;if(!$('script[src="'+jqSelector(srcOrig)+'"]').length&&!preloadedJS&&!Popups.addedJS[srcOrig]){$.ajax({type:"GET",url:src,async:false,success:function(script){eval.apply(window,[script])}});Popups.addedJS[srcOrig]=true}}return inlines};Popups._inlineScriptExists=function(a){return !!($("script:not([src])").filter(function(c,b){return b.innerHTML===a}).length)};Popups.addInlineJS=function(inlines){for(var n in inlines){if(!Popups._inlineScriptExists(inlines[n])){eval(inlines[n])}}};Popups.beforeSend=function(a){};Popups.beforeSubmit=function(c,a,b){$(document).trigger("popups_before_submit",[c,a,b]);Popups.removePopup();Popups.addLoading()};Popups.beforeSerialize=function(a,b){$(document).trigger("popups_before_serialize",[a]);
a.append('<input type="hidden" name="form_origin_popups" id="form_origin_popups" value="1" />')};Popups.openPath=function(d,c,e){Popups.saveSettings();if(!c.disableCursorMod){$("body").css("cursor","wait")}if(!c.nonModal){Popups.addOverlay()}Popups.addLoading();var b=c.href?c.href:d.href;$(document).trigger("popups_open_path",[d,b]);var g={};if(c.hijackDestination){var f;if(e){f=e.path}else{f=Popups.originalSettings.popups.originalPath}b=b.replace(/destination=[^;&]*[;&]?/,"");g.destination=f;if(c.disableRedirectLogging&&g.destination.indexOf("pdrl=1")==-1){g.destination=g.destination+($.inArray("?",g.destination)==-1?"?":"&")+"pdrl=1";if(e){e.path=g.destination}else{Popups.originalSettings.popups.originalPath=g.destination}}}var a={url:b,dataType:"text",data:g,headers:Popups.ajaxHeaders,beforeSend:Popups.beforeSend,success:function(m,j,o){var l=$.parseJSON(m);Popups.addCSS(l.css);var k=Popups.addJS(l.js);var n=l.path+(l.path_query?"?"+l.path_query:"");n=n.replace(/=(&)|=$/,"$1");var h=Popups.openPathContent(n,l.title,l.messages+l.content,d,c,e);
Popups.addInlineJS(k);$(document).trigger("popups_open_path_done",[d,b,h])},complete:function(){$("body").css("cursor","auto")}};var a;if(c.reloadOnError){a.error=function(){location.reload()}}else{a.error=function(h,k,j){Popups.errorMessage(h,k,j,this.url)}}$.ajax(a);return false};Popups.openPathContent=function(g,h,f,d,c,e){var a=new Popups.Popup();a.extraClass=c.extraClass;a.fullScreen=c.fullScreen;a.disableInputFocus=c.disableInputFocus;a.parent=e;a.path=g;a.options=c;a.element=d;Popups.open(a,h,f,null,c.width);delete Drupal.behaviors.tableHeader;delete Drupal.behaviors.teaser;if(!c.disableAttachBehaviors){Drupal.attachBehaviors(a.$popupBody())}a.refocus();var b=$("form",a.$popupBody());if(b.length&&c.ajaxForm){b.ajaxForm({iframe:false,dataType:"text",beforeSubmit:Popups.beforeSubmit,beforeSerialize:Popups.beforeSerialize,headers:Popups.ajaxHeaders,beforeSend:Popups.beforeSend,success:function(l,j,m){var k=$.parseJSON(l);Popups.formSuccess(a,k)},error:function(j,l,k){Popups.errorMessage(j,l,k,this.url,this.data)
}})}else{if(typeof c.formOnSubmit=="function"){b.submit(function(){var j=c.formOnSubmit();return j})}}return a};Popups.formSuccess=function(popup,data){var done=popup.isDone(data.path+(data.path_query?"?"+data.path_query:""));if(!done){Popups.addCSS(data.css);var inlines=Popups.addJS(data.js);Popups.removeLoading();var updatedPopup=Popups.openPathContent(data.path,data.title,data.messages+data.content,popup.element,popup.options,popup.parent);$(document).trigger("popups_form_success_notdone",[updatedPopup,data]);Popups.addInlineJS(inlines)}else{if(popup.options.updateMethod==="callback"&&popup.options.onUpdate){if(typeof popup.options.onUpdate=="function"){var result=popup.options.onUpdate.call(this,data,popup.options,popup.element)}else{var result=eval(popup.options.onUpdate+"(data, popup.options, popup.element)")}if(result===false){return}}if(popup.options.updateMethod==="reload"){if(popup.options.updateSource==="final"){location.href=Drupal.settings.basePath+data.path+(data.path_query?"?"+data.path_query:"")
}else{location.reload()}}else{var showMessage=data.messages&&data.messages.length&&!popup.options.noMessage;if(showMessage){var $next;var attachContext;if(popup.targetLayerSelector()==="body"){$next=$("body").find(Popups.originalSettings.popups.defaultTargetSelector);$next.parents("#main-content-wrapper").find("div.popup-messages-wrapper, div.messages").remove();$next.before('<div class="popup-messages-wrapper">'+data.messages+"</div>");attachContext=$("div.popup-messages-wrapper")}else{$next=$(popup.targetLayerSelector()).find(".popups-body");$next.parents("#main-content-wrapper").find("div.messages").remove();$next.prepend(data.messages);attachContext=$next}Drupal.attachBehaviors(attachContext)}if(popup.options.updateMethod!=="none"){Popups.testContentSelector();Popups.restoreSettings();if(popup.options.targetSelectors){jQuery.each(popup.options.targetSelectors,function(t_new,t_old){if(!isNaN(t_new)){t_new=t_old}var new_content=$(t_new,data.content);if(new_content.length==0&&Popups.isset(data.content_top)){new_content=$(t_new,data.content_top)
}if(new_content.length==0&&Popups.isset(data.content_right)){new_content=$(t_new,data.content_right)}if(new_content.length==0&&Popups.isset(data.content_left)){new_content=$(t_new,data.content_left)}if(new_content.length==0&&Popups.isset(data.content_left_top)){new_content=$(t_new,data.content_left_top)}if(new_content.length==0&&Popups.isset(data.content_top_upper)){new_content=$(t_new,data.content_top_upper)}var $c=$(popup.targetLayerSelector()).find(t_old).html(new_content.html());Drupal.attachBehaviors($c)})}else{var $c=$(popup.targetLayerSelector()).find(Popups.originalSettings.popups.defaultTargetSelector).html(data.content);Drupal.attachBehaviors($c)}}if(popup.options.titleSelectors){jQuery.each(popup.options.titleSelectors,function(){$(""+this).html(data.title)})}Popups.removeLoading();if(!popup.options.forceShowNextActivePopup&&!showMessage){Popups.close()}else{if(Popups.activePopup()){nextActivePopup=Popups.activePopup();nextActivePopup.show();nextActivePopup.refocus();Drupal.settings=Popups.originalSettingsStack[nextActivePopup.id]
}else{Popups.removeOverlay();Popups.restorePage();if(popup&&popup.fullScreen){$("html").css("overflow","auto")}}}}$(document).trigger("popups_form_success",[popup,data])}};Popups.getLayerContext=function(b){var a;if(!b){a=$("body").find(Popups.originalSettings.popups.defaultTargetSelector)}else{a=b.$popupBody()}return a};Popups.saveFormOnLayer=function(f,d,e){var a=Popups.getLayerContext(e);var c=a.find("form");var b={iframe:false,dataType:"text",beforeSubmit:Popups.beforeSubmit,beforeSerialize:Popups.beforeSerialize,headers:Popups.ajaxHeaders,beforeSend:Popups.beforeSend,success:function(k,g,l){var h=$.parseJSON(k);var j=a.html(h.content);Drupal.attachBehaviors(j);Popups.openPath(f,d,e)}};c.ajaxSubmit(b)};Popups.testContentSelector=function(){var b=Popups.originalSettings.popups.defaultTargetSelector;var a=$(b).length;if(a!==1){var c=Drupal.t("The popup content area for this theme is misconfigured.")+"\n";if(a===0){c+=Drupal.t("There is no element that matches ")+'"'+b+'"\n'}else{if(a>1){c+=Drupal.t("There are multiple elements that match: ")+'"'+b+'"\n'
}}c+=Drupal.t('Go to admin/build/themes/settings, select your theme, and edit the "Content Selector" field');alert(c)}};Popups.errorMessage=function(c,h,g,b,e){var f="https://support.schoology.com/hc/en-us/requests/new",a=Drupal.t("New Support Request"),d='<a href="'+f+'">'+a+"</a>";Popups.message(Drupal.t("Unexpected Error"),"<p>"+Drupal.t("Please try again in a few minutes")+'</p><p class="description">'+Drupal.t("If after trying a few times you continue to see this message, please contact the Support Team")+"</p><p>"+d+"</p>");$.post("/popups_error",{popups_error:h,popups_url:b,popups_data:e,popups_status:c.status,popups_response:c.status<300?c.responseText:"",error_type:"popups"})};Drupal.theme.prototype.popupLoading=function(){var a='<div id="popups-loading">';a+='<img src="'+Drupal.settings.basePath+Popups.originalSettings.popups.modulePath+'/ajax-loader.gif" />';a+="</div>";return a};Drupal.theme.prototype.popupOverlay=function(){return'<div id="popups-overlay"></div>'};Drupal.theme.prototype.popupButton=function(a,b){return'<input type="button" value="'+a+'" id="'+b+'" />'
};Drupal.theme.prototype.popupDialog=function(d,g,b,f){var e=Drupal.theme("popupTemplate",d);var c=e.replace("%title",g).replace("%body",b);var a="";if(f){jQuery.each(f,function(j,h){a+=Drupal.theme("popupButton",h.title,j)})}c=c.replace("%buttons",a);return c};Drupal.theme.prototype.popupTemplate=function(a){var b="";b+='<div id="'+a+'" class="popups-box">';b+='  <div class="popups-title">';b+='    <div class="popups-close"><a href="#">'+Drupal.t("Close")+"</a></div>";b+='    <div class="title">%title</div>';b+='    <div class="clear-block"></div>';b+="  </div>";b+='  <div class="popups-body">%body</div>';b+='  <div class="popups-buttons">%buttons</div>';b+='  <div class="popups-footer"></div>';b+="</div>";return b};Drupal.theme.prototype.popupTemplate=function(a){var b="";b+='<div id="'+a+'" class="popups-box" role="dialog">';b+='  <div class="popups-title">';b+='    <div class="popups-close"><a href="javascript://"><span class="visually-hidden">'+Drupal.t("Close")+"</span></a></div>";
b+='    <div class="title">%title</div>';b+='    <div class="clear-block"></div>';b+="  </div>";b+='  <div class="popups-body" tabindex="0">%body</div>';b+='  <div class="popups-buttons tabindex="0">%buttons</div>';b+='  <div class="popups-footer"></div>';b+="</div>";return b};var quickInstallAutoLaunchClicked=false;Drupal.behaviors.sAppLauncher=function(a){Drupal.settings.s_app=Drupal.settings.s_app||{};if(!quickInstallAutoLaunchClicked&&typeof Drupal.settings.s_app!="undefined"){if(Drupal.settings.s_app.auto_launch_quick_install){$(".app-quick-installer-popup").click();quickInstallAutoLaunchClicked=true}}$("#schoology-app-loader:not(.sAppLauncher-processed)",a).addClass("sAppLauncher-processed").each(function(){if(Drupal.settings.s_app.launcher){var g=sAppLauncherGetParams({type:"standard",isImport:false,url:location.href});var f=g.appNid+"-"+g.realm+"-"+g.realmID;if(Drupal.settings.s_app.launcher.hasOwnProperty(f)){var d=$("#content-wrapper");var e=$("#csm-section-toggle");var c=Drupal.settings.s_app.launcher[f];
var b=Drupal.theme("sAppContainer",c.type,c.url,c.cookie_required,e.length?e.html():"");d.html(b);sAttachBehaviors(["sAppLauncher"],d)}}$(this).remove()});$("#schoology-app-container:not(.sAppLauncher-processed)",a).addClass("sAppLauncher-processed").each(function(){var b=$(this);$(window).resize(function(){var d=$(this).height();$("#header, #center-top:visible").each(function(){d-=$(this).outerHeight()});b.height(d)}).trigger("resize");var c=false;$(".primary-activities .clickable").each(function(){$(this).click(function(){if(!c){var d=false;if($.browser.msie&&$.browser.version.charAt(0)==8){document.onfocusout=function(){if(d){$(".activities-dropdown-wrapper").hide();c=false}}}else{$(window).bind("blur.sAppLauncher",function(){if(d){$(".activities-dropdown-wrapper").hide();$(window).unbind("blur.sAppLauncher");c=false}})}b.bind("mouseover",function(){d=true});b.bind("mouseout",function(){d=false})}c=true})});$(".s-js-launch-button",b).bind("click",function(f){f.preventDefault();if($(this).hasClass("disabled")){return
}var d=sCommonOpenNewWindow($(this).attr("href"),{name:"schoology-app"});if(d!==false){$(this).addClass("disabled");$(this).prev(".app-launch-message").html(Drupal.t("Your app has been launched in a new window."));d.focus()}});$(".s-js-launch-button",b).trigger("click")});$("#s-js-tinymce-resources-insert-form-wrapper:not(.sTinymceResourcesInsert-processed)",a).addClass("sTinymceResourcesInsert-processed").each(function(){var f=$("#s-tinymce-resources-insert-form",$(this));var g=parseInt($("#edit-app-nid",f).val());var e=$("#edit-app-type",f).val();var b=$("#edit-realm",f).val();var d=parseInt($("#edit-realm-id",f).val());var c=parseInt($("#edit-folder-id",f).val());var h=parseInt($("#edit-fweight",f).val());var j={};j.type=e;j.isRTE=true;if(e=="resources"){j.url="/resources/apps/"+g+"/run"}else{if(e=="lti"){j.url="/apps/lti/"+g+"/run/"+b+"/"+d+"?f="+c+"&fweight="+h}else{return}}sAppLauncher($("#s-js-resources-app-container",f),j)})};Drupal.theme.prototype.sAppContainer=function(b,d,a,e){var c="";
if(a){c+='<div class="cookie-warning">';c+='<p class="app-launch-message">'+Drupal.t("This app must be launched by clicking on its link on the left menu.")+"</p>";c+="</div>";return c}if(b==2){c+='<div id="schoology-app-container" align="center">';c+='<p class="app-launch-message">'+Drupal.t("We attempted to launch your app in a new window, but a popup blocker is preventing it from opening. Please disable popup blockers for this site.")+"</p>";c+='<a class="link-btn s-js-launch-button" href="'+d+'">'+Drupal.t("Launch App")+"</a>";c+="</div>"}else{if(e){c+='<div id="schoology-csm_toggle" align="left">';c+="<p>"+e+"</p>";c+="</div>"}c+='<iframe id="schoology-app-container" frameborder="0" width="100%" height="800" src="'+d+'" name="schoology-app-container"></iframe>'}return c};function sAppLauncher(b,e){if(!Drupal.settings.s_app.launcher){Drupal.settings.s_app.launcher={}}var d=sAppLauncherGetParams(e);var c=d.appNid+"-"+d.realm+"-"+d.realmID;function a(h){var g=h.url;if(g&&$.isPlainObject(e.params)){g+=(g.indexOf("?")===-1?"?":"&")+$.param(e.params)
}var f=Drupal.theme("sAppContainer",h.type,g,h.cookie_required);b.html(f);sAttachBehaviors(["sAppLauncher"],b)}if(Drupal.settings.s_app.launcher.hasOwnProperty(c)){a(Drupal.settings.s_app.launcher[c]);return}sToggleActiveLoader("sAppLauncher",b);$.getJSON(d.settingsURI,function(f){sToggleActiveLoader("sAppLauncher");Drupal.settings.s_app.launcher[c]=f.body;a(Drupal.settings.s_app.launcher[c])})}function sAppLauncherGetParams(b){var f={import_view:b.isImport?1:0};var a="";var j=0;var k="";var e=0;var g={};function c(n,m){if(n!=""){var n=n.split("&");for(i=0;i<n.length;i++){var l=n[i].split("=");m[l[0]]=l[1]}}}if(b.type=="resources"){var d=b.url.match(/\/([0-9]+)\/run(\?)?(.*)/);j=d[1];k="user";e=Drupal.settings.s_common.user.uid;a+=j+"/"+b.type;c(d[3],f)}else{if(b.type=="standard"||b.type=="lti"){if(b.url.indexOf("/apps/school_apps/")!=-1){var d=b.url.match(/\/apps\/school_apps\/([0-9]+)\/configure(\?)?(.*)/);j=d[1];k="school";e=Drupal.settings.s_common.user.school_nid}else{var d=b.url.match(/\/([0-9]+)\/run\/([a-z]+)\/([0-9]+)(\?)?(.*)/);
j=d[1];k=d[2];e=d[3];g=getQueryParams(b.url)}a+=j+"/"+b.type+"/"+k+"/"+e;if(typeof b.isRTE!="undefined"&&b.isRTE==true){a+="&from=rte";if(g&&typeof g.f!="undefined"){a+="&f="+String(g.f)}if(g&&typeof g.fweight!="undefined"){a+="&fweight="+String(g.fweight)}}}}if(a==""){return false}var h=[];if(b.type=="resources"){$.each(f,function(l,m){h.push(l+"="+encodeURIComponent(m))});a+="?"+h.join("&")}a="/iapi/app/launcher/"+a;return{appNid:j,realm:k,realmID:e,settingsURI:a}}function sAppLauncherClearCache(a){for(var b in Drupal.settings.s_app.launcher){if(b.split("-")[0]==a){delete Drupal.settings.s_app.launcher[b];break}}}Drupal.behaviors.sAppMenu=function(a){$("#menu-s-apps-list .app-link:not(.sAppMenu-processed), .resources-app-list .s-js-app-launch.resources-app-title:not(.sAppMenu-processed)",a).addClass("sAppMenu-processed").each(function(){var c=$(this);var b=c.hasClass("resources-app-title");c.click(function(f){var d,h,g;if(!b){d=c.parents(".app-link-wrapper").attr("id").split("-")[2];h=c.attr("href")
}else{d=c.parents(".s-app-resource-app").attr("id").split("-")[1];h=c.attr("href")}g=sCommonGetSetting("s_app","cookie_preload_urls",d);if(g){f.preventDefault();if(b){f.stopImmediatePropagation()}sAppMenuCookiePreloadRun(d,g,function(){if(!b){window.location=h}else{sAppLauncherClearCache(d);sAppMenuCookiePreloadDelete(d);c.trigger("click.s-js-library-ajax-links")}})}})})};function sAppMenuCookiePreloadRun(b,c,a){window.open(c,"cookiepreloader","width=100,height=100,toolbar=0,menubar=0,location=0,status=0,scrollbars=0,resizable=0,left=0,top=0");$.ajax({url:"/apps/"+b+"/cookies_loaded",async:false});setTimeout(a,800)}function sAppMenuCookiePreloadSet(a){Drupal.settings.s_app=Drupal.settings.s_app||{};Drupal.settings.s_app.cookie_preload_urls=Drupal.settings.s_app.cookie_preload_urls||{};for(var b in a){Drupal.settings.s_app.cookie_preload_urls[b]=a[b]}}function sAppMenuCookiePreloadDelete(a){delete Drupal.settings.s_app.cookie_preload_urls[a]}Drupal.behaviors.sGroup=function(a){sCommonAjaxEnrollmentBehavior(a);
$(".notification-settings:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){sUserSetupRealmNotifButton($(this))});$(".access-code:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){var b=this;$(".access-delete",b).click(function(){var d=window.location.pathname.substring(1);var c=d.split("/")[1];$.ajaxSecure({url:"/enrollment/code/visibility/group/"+c+"/hide",dataType:"json",success:function(f,e){$(b).hide()}})})});$("#group-events:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){var d=$(this);var e=window.location.pathname.substring(1);var c=e.split("/")[1];$.ajax({url:"/group/"+c+"/calendar_ajax"+(window.location.search.length?window.location.search+"&":"?")+"original_q="+e,dataType:"json",type:"GET",success:function(g,f){$(".more-loading",d).remove();d.append($(g).children());if(window.location.search.match("mini=")){$("#event-calendar",b).click()}if(window.location.search.match("mini=")){$("#event-calendar",b).click()
}Drupal.attachBehaviors(d);d.show()}});var b=$("h3#event-selector",d);$("#event-calendar",b).click(function(){var g=new Popups.Popup();var f='<div id="fcalendar" style="width: 800px;"></div>';var h={popup_cancel:{title:Drupal.t("Close"),func:function(){g.close()}}};g.extraClass="popups-extra-large calendar-popup-mini";g.open(Drupal.t("Calendar"),f,h);Drupal.attachBehaviors();$("#share-calendar-option-containter .share-calendar-option").insertAfter("#fcalendar");sPopupsResizeCenter()})});$(".group-info-wrapper:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){var b=$(this);$(".group-info-full",b).hide();$(".more-link",b).bind("click",function(){$(this).parent().hide();$(".group-info-full",b).show()});$(".less-link",b).bind("click",function(){$(this).parent().hide();$(".group-info-less",b).show()})});$(".profile-picture-wrapper:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){var e=$(this);var c=$(".edit-profile-picture-hover",e);var b=$(".profile-picture",e);
var d=$("#profile-picture-uploader-wrapper",e);c.bind("click",function(){if(d.is(":visible")){d.hide()}else{d.show()}});$("body").bind("click",function(g){var f=$(g.target);if(!f.hasClass("profile-picture-wrapper")&&f.parents(".profile-picture-wrapper").length==0){d.hide()}});b.bind("s_profile_picture_uploaded",function(g,f){$("img",$(this)).attr("src",f).removeAttr("height");d.hide()})});$(".mygroups-list-item:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){$(this).sActionLinks({hidden:false,wrapper:".group-action-links",rowClass:".mygroups-list-item"})});$("#s-group-settings:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){$(this).sActionLinks({hidden:false,wrapper:".action-links-wrapper"})});$("#s-group-create-new-form:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){var e=$(this);var d=$("#edit-step",e).val();if(d=="2"){e.parents(".popups-box").addClass("s-group-create-form-step-2")}var c=$("#privacy-labels",e);var b=$("#edit-privacy-level-wrapper",e);
$("select",b).bind("change",function(){var j=$(this);var h=j.parent();$(".privacy-label",h).remove();var l=j.val();if(l!=0){var k=$("#"+l,c);var m=k.clone();j.after(m)}});var f=$("#invite-types-labels",e);var g=$("#edit-invite-type-wrapper",e);$("select",g).bind("change",function(){var j=$(this);var h=j.parent();$(".invite-type-label",h).remove();var l=j.val();if(l!=-1){var k=$("#invite-type-"+l,f);var m=k.clone();j.after(m)}});$("select",b).trigger("change");$("select",g).trigger("change");sPopupsResizeCenter();$("#edit-make-official",e).click(function(){var h=$("#tag-tree",e);if($(this).is(":checked")){h.removeClass("hidden");h.show()}else{h.hide()}sPopupsResizeCenter()})});$("#right-column .suggested-groups-wrapper:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){var b=$(this);$(document).bind("groupsBlockReady",function(d,c){b.empty();b.append(c);Drupal.attachBehaviors($(".suggested-groups-wrapper"));sCommonAjaxEnrollmentBehavior($(".suggested-groups-wrapper"))
});sCommonGetSuggestionBlock("groups")});$(".s-js-archive-group:not(.sGroup-processed), .s-js-restore-group:not(.sGroup-processed)",a).addClass("sGroup-processed").each(function(){$(this).click(function(){var b=$(this).attr("id").split("-");var f=b[0];if(f!="restore"&&f!="archive"){return false}var e=b[2];var g;var d;var c;var h=$(this).parents(".group-action-links").siblings(".middle").children(".group-title").text();if(f==="archive"){g=Drupal.t("Archive Group");d=Drupal.t("Are you sure you want to archive !groupName?",{"!groupName":"<b>"+h+"</b>"});c=Drupal.t("Note: This will archive the group for all group members too.")}else{if(f==="restore"){g=Drupal.t("Restore Group");d=Drupal.t("Are you sure you want to restore !groupName?",{"!groupName":"<b>"+h+"</b>"});c=Drupal.t("Note: This will restore the group for all group members too.")}}sCommonConfirmationPopup({title:g,body:'<p class="'+f+'-confirmation">'+d+'<p class="description">'+c+"</p>",extraClass:" group-"+f,confirm:{text:Drupal.t("Submit"),func:function(){$.ajaxSecure({url:"/group/"+e+"/"+f,dataType:"json",success:function(l){msg=Drupal.theme.sAjaxMessage(l.msg+'"'+h+'"',l.msgClass);
$("#content-wrapper",a).before(msg);$(".messages-close-btn",a).click(function(){$(".messages-close-btn",a).parent().fadeOut(500,function(){$(".messages",a).remove()})});$("li#group-"+e).fadeOut(1000,function(){$(this).remove()});var m=false;$(".link-wrapper").each(function(){if($(this).text()=="Archived"){m=true}});if(m==false){location.reload()}if($(".mygroups-list-item").length==1){var k=window.location.href.toString().split(window.location.host)[1];var j=(typeof k.split("/")[2]!=="undefined")?"/"+k.split("/")[2]:"";window.location="/groups"+j}},error:function(j){if(!($(".messages",a).length)){msgError=Drupal.theme.sAjaxMessage(Drupal.t("There was an internal error, please try again"),"error");$("#content-wrapper",a).before(msgError)}$(".messages-close-btn",a).click(function(){$(".messages-close-btn",a).parent().fadeOut(500,function(){$(".messages",a).remove()})})}});Popups.activePopup().close()}}});sPopupsResizeCenter();return false})})};if(typeof WeakMap==="undefined"){(function(){var b=Object.defineProperty;
var a=Date.now()%1000000000;var c=function(){this.name="__st"+(Math.random()*1000000000>>>0)+(a+++"__")};c.prototype={set:function(d,f){var e=d[this.name];if(e&&e[0]===d){e[1]=f}else{b(d,this.name,{value:[d,f],writable:true})}return this},get:function(d){var e;return(e=d[this.name])&&e[0]===d?e[1]:undefined},"delete":function(d){var e=d[this.name];if(!e||e[0]!==d){return false}e[0]=e[1]=undefined;return true},has:function(d){var e=d[this.name];if(!e){return false}return e[0]===d}};window.WeakMap=c})()}(function(s){var x=new WeakMap();var u;if(/Trident|Edge/.test(navigator.userAgent)){u=setTimeout}else{if(window.setImmediate){u=window.setImmediate}else{var k=[];var p=String(Math.random());window.addEventListener("message",function(A){if(A.data===p){var z=k;k=[];z.forEach(function(B){B()})}});u=function(z){k.push(z);window.postMessage(p,"*")}}}var g=false;var j=[];function d(z){j.push(z);if(!g){g=true;u(l)}}function y(z){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(z)||z
}function l(){g=false;var A=j;j=[];A.sort(function(C,B){return C.uid_-B.uid_});var z=false;A.forEach(function(C){var B=C.takeRecords();r(C);if(B.length){C.callback_(B,C);z=true}});if(z){l()}}function r(z){z.nodes_.forEach(function(A){var B=x.get(A);if(!B){return}B.forEach(function(C){if(C.observer===z){C.removeTransientObservers()}})})}function f(F,G){for(var D=F;D;D=D.parentNode){var E=x.get(D);if(E){for(var C=0;C<E.length;C++){var B=E[C];var A=B.options;if(D!==F&&!A.subtree){continue}var z=G(A);if(z){B.enqueue(z)}}}}}var t=0;function o(z){this.callback_=z;this.nodes_=[];this.records_=[];this.uid_=++t}o.prototype={observe:function(D,A){D=y(D);if(!A.childList&&!A.attributes&&!A.characterData||A.attributeOldValue&&!A.attributes||A.attributeFilter&&A.attributeFilter.length&&!A.attributes||A.characterDataOldValue&&!A.characterData){throw new SyntaxError()}var C=x.get(D);if(!C){x.set(D,C=[])}var z;for(var B=0;B<C.length;B++){if(C[B].observer===this){z=C[B];z.removeListeners();z.options=A;break
}}if(!z){z=new v(this,D,A);C.push(z);this.nodes_.push(D)}z.addListeners()},disconnect:function(){this.nodes_.forEach(function(B){var C=x.get(B);for(var A=0;A<C.length;A++){var z=C[A];if(z.observer===this){z.removeListeners();C.splice(A,1);break}}},this);this.records_=[]},takeRecords:function(){var z=this.records_;this.records_=[];return z}};function h(z,A){this.type=z;this.target=A;this.addedNodes=[];this.removedNodes=[];this.previousSibling=null;this.nextSibling=null;this.attributeName=null;this.attributeNamespace=null;this.oldValue=null}function q(A){var z=new h(A.type,A.target);z.addedNodes=A.addedNodes.slice();z.removedNodes=A.removedNodes.slice();z.previousSibling=A.previousSibling;z.nextSibling=A.nextSibling;z.attributeName=A.attributeName;z.attributeNamespace=A.attributeNamespace;z.oldValue=A.oldValue;return z}var c,e;function a(z,A){return c=new h(z,A)}function b(z){if(e){return e}e=q(c);e.oldValue=z;return e}function n(){c=e=undefined}function w(z){return z===e||z===c}function m(A,z){if(A===z){return A
}if(e&&w(A)){return e}return null}function v(z,B,A){this.observer=z;this.target=B;this.options=A;this.transientObservedNodes=[]}v.prototype={enqueue:function(z){var A=this.observer.records_;var B=A.length;if(A.length>0){var C=A[B-1];var D=m(C,z);if(D){A[B-1]=D;return}}else{d(this.observer)}A[B]=z},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(A){var z=this.options;if(z.attributes){A.addEventListener("DOMAttrModified",this,true)}if(z.characterData){A.addEventListener("DOMCharacterDataModified",this,true)}if(z.childList){A.addEventListener("DOMNodeInserted",this,true)}if(z.childList||z.subtree){A.addEventListener("DOMNodeRemoved",this,true)}},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(A){var z=this.options;if(z.attributes){A.removeEventListener("DOMAttrModified",this,true)}if(z.characterData){A.removeEventListener("DOMCharacterDataModified",this,true)}if(z.childList){A.removeEventListener("DOMNodeInserted",this,true)
}if(z.childList||z.subtree){A.removeEventListener("DOMNodeRemoved",this,true)}},addTransientObserver:function(z){if(z===this.target){return}this.addListeners_(z);this.transientObservedNodes.push(z);var A=x.get(z);if(!A){x.set(z,A=[])}A.push(this)},removeTransientObservers:function(){var z=this.transientObservedNodes;this.transientObservedNodes=[];z.forEach(function(B){this.removeListeners_(B);var C=x.get(B);for(var A=0;A<C.length;A++){if(C[A]===this){C.splice(A,1);break}}},this)},handleEvent:function(H){H.stopImmediatePropagation();switch(H.type){case"DOMAttrModified":var B=H.attrName;var C=H.relatedNode.namespaceURI;var I=H.target;var F=new a("attributes",I);F.attributeName=B;F.attributeNamespace=C;var A=H.attrChange===MutationEvent.ADDITION?null:H.prevValue;f(I,function(K){if(!K.attributes){return}if(K.attributeFilter&&K.attributeFilter.length&&K.attributeFilter.indexOf(B)===-1&&K.attributeFilter.indexOf(C)===-1){return}if(K.attributeOldValue){return b(A)}return F});break;case"DOMCharacterDataModified":var I=H.target;
var F=a("characterData",I);var A=H.prevValue;f(I,function(K){if(!K.characterData){return}if(K.characterDataOldValue){return b(A)}return F});break;case"DOMNodeRemoved":this.addTransientObserver(H.target);case"DOMNodeInserted":var J=H.target;var G,D;if(H.type==="DOMNodeInserted"){G=[J];D=[]}else{G=[];D=[J]}var z=J.previousSibling;var E=J.nextSibling;var F=a("childList",H.target.parentNode);F.addedNodes=G;F.removedNodes=D;F.previousSibling=z;F.nextSibling=E;f(H.relatedNode,function(K){if(!K.childList){return}return F})}n()}};s.JsMutationObserver=o;if(!s.MutationObserver){s.MutationObserver=o}})(this);Drupal.behaviors.s_discussion=function(d){var c=!!$.fn.sticky,g=typeof MutationObserver!=="undefined",a=!!$(".discussion-is-mobile").val(),e=$("body").hasClass("anonymous"),f=c&&g&&!a&&!e;$("h2.page-title").addClass("sDiscussion-processed").each(function(){var h=!$(".no-discussion").length;if(f){if(h){$(this).sticky()}else{$(this).sticky("unstick")}}});var b=$(".s-comments-post-form-new").length?".s-comments-post-form-new":".s-comments-post-form";
$(b+":not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var l=!$(".no-discussion").length;if(f&&l){var n=$(this);var k=function(o){if(o){$(".mceButton,.infotip",n).each(function(){if($(this).data("tipsy")){$(this).tipsy("hide")}})}};n.sticky({bindToBottomOf:$("h2.page-title.sDiscussion-processed"),scrollCallback:k});var m=document.querySelector(b),j={attributes:true,childList:true,characterData:true,subtree:true,attributeFilter:["style"]};var h=new MutationObserver(function(o){n.sticky("updateHeight");n.sticky("update")});h.observe(m,j)}});$(".discussion-action-bar:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var j=$(this);if(!j.hasClass("disabled")){j.on("click",".scroll-to-top",function(){$("html, body").animate({scrollTop:0},200)});j.on("click",".collapse-all",function(){$(".comment-more-toggle.less").click();$(".expander-link-expanded:not(.hidden)").click()});j.on("click",".expand-all",function(){$(".expander-link-collapsed:not(.hidden)").click();
$(".comment-more-toggle:not(.less)").click()})}var k=!$(".no-discussion").length;if(f&&k){var h=function(l){if(l){$(".infotip",j).each(function(){if($(this).data("tipsy")){$(this).tipsy("hide")}})}};j.sticky({bindToBottomOf:$(b+".sDiscussion-processed"),scrollCallback:h,wrapperClassName:"sticky-wrapper action-bar-wrapper"})}});$(".grade-item-action-links:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){$(this).sActionLinks({hidden:false,wrapper:".action-links-wrapper"})});$(".info-container .view-info:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var h=$(this);h.bind("click",function(){var j=$(this).parent();$(".grading-info",j).toggle();h.toggleClass("active");return false}).tipsy({gravity:"se"})});$("body").unbind("click.sGradeViewInfo").bind("click.sGradeViewInfo",function(k){var h=$(".info-container .view-info",d);var j=$(k.target);if(h.hasClass("active")&&j.not(".grading-info")&&j.parents(".grading-info").length==0){h.click()
}});$(".info-container .link-btn:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){$(this).tipsy({gravity:"se"})});$("td.discussion-row .action-links-wrapper:not(.s_discussion-processed)").addClass("s_discussion-processed").each(function(){$(this).sActionLinks({hidden:false,wrapper:".action-links-wrapper"})});$("#s-discussion-edit-discussion-form:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var h=$(this);$("#edit-edit-body",h).elastic();sPopupsResizeCenter();$(document).bind("popups_before_remove",function(){sAttachmentMoveForm($("#s-comments-post-comment-form"),"#edit-comment-wrapper")})});$("span.reorder:not(.sDiscussion-processed)").addClass("sDiscussion-processed").each(function(){$(this).bind("click",function(){$("table a.tabledrag-handle").show();$("table div.handle").show();$(".reorder-submit-buttons").show()})});$("#s-discussion-copy-discussion-form:not(.sDiscussion-processed)").addClass("sDiscussion-processed").each(function(){var h=$(this);
sDiscussionSetupDates(h)});$("#s-discussion-create-form:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var k=$(this);sDiscussionSetGradingOptionsDisplay($(".enable-grading"),$("#copy-to-courses",k));$("input.pre-fill-title",k).focus(function(){if($(this).val()=="Title (required)"){if($(this).hasClass("pre-fill-title")){$(this).removeClass("pre-fill-title")}$(this).val("")}}).blur(function(){if($(this).val()==""){$(this).addClass("pre-fill-title");$(this).val(Drupal.t("Title (required)"))}});$(".enable-grading").click(function(){sDiscussionSetGradingOptionsDisplay($(this),k)});sDiscussionSetupDates(k);$("#edit-title-wrapper input.pre-fill-title",k).focus(function(){if($(this).val()=="Title (required)"){if($(this).hasClass("pre-fill-title")){$(this).removeClass("pre-fill-title")}$(this).val("")}}).blur(function(){if($(this).val()==""){$(this).addClass("pre-fill-title");$(this).val(Drupal.t("Title (required)"))}});$("#edit-post-wrapper textarea.pre-fill-body",k).each(function(){var r=$(this).attr("title");
$(this).elastic().focus(function(){if($(this).val()==r){if($(this).hasClass("pre-fill-body")){$(this).removeClass("pre-fill-body")}$(this).val("")}}).blur(function(){if($(this).val()==""){$(this).val(r);$(this).addClass("pre-fill-body")}})});var h=$(".toggle-copy",k),p=$(".toggle-shared",k),n=$(".adv-option-shared",k),m=$("#shared-details",k),q=$(".form-checkbox",m),l=$("#addl-courses input[type=checkbox]",k);l.bind("click",function(){var r=$(this).is(":checked")?"block":"none";$(".addl-course-options",$(this).parents(".addl-course")).css("display",r)});$("#copy-to-courses input",k).each(function(){$(this).click(function(){var r=$("input:checked",$(this).parents("#copy-to-courses"));if(r.length>0){$("#edit-shared-wrapper, #shared-details").each(function(){$("input",$(this)).attr("disabled","disabled")});p.removeClass("adv-option-on").addClass("disabled").attr("disabled-title",Drupal.t("You cannot share a copied discussion"));n.prop("checked",false)}else{$("#edit-shared-wrapper, #shared-details").each(function(){$("input",$(this)).attr("disabled",false)
});p.removeClass("disabled")}sPopupsResizeCenter()})});k.bind("click",function(s){var r=$(s.target);if(!r.is("#shared-details")&&!r.is(".toggle-shared")&&r.closest("#shared-details").length==0&&r.closest(".toggle-shared").length==0&&m.is(":visible")){m.hide()}});var o=$(".shared-fields",k);var j=$(".csm-node-assign-wrapper",k);q.bind("click",function(){var r;if(q.is(":checked")){h.addClass("disabled").attr("disabled-title",Drupal.t("You cannot copy a shared discussion"));p.addClass("adv-option-on");l.prop("disabled",true);r=true}else{h.removeClass("disabled");p.removeClass("adv-option-on");l.prop("disabled",false);r=false}if(r!=!o.hasClass("hidden")){o.toggleClass("hidden",!r);j.toggleClass("hidden",r);sPopupsResizeCenter()}n.prop("checked",p.hasClass("adv-option-on"))});p.click(function(){if(!$(this).hasClass("disabled")){if(m.is(":visible")){m.hide()}else{m.show()}sPopupsResizeCenter()}});$(".shared-close-btn",$(this)).bind("click",function(){m.hide()});if($("#edit-has-time",k).val()=="0"){$('input[name="due_date[time]"]',$("#edit-due-date-wrapper",k)).val("")
}});$(".tag-selector:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var j=$(this);var h=$(".item-list .action-links",j);$(".tag-filter-select",j).bind("click",function(){h.toggle()});$("body:not(.s-discussion-tag-selector-processed)").addClass("s-discussion-tag-selector-processed").click(function(l){var k=$(l.target);if(!k.hasClass("tag-filter-select")&&k.parents(".tag-filter-select").length==0){h.hide()}})});$(".course-discussion #share-courses-toggle:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){$("#s-discussion-share-realms-form").hide();$(this).click(function(){$("#s-discussion-share-realms-form").toggle();return false})});$("#s-discussion-edit-tags-form span.cancel-btn:not(.sDiscussion-processed)").addClass("sDiscussion-processed").each(function(){$(this).bind("click",function(){var h=Popups.activePopup();if(h){h.close()}})});$("form #edit-tags-wrapper:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var j=$(this);
var h=[];$("#edit-tags",j).autocomplete(Drupal.settings.s_private_taxonomy.avail_terms,{minChars:0,width:310,mustMatch:false,matchContains:true,scroll:false,multiple:true});$(".recent-terms .term",j).each(function(){$(this).click(function(){var n=$(this).text();var o=$("#edit-tags",j).val().split(",");var p=[];for(var m in o){var l=o[m].replace(/^\s+|\s+$/g,"");if(l==n){return}if(l.length>0){p.push(l)}}p.push(n);var k=p.join(", ");k.replace(", ,",",");$("#edit-tags",j).val(k)})})});if(typeof tinyMCE!="undefined"){$(".discussion-content #edit-comment.s-tinymce-load-editor:not(.sDiscussion-processed), .s-comments-post-form-new #edit-comment.s-tinymce-load-editor:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var k=$(this),j=k.attr("id"),h=tinyMCE.get(j);if(!h){sTinymceInit({elements:j,toolbar:"discussion"})}})}$("#comment-navigator:not(.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){var p=$(this);var j=$(".num-comments",p).text();
isDeleted=isCommentDeleted(j);populateNavInfo(extractCommentInfo(j),false,isDeleted);$("#comment-navigator .next").addClass("disabled");p.fadeIn();var n=sUserGetUISettings("s_discussion","timeline_expanded");p.data("hidden",!n);var k=$(body);if(!k.data("wrapperAnimateXDist")){var m=0;m+=parseInt(p.css("right"));m+=parseInt(p.css("padding-right"));m+=$("td:eq(1)",p).width();k.data("wrapperAnimateXDist",m)}else{m=k.data("wrapperAnimateXDist")}var l=function(q,r){if(r){p.animate({right:"-="+m+"px"},"slow")}else{p.css("right","-="+m+"px")}q.removeClass("show").addClass("hide").find(".visually-hidden").text(Drupal.t("Hide Comment Navigator."))};var o=function(q,r){if(r){p.animate({right:"+="+m+"px"},"slow")}else{p.css("right","+="+m+"px")}q.removeClass("hide").addClass("show").find(".visually-hidden").text(Drupal.t("Show Comment Navigator."))};var h=$(".slide-toggler-cell a",p);if(!n){l(h,false)}h.click(function(){var q=p.data("hidden");if(q){o(p,true);p.data("hidden",false)}else{l(p,true);p.data("hidden",true)
}sUserSetUISettings("s_discussion","timeline_expanded",q);return false});if(j<2){$("#comment-navigator .prev").addClass("disabled");return}$(".nav-buttons",p).click(function(s){var r=$(s.target).parent();var q=p.data("selectedCommentNum");if(r.hasClass("next")){q++}else{if(r.hasClass("prev")){q--}else{return false}}if(q<=1){$("#comment-navigator .prev").addClass("disabled")}else{$("#comment-navigator .prev").removeClass("disabled")}if(q>=j){$("#comment-navigator .next").addClass("disabled")}else{$("#comment-navigator .next").removeClass("disabled")}if(q==0||q>j){return false}isDeleted=isCommentDeleted(q);populateNavInfo(extractCommentInfo(q),true,isDeleted);return false});$(".highlight-comment",p).click(function(){var q=p.data("selectedCommentNum");highlightCommentNum(q);return false})});$("#s_comments:not(.sDiscussion-processed)",d).addClass(".sDiscussion-processed").each(function(){var k=this;var h='<img src="/sites/all/themes/schoology_theme/images/ajax-loader.gif" class="loader" alt="'+Drupal.t("Loading")+'" />';
var j=function(l){var m=l.closest("#s-discussion-grade-post-form");m.find("#edit-exception").val(0);m.find(".grade-exception-icon").remove();m.find(".grade-exception-wrapper").remove();m.removeClass("has-exception")};$(document).on("keydown","#edit-full-credit",function(l){j($(l.target))});$(document).on("gradingRubricTotalGradeUpdate",function(m,l){j($(l))});$("a.comment-grade",this).each(function(){var m=$(this);var l=m.parents(".comment-grade-wrapper");$(this).click(function(q){$(".comment-grade").removeClass("active");var o=$(this).attr("href");var p=$(this).parents(".comment:first");if(!$(".fake-menu-wrapper",p).length){l.after('<div class="fake-menu-wrapper">'+h+"</div>");var n=$(".fake-menu-wrapper",p);$.ajax({type:"GET",url:o,dataType:"json",success:function(r){sAngular.extractThemeData(r);n.append(r.output);$(".loader",p).hide();$("body").bind("click",function(t){var s=$(t.target);if(!(s.parents(".grading-scale-ac-popup").length>0)&&!(s.parents(".fake-menu-wrapper:first").length>0)&&!(s.parents(".comment-grade").length>0)&&!s.is(".comment-grade")){n.hide();
$(".comment-grade.active").removeClass("active")}});$("#grade-discussion-close-button",n).click(function(s){n.hide();$("a.comment-grade.active",k).removeClass("active");s.preventDefault()});$(".cancel-btn",n).click(function(s){n.hide();$("a.comment-grade.active",k).removeClass("active");s.preventDefault()});m.addClass("active");Drupal.attachBehaviors(n);$(".grade-exception-icon").tipsy({gravity:"s",title:function(){return $(this).attr("alt")}});$("#edit-full-credit").unbind("sGradingScaleSelectionMade").bind("sGradingScaleSelectionMade",function(s){j($(s.target))})}})}else{var n=$(".fake-menu-wrapper",p);n.toggle();if(n.is(":visible")){m.addClass("active")}else{m.removeClass("active")}}q.preventDefault()})})});$("#highlight-user-wrapper .dropdown-wrapper:not(.disabled,.sDiscussion-processed)",d).addClass("sDiscussion-processed").each(function(){if($.browser.msie&&($.browser.version=="6.0"||$.browser.version=="7.0")){$(this).remove();return}else{$(this).show()}var j=$(this);var o=$(".infotip",j);
$(".dropdown-toggle:not(.bound)",j).addClass("bound").click(function(){if($(j).hasClass("open")){$(j).removeClass("open")}else{$(j).addClass("open");o.tipsy("hide")}});var q=$("#s_comments");var r=false;var m=$(".discussion-action-bar",d);var s=$(".post-count",m);var k=parseInt(s.text());var k=Drupal.formatPlural(k,"1 Post","@count Posts");var n=$(".discussion-unread-counter",m);var t=parseInt(n.text());function l(v){var u=v.attr("id").split("-")[3];return function(){$(".comment-by-"+u,q).removeClass("on-top");v.removeClass("on-top");$(".user-stats-clear-filter",v).empty();r=false;s.html(k);n.html(t);$(".x-button",m).remove();$(".profile-preview",m).remove();$(".dropdown-toggle-text",m).text(Drupal.t("Highlight User"));$(".profile-picture-placeholder",m).show();o.removeClass("enabled");o.tipsy("hide")}}var p=$("body");var h=$(".dropdown-wrapper",p);p.on("click",function(v){var u=$(v.target);if(h.hasClass("open")&&!u.closest(".dropdown-wrapper, .dropdown-menu,.discussion-user-filter").length){h.removeClass("open")
}});$(".discussion-user-filter:not(.unclickable)",j).click(function(){var z=$(this);var u=z.attr("id").split("-")[3];var x=$("#discussion-overlay");if(r){var A=$(".x-button",m);if(A.length){A.click()}}var B=$(document);$(".comment-by-"+u,q).addClass("on-top");z.addClass("on-top");$(".user-stats-clear-filter",z).html(" - "+Drupal.t("clear filter"));r=true;var D=$(".user-stats-num",z).attr("count");D=Drupal.formatPlural(D,"1 Post","@count Posts");var v=$(".user-unread-num",z).attr("count");s.html(D);n.html(v);var w=$("#s_comments");$(".expander-link-collapsed:not(.hidden)",w).each(function(H){var F=$(this);var E=F.closest(".discussion-card");var G=$(".comment-by-"+u,E).length>0;if(G){F.click()}});var y=$(".on-top .user-stats-name",m).text();$(".dropdown-toggle-text",m).text(y);$(".dropdown-wrapper",m).removeClass("open");var A=$('<div class="x-button"></div>');A.click(l(z));$(".dropdown-wrapper",m).after(A);var C=$(".profile-picture",z).clone().addClass("profile-preview");$("#highlight-user-wrapper .profile-picture-placeholder",m).hide();
$("#highlight-user-wrapper .dropdown-toggle",m).prepend(C);o.addClass("enabled")});o.mouseover(function(){if(o.hasClass("enabled")){o.tipsy("show")}else{o.tipsy("hide")}}).mouseout(function(){o.tipsy("hide")});$(window).keydown(function(v){if(!v){v=window.event}if(v.keyCode==27){var u=$("#discussion-user-stats .on-top");if(u.length){u.trigger("click")}}})});window.onbeforeunload=function(){var j=$("#s-comments-post-comment-form  .form-to-hide:visible .submit-span-wrapper").not(".disabled");var h=$("#comment-reply-form-wrapper:visible #s-comment-reply-form .submit-span-wrapper").not(".disabled");if(j.length+h.length==0){return}return Drupal.t("You haven't finished your post yet. If you navigate away from this page, your post will be deleted.")};if($("body").hasClass("s-enable-mathml")){s_renderMath()}};function isCommentDeleted(a){commentClass=".comment-num-"+a;comment=$(commentClass,$("#s_comments"));if(comment.hasClass("deleted")){return true}return false}function extractCommentInfo(c){var e=".comment-num-"+c;
var f=$(e,$("#s_comments"));var d=new Object();var b=$(".comment-top .comment-author",f).children().eq(0).clone();var a=$(".comment-time .gray",f).text();if(b.length==0){b=$(".deleted-comment:only-child",f).clone()}d.commentNum=c;d.authorLink=b;d.commentDate=a;return d}function populateNavInfo(d,b,a){var e=$("#comment-navigator");var c=Drupal.t("Posted by ");if(a){c=""}$("span.comment-num",e).html(d.commentNum);$("span.comment-meta").html(c);$("span.comment-author",e).empty().append(d.authorLink);$("span.comment-date",e).html(d.commentDate);e.data("selectedCommentNum",d.commentNum);if(b){highlightCommentNum(d.commentNum)}}function highlightCommentNum(a){var b=".comment-num-"+a;var d=$(b,$("#s_comments"));var c=d.offset().top-60;$("html,body").stop();$("html,body").animate({scrollTop:c},500);d.effect("highlight",{color:"#f9b974"},3000)}function sDiscussionEditThreadCallback(c,a,b){window.location.reload()}function sDiscussionSetGradingOptionsDisplay(a,b){if($(a).is(":checked")){$("div.addl-grading-options-wrapper").each(function(){$(this).removeClass("hidden")
});$(".grading-options-wrapper").show();$(".grading-scale-select-grouping").show();$(".toggle-shared").hide();sDiscussionEnableCCInfotip(b)}else{$("div.addl-grading-options-wrapper").each(function(){$(this).addClass("hidden")});$(".grading-options-wrapper").hide();$(".grading-scale-select-grouping").hide();$(".toggle-shared").show();sDiscussionDisableCCInfotip(b)}sPopupsResizeCenter()}function sDiscussionSetupDates(a){$(".due-date, .csm-due-date",a).each(function(){var c=$(this);var b=$(this).parents(".discussion-date-wrapper:first,.csm-node-assign-section:first");c.blur(function(){setTimeout(function(){var d=$("div.time-input input",b);if(c.val()!=""&&d.val()==""){d.val("11:59PM")}},200)})})}function sDiscussionEnableCCInfotip(a){$("span.infotip:not(.rule-infotip)",a).each(function(){var c=$(this);var b=c.parents(".addl-course:first");var d=$(".form-checkbox",b);d.attr("checked",false);d.attr("disabled","disabled");$(".addl-course-options",b).hide();if(c.hasClass("infotip-disabled")){c.removeClass("infotip-disabled")
}c.tipsy({html:true,gravity:c.attr("tipsygravity"),title:function(){return $(".infotip-content",c).html()}})})}function sDiscussionDisableCCInfotip(a){$("span.infotip:not(.rule-infotip)",a).each(function(){var b=$(this);var c=$(".form-checkbox",b.parents(".addl-course:first"));c.attr("disabled",false);b.unbind("mouseenter mouseleave");b.addClass("infotip-disabled")})}Drupal.behaviors.sCommonMediaFileIframeUseRelativeUrl=function(a){var b=/^\/?media\/ifr\/\d+$/;var c=/^\/?media\/ifr_ext$/;$("#main iframe:not(.sCommonMediaFileIframeUseRelativeUrl-processed), .s-page-container iframe:not(.sCommonMediaFileIframeUseRelativeUrl-processed),.template-fields iframe:not(.sCommonMediaFileIframeUseRelativeUrl-processed)",a).addClass("sCommonMediaFileIframeUseRelativeUrl-processed").each(function(){var f=$(this);var h=f.attr("src");var g=document.createElement("a");g.href=h;var e=g.pathname;var d=b.exec(e);if(!d){d=c.exec(e)}if(d){if(e[0]!=="/"){e="/"+e}if(g.search){e+=g.search}f.attr("src",e)}})};var wait_image="/sites/all/themes/schoology_theme/images/ajax-loader.gif";
var wait_image_width=43;var wait_image_height=11;Drupal.behaviors.s_comment=function(d){sCommentEnableCommentJump();var c=$("#edit-allow-attachments-1").val()==1,a=$("body").hasClass("s_grade_item_assignment"),e=$("body").hasClass("s_grade_item_assessment"),b=typeof tinyMCE!="undefined";function f(l,g,j){g?l.show():l.hide();if(typeof j=="undefined"||!j){j="basic_comment"}var h=l.data("editor_id");if(g){if(b){if(h){tinyMCE.execCommand("mceAddControl",true,h);tinyMCE.execCommand("mceFocus",false,h)}else{h=l.find(".s-tinymce-load-editor").attr("id");sTinymceInit({elements:h,toolbar:j});l.data("editor_id",h);tinyMCE.execCommand("mceFocus",false,h)}}else{l.find("#edit-reply").trigger("focus");var k=l.find("textarea:not(.sComment-processed)");if(k.length){k.addClass("sComment-processed").elastic()}}if(c){if(!sAttachmentMoveForm(l,".submit-span-wrapper","before")){resetAttachmentForm()}}}else{if(h){tinyMCE.execCommand("mceRemoveControl",true,h)}}}$("#s_comments:not(.sCommentProcessed)",d).addClass("sCommentProcessed").each(function(){var g=$(this);
g.on("click",".expander-link-expanded, .expander-link-collapsed",function(l){var m=$(l.target);var j=m.closest(".expander-bar");var o=j.nextAll(".s_comments_level:first");var h=j.prevAll(".comment:first");if(!m.hasClass("clickable")){m=m.parent()}var k=m.hasClass("expander-link-expanded");if(k){var r=$(".expander-link-collapsed",j);o.addClass("hidden")}else{var r=$(".expander-link-expanded",j);o.removeClass("hidden")}m.addClass("hidden");r.removeClass("hidden");var s=$(".comment-nid",g).text();var n="collapsedThreads-"+s;var q=$.cookie(n);if(typeof q=="undefined"||!q){q=[]}else{q=q.split(",")}var p=h.attr("id");p=p.split("-")[1];if(k){if(q.indexOf(p)==-1){q.push(p)}}else{q=searchAndRemove(q,p)}q=q.join(",");$.cookie(n,q,{expires:30})})});$("#s-comment-reply-form:not(.sCommentProcessed)",d).addClass("sCommentProcessed").each(function(){var j=$(this);var g=$("#edit-reply",j);var k=$("#edit-comment");var l=$(".form-submit",j);var h=l.parent(".submit-span-wrapper:first");function n(o){l.prop("disabled",!o);
h.toggleClass("disabled",!o)}if(b){var m=true;tinyMCE.onAddEditor.add(function(o,p){if(p.id==g.attr("id")){p.onChange.add(function(){var q=!!$(p.getBody().innerHTML).text().length;n(q)});if(m){n(false);m=false}if(c){p.onActivate.add(function(){sAttachmentMoveForm(g.closest("form"),".submit-span-wrapper","before")})}}if(p.id==k.attr("id")){if(c){p.onActivate.add(function(){sAttachmentMoveForm(k.closest("form"),".submit-span-wrapper","before")})}}})}else{g.on("keyup focus",function(){n(g.val().length)})}});$(".reply-comment:not(.sComment-processed)",d).addClass("sComment-processed").each(function(){var m=$(this).parents(".comment").eq(0);var k=m.children(".comment-footer");var l=m.closest(".blog-comments").length>0;var g=m.closest(".discussion-view").length>0;var h=g?"discussion":"basic_comment";var j=m.parents(".s_comments_level").length;$(this).click(function(n){n.preventDefault();var o=$("#comment-reply-form-wrapper");if(o.is(":visible")&&m.has(o).length){f(o,false,h)}else{f(o,false,h);
if(a||e||l){o.insertAfter(k)}else{o.appendTo(k)}$("input[type=hidden][name=pid]",o).val(m.attr("id").split("-")[1]);$("input[type=hidden][name=nested_level]",o).val(j+1);f(o,true,h)}})});if(d!==document){sAttachActionLinkBehavior(d)}else{$(".discussion-content:not(.sComment-processed)",d).addClass("sComment-processed").each(function(){var g=this;sAttachActionLinkBehavior(g);$(document).on("popups_open_path_done",function(m,k,j,h){var n=$("#"+h.id);var l="";if(n.hasClass("s-js-comment-popup-edit")){l=h.id;$("#attachments",n).remove();sAttachmentMoveForm($("#s-comment-edit-comment-form"),"#edit-comment-body-wrapper");$(document).bind("popups_before_remove",function(p,o,q){if(l==o.id){sAttachmentMoveForm($("#s-comments-post-comment-form"),"#edit-comment-wrapper")}})}})})}$("#s-comment-edit-comment-form:not(.sComment-processed)",d).addClass("sComment-processed").each(function(){var j=$(this);var h=$(".form-textarea",j);var g=$(".form-submit",j);var k=g.parent(".submit-span-wrapper:first",j);
h.elastic().on("keyup",function(){var l=h.val().length>0?true:false;g.prop("disabled",!l);k.toggleClass("disabled",!l)});$(document).off("jq_elastic_update_done").on("jq_elastic_update_done",function(m,l){sPopupsResizeCenter()})});$("#s_comments:not(.sComment-processed)",d).addClass(".sComment-processed").each(function(){var g=$(this);g.on("click",".comment-more-toggle:not(.loading)",function(m){var l=$(m.target);var h=l.siblings(".comment-id").text();var k=l.closest(".comment-comment").find(".comment-more-wrapper");var n=l.closest(".comment-comment").find(".comment-less-wrapper");var j=function(){var p=l.hasClass("less");k.toggleClass("hidden",p);n.toggleClass("hidden",!p);var q="collapsedTruncatedComment-"+h;var o=$.cookie(q);if(typeof o=="undefined"||!o){o=null}o=p;$.cookie(q,o,{expires:30})};if(!l.hasClass("comment-more-loading")){if(!k.length){l.addClass("comment-more-loading");$.ajax({url:"/comment/"+h+"/show_more",method:"get",dataType:"json",success:function(o){n.after($(o.comment));
k=l.closest(".comment-comment").find(".comment-more-wrapper");j();l.removeClass("comment-more-loading")}})}else{l.addClass("comment-more-loading");j();l.removeClass("comment-more-loading")}}})})};function sCommentEnableCommentJump(){$(".go-to-reply").click(function(){var b=$(this);var c=$(this).parent().parent().parent().parent();if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=$(this.hash);e.effect("highlight",{color:"#f9b974"},3000);$(".return-link").remove();var d=b.parent().prev().text().split(" ");var a=$('<div class="return-link">'+Drupal.t("Return to reply",{"@name":d[0]})+"</div>");a.click(function(){var g=b.offset().top-20;$("html,body").animate({scrollTop:g},500);b.parent().parent().parent().parent().effect("highlight",{color:"#f9b974"},3000);$(this).fadeOut()});e.prepend(a);a.fadeIn();e=e.length&&e||$("[name="+this.hash.slice(1)+"]");if(e.length){var f=e.offset().top-20;$("html,body").animate({scrollTop:f},500);return false;
show}}})}function sCommentDeleteCallback(f,b,d){var a=$(d.closest(".discussion-card")).length>0;if(a){location.reload();return false}var e=Drupal.t("This comment has been deleted.");var c=function(h){var j=$(h).parents(".comment");j.empty().addClass("deleted").append(e);if(j.hasClass("no-children")&&j.parent().hasClass("discussion-card")){j.unwrap()}};if(typeof f.ajax_output!="undefined"){e=f.ajax_output;c(d)}else{c(d)}var g=Popups.activePopup();if(g){Popups.removeLoading();g.show();g.refocus()}else{Popups.close()}return false}function sCommentApproveCallback(c,a,b){$(b).parents(".comment").empty().addClass("deleted").append(Drupal.t("This comment has been approved."));Popups.close();return false}function sCommentEditCallback(d,l,e){var j=d.content.comment;var b=d.content.comment_edited_timestamp;var k=d.content.comment_attachments;var c=$(e);var f=c.parents("#comment-"+j.cid);var g=$(".comment-body-wrapper",f);var a=$(".comment-time-wrapper",f);var h=$(".comment-attachments",f);if(j.richtext&&!g.hasClass("s-rte")){g.addClass("s-rte")
}if(typeof d.content.is_discussion!="undefined"&&d.content.is_discussion){g.replaceWith(j.comment)}else{g.html(commenktObj.comment);a.replaceWith(b)}if(h.length>0){h.replaceWith(k)}else{$(".comment-comment",f).append(k)}sAttachBehaviors(["sCommonInfotip"],f);Popups.close();return false}function sAttachActionLinkBehavior(a){$(".s-js-comment-wrapper:not(.has-action-link-behavior)",a).each(function(){$(this).addClass("has-action-link-behavior").sActionLinks({hidden:true,wrapper:".s-js-comment-action-links",rowClass:".comment-contents"})});sCommentAttachActions(a)}function sCommentAttachActions(b){var a={".delete-comment":{extraClass:"popups-small s-js-comment-popup-delete",updateMethod:"callback",onUpdate:"sCommentDeleteCallback",doneTest:".+"},".edit-comment":{extraClass:"popups-medium s-js-comment-popup-edit",updateMethod:"callback",onUpdate:"sCommentEditCallback",hijackDestination:false,doneTest:".+"}};$.each(a,function(d,c){$(b).on("click",d,c,function(e){return Popups.clickPopupElement(this,Popups.options(e.data))
})})}function sCommentScrollToNewComment(d,f,b){var a=$("body").hasClass("discussion-view"),g=d.offset().top,b=b||"",f=f||750;if(a){var e=0,c=20;$(".sticky-wrapper").each(function(){e+=$(this).outerHeight()});g-=c;g-=e;b=""}$("html, body"+b).animate({scrollTop:g},f)}
/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2006, 2014 Klaus Hartl
 * Released under the MIT license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){a(require("jquery"))}else{a(jQuery)}}}(function(f){var a=/\+/g;function d(j){return b.raw?j:encodeURIComponent(j)}function g(j){return b.raw?j:decodeURIComponent(j)}function h(j){return d(b.json?JSON.stringify(j):String(j))}function c(j){if(j.indexOf('"')===0){j=j.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{j=decodeURIComponent(j.replace(a," "));return b.json?JSON.parse(j):j}catch(k){}}function e(k,j){var l=b.raw?k:c(k);return f.isFunction(j)?j(l):l
}var b=f.cookie=function(q,p,v){if(arguments.length>1&&!f.isFunction(p)){v=f.extend({},b.defaults,v);if(typeof v.expires==="number"){var r=v.expires,u=v.expires=new Date();u.setTime(+u+r*86400000)}return(document.cookie=[d(q),"=",h(p),v.expires?"; expires="+v.expires.toUTCString():"",v.path?"; path="+v.path:"",v.domain?"; domain="+v.domain:"",v.secure?"; secure":""].join(""))}var w=q?undefined:{};var s=document.cookie?document.cookie.split("; "):[];for(var o=0,m=s.length;o<m;o++){var n=s[o].split("=");var j=g(n.shift());var k=n.join("=");if(q&&q===j){w=e(k,p);break}if(!q&&(k=e(k))!==undefined){w[j]=k}}return w};b.defaults={};f.removeCookie=function(k,j){if(f.cookie(k)===undefined){return false}f.cookie(k,"",f.extend({},j,{expires:-1}));return !f.cookie(k)}}));Drupal.behaviors.sAttachment=function(a){$(".attachments-video-thumbnails-play:not(.sAttachment-processed)",a).addClass("sAttachment-processed").each(function(){var b=$(this);b.bind("click",function(){var d=b.parents(".attachments-video");
var c=$(".video-video",d);d.after(c);c.show();d.hide();thePopup=Popups.activePopup();if(thePopup!=null){Popups.resizeAndCenter(thePopup)}return false})});$(".embed-cover:not(.sAttachment-processed)",a).addClass("sAttachment-processed").each(function(){$(this).click(function(){var d=$(this),c=d.siblings(".embed-content:first");d.hide();d.siblings(".embed-title").hide();if(c.length){var b=c.get(0),e=null;c.show();$.each(b.childNodes,function(f,g){if(g.nodeType==8){e=g.nodeValue}});if(e){c.html(e)}}})});$(".attachments-link:not(.sAttachment-processed)",a).addClass("sAttachment-processed").each(function(){var c=$(this);var b=$(".attachment-link-popup",c);c.bind("mouseenter",function(){if(b.length){b.show()}}).bind("mouseleave",function(){if(b.length){b.hide()}});b.bind("mouseenter",function(){$(this).hide()})})};Drupal.behaviors.sCommentsPostCommentForm=function(a){$("#s-comments-post-comment-form:not(.sCommentsPostCommentForm-processed), .post-comment-form:not(.sCommentsPostCommentForm-processed)",a).addClass("sCommentsPostCommentForm-processed").each(function(){var b=$(this);
var c=$("#comment-placeholder",b);var j=$(".form-to-hide",b);var e=$(".form-submit",b);var p=e.parent(".submit-span-wrapper:first",b);var d=$("#edit-cancel",b);var g=$(".form-textarea",b);var h=(b.hasClass("submit-enabled"));var q="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]";var f=b.find("*").filter(q);var o=b.closest(".edge-main-wrapper").length>0;var k=g.hasClass("s-tinymce-load-editor");function n(r){e.prop("disabled",!r);p.toggleClass("disabled",!r)}function m(r){r.onChange.add(function(){var s=!!$(r.getBody().innerHTML).text().length;n(s)});r.onInit.add(function(){setTimeout(function(){tinyMCE.execCommand("mceFocus",true,r.id)},0);if(o){tinyMCE.dom.Event.add(r.getWin(),"blur",function(){if(!r.getContent().length){tinyMCE.execCommand("mceRemoveControl",true,r.id);g.val(g.attr("defaulttext")).trigger("blur")}})}})}if(window.tinyMCE){if(tinyMCE.activeEditor!=null){m(tinyMCE.activeEditor)
}else{if(!h&&k){tinyMCE.onAddEditor.add(function(r,s){if(s.id==g.attr("id")){m(s)}})}}}b.on("focusin",function(t){$("div.author-picture.threadless",b).show();$("div.author-picture.threadless",b).siblings("span.submit-span-wrapper").show();b.addClass("mouse-focus");var u=b.find(".s-tinymce-load-editor");if(u.length){var s=u.attr("id"),r=tinymce.get(s);if(r){tinyMCE.execCommand("mceAddControl",true,s)}else{u.val("");sTinymceInit({elements:s,toolbar:"basic_comment"})}}}).on("focusout",function(r){setTimeout(function(){var s=$(":focus"),t=f.index(s);if(t===-1&&g.val()==g.attr("defaulttext")){$("div.author-picture.threadless",b).hide();$("div.author-picture.threadless",b).siblings("span.submit-span-wrapper").hide();b.removeClass("mouse-focus");if(g.hasClass("threadless")){g.removeClass("add-comment-resize")}}},0)});if(!k){g.on("focus",function(){if(g.val()==g.attr("defaulttext")&&g.hasClass("pre-fill")){g.val("").removeClass("pre-fill")}if(g.hasClass("threadless")){g.addClass("add-comment-resize")
}$(this).trigger("resize")}).on("blur",function(){if(g.val()==""){g.val(g.attr("defaulttext")).not(".is-locked").addClass("pre-fill")}}).on("keyup",function(){n(g.val().length)}).trigger("blur").elastic()}function l(){if(c.css("display")=="none"){c.show();j.hide()}else{c.hide();j.show();tinyMCE.activeEditor.focus();tinyMCE.activeEditor.getBody().focus()}}c.on("click",l);$(d,b).on("click",function(r){r.preventDefault();l()})})};Drupal.behaviors.s_user=function(b){$("#s-user-custom-notifications-form:not(.sUser-processed)").addClass("sUser-processed").each(function(){var d=$(this);var e=$(".select-all",d);e.click(function(){var f=$(this).is(":checked");$(".realm-setting",d).each(function(){$(this).prop("checked",f)})});$(".edit-select-all-wrapper",d).click(function(){$("input",this).click()});$(".realm-setting").each(function(){var f=$(this);f.change(function(){if(!f.attr("checked")&&e.attr("checked")){e.prop("checked",false)}})});$(".cancel-btn",d).click(function(j){var h=$(".setting-name",d).val();
var f=$(".original-setting",d).html();$("select[name="+h+"]").selectmenu("value",f);var g=Popups.activePopup();if(g!=null){g.close()}j.preventDefault()})});$(".notifications-header:not(.sUser-processed)").addClass("sUser-processed").each(function(){if(Drupal.settings.s_user!="undefined"&&typeof Drupal.settings.s_user.notif_defaults!="undefined"){var d=Drupal.settings.s_user;$(".reset-default").click(function(){$("select.notif-setting-select").each(function(){var e=$(this).attr("name");if(typeof d.notif_defaults[e]!="undefined"){$(this).selectmenu("value",d.notif_defaults[e])}})})}});$("#s-user-set-notifications-form:not(.sUser-processed)").addClass("sUser-processed").each(function(){$("select.notif-setting-select").each(function(){var d=$(this);d.selectmenu({style:"dropdown"});d.change(function(){if(d.val()=="2"){var e="/user/custom_notification/"+d.attr("name");Popups.openPath(this,{href:e,ajaxForm:false,extraClass:"popups-custom-notification popups-medium"},window)}})})});$("#s-user-invite-colleague-form:not(.sUser-processed)").addClass("sUser-processed").each(function(){ZeroClipboard.setMoviePath("/sites/all/misc/zeroclipboard/zeroclipboard.swf");
var e=new ZeroClipboard.Client();e.setHandCursor(true);var f=$("#invite_link #url").html();f=f.replace(/&amp;/g,"&");e.setText(f);var d='<span class="zclipboard" style="position:absolute;">'+e.getHTML($("#invite_link").outerWidth(),$("#invite_link").outerHeight())+"</span>";$(".popups-body").append(d);repositionZClipboard();e.addEventListener("complete",function(g,h){if($(".copied-wrapper").length==0){$(".popups-body").append('<span class="copied-wrapper">Link copied to your clipboard</span>')}else{$(".copied-wrapper").show()}setTimeout(function(){$(".copied-wrapper").fadeOut(400,function(){sPopupsResizeCenter()})},2500);sPopupsResizeCenter()});$(".addresses").focus(function(){if($(this).hasClass("pre-fill")){$(this).empty();$(this).removeClass("pre-fill")}repositionZClipboard()});if($("#s-user-invite-colleague-form").hasClass("emails-sent")){$("#s-user-invite-colleague-form").removeClass("emails-sent");$(".popup-invite").addClass("emails-sent");sPopupsResizeCenter()}$("#s-user-invite-colleagues-invite-by-email").bind("click",function(g){$(".popup-invite").addClass("sending-emails");
$("#s-user-invite-colleagues-invite-choices,#s-user-invite-colleagues-click-to-copy-link,#s-user-invite-colleagues-click-to-copy-title").fadeOut(300,function(){$("#edit-emails,.s-user-invite-colleagues-invite-by-email-buttons").fadeIn(300,function(){repositionZClipboard()})});g.preventDefault()});$("#s-user-invite-colleagues-invite-by-email-cancel").unbind("click");$("#s-user-invite-colleagues-invite-by-email-cancel").bind("click",function(g){$(".popup-invite").removeClass("sending-emails");$("#edit-emails,.s-user-invite-colleagues-invite-by-email-buttons").fadeOut(300,function(){$("#s-user-invite-colleagues-invite-choices,#s-user-invite-colleagues-click-to-copy-link,#s-user-invite-colleagues-click-to-copy-title").fadeIn(300,function(){repositionZClipboard()})});g.preventDefault()});$("#s-user-invite-colleagues-fb-button,#s-user-invite-colleagues-twitter-button").click(function(g){window.open($(this).attr("realhref"),"popup","width=650,height=380",false);g.preventDefault();return false})
});$("a.show-code").click(function(){var e=$(this).attr("id");var e=e.split("-");var d='<div class="formatted-code">Code: '+e[1]+"</div>";$.prompt(d);return false});$("input#action-select-all").click(function(){var d=$(this);$("#s-user-manage-activation-form table input:checkbox").each(function(){if($(this).attr("checked")){$(d).prop("checked",false);$(this).prop("checked",false)}else{$(d).prop("checked",true);$(this).prop("checked",true)}})});$("#s-user-edit-calendar-feed-settings-form:not(.sUser-processed)").addClass("sUser-processed").each(function(){$("#webcal-addr",$(this)).focus(function(){document.getElementById("webcal-addr").select()}).mouseup(function(d){d.preventDefault()})});$("#s-user-profile-editor-profile-form:not(.sUser-processed)").addClass("sUser-processed").each(function(){$("textarea",$(this)).elastic();var f=$(".learner-style-wrappper");var d=$("#edit-profile-about-learner-style-0-wrapper",f);var e=$("input[type=radio]",d);d.hide();sCommonFormRadioGroup(f,e)});$("#s-user-personal-account-settings-form:not(.sUser-processed)").addClass("sUser-processed").each(function(){var d=$(this);
$(".timezone-select-time .timezone-use-list",d).bind("click",function(){$(this).parent().hide();$(".timezone-select-timezone",d).show();$("#edit-timezone-select-type",d).val("timezone")});$(".timezone-select-timezone .timezone-use-time",d).bind("click",function(){$(this).parent().hide();$(".timezone-select-time",d).show();$("#edit-timezone-select-type",d).val("time")});$("#edit-user-name-first-preferred").on("keydown paste input",function(j){var l=$(this);var k=!!l.val().length;var h=l.closest(".name-first-preferred-wrapper");var g=$(".use-name-first-preferred-wrapper");var f=!g.hasClass("hidden");if(k!=f){g.toggleClass("hidden",f);h.toggleClass("has-preferred-first-name",k)}})});$(".s-js-name-title-wrapper:not(.sUser-processed)",b).addClass("sUser-processed").each(function(){var d=$(this),e=$(".s-js-name-title-custom",d);$(".s-js-name-title-select",d).change(function(f){if($(this).val()=="custom"){d.addClass("s-js-name-title-custom-enabled")}else{d.removeClass("s-js-name-title-custom-enabled");
e.val("")}}).triggerHandler("change")});if($(".logout-exec").text()=="1"){var a=location.href;index=a.indexOf("settings/");var c="/logout?";if(Drupal.settings.s_common.hasOwnProperty("logout_token")){c+="ltoken="+Drupal.settings.s_common.logout_token+"&"}c+="destination=home.php?deleted";newUrl=a.substring(0,index)+c;location.href=newUrl}$(".profile-picture-wrapper:not(.sUser-processed)",b).addClass("sUser-processed").each(function(){var g=$(this);var e=$(".edit-profile-picture-hover",g);var d=$(".profile-picture",g);var f=$("#profile-picture-uploader-wrapper",g);e.bind("click",function(){if(f.is(":visible")){f.hide()}else{f.show()}});$("body").bind("click",function(j){var h=$(j.target);if(!h.hasClass("profile-picture-wrapper")&&h.parents(".profile-picture-wrapper").length==0){f.hide()}});d.bind("s_profile_picture_uploaded",function(j,h){$("img",$(this)).attr("src",h).removeAttr("height");f.hide()})});$(".push-remove:not(.sUser-processed)",b).addClass("sUser-processed").bind("click",function(g){g.preventDefault();
var f=$(this);var d='<span class="confirm-remove-device-name">'+f.siblings(".push-os").html()+"</span>";var h='<span class="confirm-message">'+Drupal.t("Are you sure you want to deactivate !device_name?",{"!device_name":d})+"</span>";sCommonConfirmationPopup({title:Drupal.t("Deactivate Device"),body:h,extraClass:"push-remove",confirm:{text:Drupal.t("Deactivate"),func:function(){$.ajax(f.attr("href"),{data:{ajax:true},success:function(j){if(j.body){$("#content-wrapper").html(j.body);if(j.messages){var e=$("#main-content-wrapper");e.children(".messages").remove();e.prepend(j.messages)}Drupal.attachBehaviors($("#main-content-wrapper"))}},complete:function(){Popups.activePopup().close()}})}}})})};function repositionZClipboard(){var b=$("#invite_link").offset();var a=$(".popups-box").offset();$(".zclipboard").css("left",b.left-a.left);$(".zclipboard").css("top",b.top-a.top)}(function(){var Q=jQuery,t,ao,F="mathquill-command-id",k="mathquill-block-id",al=Math.min,z=Math.max;var L=[].slice;function ag(){}function e(P){var ap=L.call(arguments,1);
return function(){return P.apply(this,ap)}}function ad(ap,P){if(!P){throw new Error("prayer failed: "+ap)}}var h=(function(aq,ar,av){function ap(P){return typeof P==="object"}function au(P){return typeof P==="function"}function at(aA,aw){if(aw===av){aw=aA;aA=Object}function aB(aD){var aC=this;if(!(aC instanceof aB)){return new aB(arguments)}if(aD&&au(aC.init)){aC.init.apply(aC,aD)}}var az=aB[aq]=new aA();var ay=aA[aq];var ax;var P=aB.mixin=function(aD){ax={};if(au(aD)){ax=aD.call(aB,az,ay,aB,aA)}else{if(ap(aD)){ax=aD}}if(ap(ax)){for(var aC in ax){if(ar.call(ax,aC)){az[aC]=ax[aC]}}}if(!au(az.init)){az.init=function(){aA.apply(this,arguments)}}return aB};az.constructor=aB;return P(aw)}return at})("prototype",({}).hasOwnProperty);var m=(function(){var P={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};function aq(at){var aw=at.which||at.keyCode;
var ar=P[aw];var av;var au=[];if(at.ctrlKey){au.push("Ctrl")}if(at.originalEvent&&at.originalEvent.metaKey){au.push("Meta")}if(at.altKey){au.push("Alt")}if(at.shiftKey){au.push("Shift")}av=ar||String.fromCharCode(aw);if(!au.length&&!ar){return av}au.push(av);return au.join("-")}return function ap(at,aE){var aG=null;var aA=null;if(!aE){aE={}}var aC=aE.text||ag;var ay=aE.key||ag;var aL=aE.paste||ag;var ax=aE.cut||ag;var aF=Q(at);var aN=Q(aE.container||aF);var az,aH;function au(aO){az=setTimeout(aO);aH=aO}function aJ(){if(az){clearTimeout(az);az=t;aH()}}aN.bind("keydown keypress input keyup focusout paste",aJ);function aI(aO){aJ();aF.val(aO);if(aO){aF[0].select()}}function aK(){var aO=aF[0];if(!("selectionStart" in aO)){return false}return aO.selectionStart!==aO.selectionEnd}function av(aP){var aO=aF.val();aF.val("");if(aO){aP(aO)}}function aD(){ay(aq(aG),aG)}function aM(aO){aG=aO;aA=null;aD()}function aw(aO){if(aG&&aA){aD()}aA=aO;au(function(){if(aK()){return}av(aC)})}function aB(){aG=aA=null
}function ar(aO){aF.focus();au(function(){av(aL)})}aN.bind({keydown:aM,keypress:aw,focusout:aB,cut:ax,paste:ar});return{select:aI}}}());var c=h(function(aD,aF,at){function au(aH,aG){if(aH){aH="'"+aH+"'"}else{aH="EOF"}throw"Parse Error: "+aG+" at "+aH}aD.init=function(aG){this._=aG};aD.parse=function(aH){return this.skip(aE)._(aH,aG,au);function aG(aJ,aI){return aI}};aD.or=function(aH){ad("or is passed a parser",aH instanceof at);var aG=this;return at(function(aL,aK,aJ){return aG._(aL,aK,aI);function aI(aM){return aH._(aL,aK,aJ)}})};aD.then=function(aH){var aG=this;return at(function(aL,aK,aI){return aG._(aL,aJ,aI);function aJ(aO,aM){var aN=(aH instanceof at?aH:aH(aM));ad("a parser is returned",aN instanceof at);return aN._(aO,aK,aI)}})};aD.many=function(){var aG=this;return at(function(aM,aL,aJ){var aI=[];while(aG._(aM,aK,aH)){}return aL(aM,aI);function aK(aO,aN){aM=aO;aI.push(aN);return true}function aH(){return false}})};aD.times=function(aI,aG){if(arguments.length<2){aG=aI}var aH=this;
return at(function(aQ,aP,aJ){var aL=[];var aS=true;var aK;for(var aN=0;aN<aI;aN+=1){aS=aH._(aQ,aR,aM);if(!aS){return aJ(aQ,aK)}}for(;aN<aG&&aS;aN+=1){aS=aH._(aQ,aR,aO)}return aP(aQ,aL);function aR(aU,aT){aL.push(aT);aQ=aU;return true}function aM(aU,aT){aK=aT;aQ=aU;return false}function aO(aU,aT){return false}})};aD.result=function(aG){return this.then(av(aG))};aD.atMost=function(aG){return this.times(0,aG)};aD.atLeast=function(aH){var aG=this;return aG.times(aH).then(function(aI){return aG.many().map(function(aJ){return aI.concat(aJ)})})};aD.map=function(aG){return this.then(function(aH){return av(aG(aH))})};aD.skip=function(aG){return this.then(function(aH){return aG.result(aH)})};var aw=this.string=function(aI){var aG=aI.length;var aH="expected '"+aI+"'";return at(function(aM,aL,aK){var aJ=aM.slice(0,aG);if(aJ===aI){return aL(aM.slice(aG),aJ)}else{return aK(aM,aH)}})};var aB=this.regex=function(aG){ad("regexp parser is anchored",aG.toString().charAt(1)==="^");var aH="expected "+aG;return at(function(aM,aL,aK){var aJ=aG.exec(aM);
if(aJ){var aI=aJ[0];return aL(aM.slice(aI.length),aI)}else{return aK(aM,aH)}})};var av=at.succeed=function(aG){return at(function(aI,aH){return aH(aI,aG)})};var ar=at.fail=function(aG){return at(function(aJ,aH,aI){return aI(aJ,aG)})};var aq=at.letter=aB(/^[a-z]/i);var ay=at.letters=aB(/^[a-z]*/i);var aA=at.digit=aB(/^[0-9]/);var ap=at.digits=aB(/^[0-9]*/);var P=at.whitespace=aB(/^\s+/);var az=at.optWhitespace=aB(/^\s*/);var ax=at.any=at(function(aI,aH,aG){if(!aI){return aG(aI,"expected any character")}return aH(aI.slice(1),aI.charAt(0))});var aC=at.all=at(function(aI,aH,aG){return aH("",aI)});var aE=at.eof=at(function(aI,aH,aG){if(aI){return aG(aI,"expected EOF")}return aH(aI,aI)})});var A=h(function(P){P.prev=0;P.next=0;P.parent=0;P.firstChild=0;P.lastChild=0;P.children=function(){return H(this.firstChild,this.lastChild)};P.eachChild=function(ap){return this.children().each(ap)};P.foldChildren=function(ap,aq){return this.children().fold(ap,aq)};P.adopt=function(aq,ar,ap){H(this,this).adopt(aq,ar,ap);
return this};P.disown=function(){H(this,this).disown();return this}});var H=h(function(P){P.first=0;P.last=0;P.init=function(ar,aq){ad("no half-empty fragments",!ar===!aq);if(!ar){return}ad("first node is passed to Fragment",ar instanceof A);ad("last node is passed to Fragment",aq instanceof A);ad("first and last have the same parent",ar.parent===aq.parent);this.first=ar;this.last=aq};function ap(ar,at,aq){ad("a parent is always present",ar);ad("prev is properly set up",(function(){if(!at){return ar.firstChild===aq}return at.next===aq&&at.parent===ar})());ad("next is properly set up",(function(){if(!aq){return ar.lastChild===at}return aq.prev===at&&aq.parent===ar})())}P.adopt=function(at,av,ar){ap(at,av,ar);var aq=this;aq.disowned=false;var aw=aq.first;if(!aw){return this}var au=aq.last;if(av){}else{at.firstChild=aw}if(ar){ar.prev=au}else{at.lastChild=au}aq.last.next=ar;aq.each(function(ax){ax.prev=av;ax.parent=at;if(av){av.next=ax}av=ax});return aq};P.disown=function(){var aq=this;var au=aq.first;
if(!au||aq.disowned){return aq}aq.disowned=true;var at=aq.last;var ar=au.parent;ap(ar,au.prev,au);ap(ar,at,at.next);if(au.prev){au.prev.next=at.next}else{ar.firstChild=at.next}if(at.next){at.next.prev=au.prev}else{ar.lastChild=au.prev}return aq};P.each=function(at){var aq=this;var ar=aq.first;if(!ar){return aq}for(;ar!==aq.last.next;ar=ar.next){if(at.call(aq,ar)===false){break}}return aq};P.fold=function(aq,ar){this.each(function(at){aq=ar.call(this,aq,at)});return aq}});var j=(function(){var P=0;return function(){return P+=1}})();var E=h(A,function(P){P.init=function(ap){this.id=j();E[this.id]=this};P.toString=function(){return"[MathElement "+this.id+"]"};P.bubble=function(at){var ap=L.call(arguments,1);for(var ar=this;ar;ar=ar.parent){var aq=ar[at]&&ar[at].apply(ar,ap);if(aq===false){break}}return this};P.postOrder=function(ar){var aq=L.call(arguments,1);if(typeof ar==="string"){var ap=ar;ar=function(au){if(ap in au){au[ap].apply(au,arguments)}}}(function at(au){au.eachChild(at);ar(au)
})(this)};P.jQ=Q();P.jQadd=function(ap){this.jQ=this.jQ.add(ap)};this.jQize=function(ap){var aq=Q(ap);aq.find("*").andSelf().each(function(){var au=Q(this),ar=au.attr("mathquill-command-id"),at=au.attr("mathquill-block-id");if(ar){E[ar].jQadd(au)}if(at){E[at].jQadd(au)}});return aq};P.finalizeInsert=function(){var ap=this;ap.postOrder("finalizeTree");ap.postOrder("blur");ap.postOrder("respace");if(ap.next.respace){ap.next.respace()}if(ap.prev.respace){ap.prev.respace()}ap.postOrder("redraw");ap.bubble("redraw")}});var C=h(E,function(P,ap){P.init=function(at,au,aq){var ar=this;ap.init.call(ar);if(!ar.ctrlSeq){ar.ctrlSeq=at}if(au){ar.htmlTemplate=au}if(aq){ar.textTemplate=aq}};P.replaces=function(aq){aq.disown();this.replacedFragment=aq};P.isEmpty=function(){return this.foldChildren(true,function(aq,ar){return aq&&ar.isEmpty()})};P.parser=function(){var ar=T.block;var aq=this;return ar.times(aq.numBlocks()).map(function(au){aq.blocks=au;for(var at=0;at<au.length;at+=1){au[at].adopt(aq,aq.lastChild,0)
}return aq})};P.createBefore=function(at){var aq=this;var ar=aq.replacedFragment;aq.createBlocks();E.jQize(aq.html());if(ar){ar.adopt(aq.firstChild,0,0);ar.jQ.appendTo(aq.firstChild.jQ)}at.jQ.before(aq.jQ);at.prev=aq.adopt(at.parent,at.prev,at.next);aq.finalizeInsert(at);aq.placeCursor(at)};P.createBlocks=function(){var ar=this,au=ar.numBlocks(),at=ar.blocks=Array(au);for(var aq=0;aq<au;aq+=1){var av=at[aq]=w();av.adopt(ar,ar.lastChild,0)}};P.respace=ag;P.placeCursor=function(aq){aq.appendTo(this.foldChildren(this.firstChild,function(ar,at){return ar.isEmpty()?ar:at}))};P.remove=function(){this.disown();this.jQ.remove();this.postOrder(function(aq){delete E[aq.id]});return this};P.numBlocks=function(){var aq=this.htmlTemplate.match(/&\d+/g);return aq?aq.length:0};P.html=function(){var av=this;var ax=av.blocks;var aq=" mathquill-command-id="+av.id;var aw=av.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);ad("no unmatched angle brackets",aw.join("")===this.htmlTemplate);for(var at=0,ar=aw[0];ar;at+=1,ar=aw[at]){if(ar.slice(-2)==="/>"){aw[at]=ar.slice(0,-2)+aq+"/>"
}else{if(ar.charAt(0)==="<"){ad("not an unmatched top-level close tag",ar.charAt(1)!=="/");aw[at]=ar.slice(0,-1)+aq+">";var au=1;do{at+=1,ar=aw[at];ad("no missing close tags",ar);if(ar.slice(0,2)==="</"){au-=1}else{if(ar.charAt(0)==="<"&&ar.slice(-2)!=="/>"){au+=1}}}while(au>0)}}}return aw.join("").replace(/>&(\d+)/g,function(az,ay){return" mathquill-block-id="+ax[ay].id+">"+ax[ay].join("html")})};P.latex=function(){return this.foldChildren(this.ctrlSeq,function(aq,ar){return aq+"{"+(ar.latex()||" ")+"}"})};P.textTemplate=[""];P.text=function(){var aq=0;return this.foldChildren(this.textTemplate[aq],function(at,au){aq+=1;var ar=au.text();if(at&&this.textTemplate[aq]==="("&&ar[0]==="("&&ar.slice(-1)===")"){return at+ar.slice(1,-1)+this.textTemplate[aq]}return at+au.text()+(this.textTemplate[aq]||"")})}});var X=h(C,function(P,ap){P.init=function(ar,aq,at){if(!at){at=ar&&ar.length>1?ar.slice(1):ar}ap.init.call(this,ar,aq,[at])};P.parser=function(){return c.succeed(this)};P.numBlocks=function(){return 0
};P.replaces=function(aq){aq.remove()};P.createBlocks=ag;P.latex=function(){return this.ctrlSeq};P.text=function(){return this.textTemplate};P.placeCursor=ag;P.isEmpty=function(){return true}});var w=h(E,function(P){P.join=function(ap){return this.foldChildren("",function(aq,ar){return aq+ar[ap]()})};P.latex=function(){return this.join("latex")};P.text=function(){return this.firstChild===this.lastChild?this.firstChild.text():"("+this.join("text")+")"};P.isEmpty=function(){return this.firstChild===0&&this.lastChild===0};P.focus=function(){this.jQ.addClass("hasCursor");this.jQ.removeClass("empty");return this};P.blur=function(){this.jQ.removeClass("hasCursor");if(this.isEmpty()){this.jQ.addClass("empty")}return this}});var Z=h(H,function(P,ap){P.init=function(ar,aq){ap.init.call(this,ar,aq||ar);this.jQ=this.fold(Q(),function(at,au){return au.jQ.add(at)})};P.latex=function(){return this.fold("",function(ar,aq){return ar+aq.latex()})};P.remove=function(){this.jQ.remove();this.each(function(aq){aq.postOrder(function(ar){delete E[ar.id]
})});return this.disown()}});function af(av,ay,ax,aq){var ar=av.contents().detach();if(!ax){av.addClass("mathquill-rendered-math")}ay.jQ=av.attr(k,ay.id);ay.revert=function(){av.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(ar)};var aB=ay.cursor=J(ay);ay.renderLatex(ar.text());var aC=ay.textarea=Q('<span class="textarea"><textarea></textarea></span>'),aA=aC.children();var au;ay.selectionChanged=function(){if(au===t){au=setTimeout(P)}l(av[0])};function P(){au=t;var aD=aB.selection?"$"+aB.selection.latex()+"$":"";aw.select(aD)}av.bind("selectstart.mathquill",function(aD){if(aD.target!==aA[0]){aD.preventDefault()}aD.stopPropagation()});var at,ap=aB.blink;av.bind("mousedown.mathquill",function(aE){function aD(aH){aB.seek(Q(aH.target),aH.pageX,aH.pageY);if(aB.prev!==at.prev||aB.parent!==at.parent){aB.selectFrom(at)}return false}function aG(aH){delete aH.target;return aD(aH)}function aF(aH){at=t;aB.blink=ap;if(!aB.selection){if(aq){aB.show()
}else{aC.detach()}}av.unbind("mousemove",aD);Q(aH.target.ownerDocument).unbind("mousemove",aG).unbind("mouseup",aF)}setTimeout(function(){aA.focus()});aB.blink=ag;aB.seek(Q(aE.target),aE.pageX,aE.pageY);at={parent:aB.parent,prev:aB.prev,next:aB.next};if(!aq){av.prepend(aC)}av.mousemove(aD);Q(aE.target.ownerDocument).mousemove(aG).mouseup(aF);return false});if(!aq){var aw=m(aA,{container:av});av.bind("cut paste",false).bind("copy",P).prepend('<span class="selectable">$'+ay.latex()+"$</span>");aA.blur(function(){aB.clearSelection();setTimeout(az)});function az(){aC.detach()}return}var aw=m(aA,{container:av,key:function(aE,aD){aB.parent.bubble("onKey",aE,aD)},text:function(aD){aB.parent.bubble("onText",aD)},cut:function(aD){if(aB.selection){setTimeout(function(){aB.prepareEdit();aB.parent.bubble("redraw")})}aD.stopPropagation()},paste:function(aD){if(aD.slice(0,1)==="$"&&aD.slice(-1)==="$"){aD=aD.slice(1,-1)}else{aD="\\text{"+aD+"}"}aB.writeLatex(aD).show()}});av.prepend(aC);av.addClass("mathquill-editable");
if(ax){av.addClass("mathquill-textbox")}aA.focus(function(aD){if(!aB.parent){aB.appendTo(ay)}aB.parent.jQ.addClass("hasCursor");if(aB.selection){aB.selection.jQ.removeClass("blur");setTimeout(ay.selectionChanged)}else{aB.show()}aD.stopPropagation()}).blur(function(aD){aB.hide().parent.blur();if(aB.selection){aB.selection.jQ.addClass("blur")}aD.stopPropagation()});av.bind("focus.mathquill blur.mathquill",function(aD){aA.trigger(aD)}).blur()}var n=h(w,function(P,ap){P.latex=function(){return ap.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/ig,"$1")};P.text=function(){return this.foldChildren("",function(aq,ar){return aq+ar.text()})};P.renderLatex=function(aq){var ar=this.jQ;ar.children().slice(1).remove();this.firstChild=this.lastChild=0;this.cursor.appendTo(this).writeLatex(aq)};P.onKey=function(aq,at){switch(aq){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":while(this.cursor.prev||this.cursor.selection){this.cursor.backspace()}break;case"Shift-Backspace":case"Backspace":this.cursor.backspace();
break;case"Esc":case"Tab":case"Spacebar":var ar=this.cursor.parent;if(ar===this.cursor.root){if(aq==="Spacebar"){at.preventDefault()}return}this.cursor.prepareMove();if(ar.next){this.cursor.prependTo(ar.next)}else{this.cursor.insertAfter(ar.parent)}break;case"Shift-Tab":case"Shift-Esc":case"Shift-Spacebar":var ar=this.cursor.parent;if(ar===this.cursor.root){if(aq==="Shift-Spacebar"){at.preventDefault()}return}this.cursor.prepareMove();if(ar.prev){this.cursor.appendTo(ar.prev)}else{this.cursor.insertBefore(ar.parent)}break;case"Enter":break;case"End":this.cursor.prepareMove().appendTo(this.cursor.parent);break;case"Ctrl-End":this.cursor.prepareMove().appendTo(this);break;case"Shift-End":while(this.cursor.next){this.cursor.selectRight()}break;case"Ctrl-Shift-End":while(this.cursor.next||this.cursor.parent!==this){this.cursor.selectRight()}break;case"Home":this.cursor.prepareMove().prependTo(this.cursor.parent);break;case"Ctrl-Home":this.cursor.prepareMove().prependTo(this);break;case"Shift-Home":while(this.cursor.prev){this.cursor.selectLeft()
}break;case"Ctrl-Shift-Home":while(this.cursor.prev||this.cursor.parent!==this){this.cursor.selectLeft()}break;case"Left":this.cursor.moveLeft();break;case"Shift-Left":this.cursor.selectLeft();break;case"Ctrl-Left":break;case"Right":this.cursor.moveRight();break;case"Shift-Right":this.cursor.selectRight();break;case"Ctrl-Right":break;case"Up":this.cursor.moveUp();break;case"Down":this.cursor.moveDown();break;case"Shift-Up":if(this.cursor.prev){while(this.cursor.prev){this.cursor.selectLeft()}}else{this.cursor.selectLeft()}case"Shift-Down":if(this.cursor.next){while(this.cursor.next){this.cursor.selectRight()}}else{this.cursor.selectRight()}case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":while(this.cursor.next||this.cursor.selection){this.cursor.deleteForward()}break;case"Shift-Del":case"Del":this.cursor.deleteForward();break;case"Meta-A":case"Ctrl-A":if(this!==this.cursor.root){return}this.cursor.prepareMove().appendTo(this);while(this.cursor.prev){this.cursor.selectLeft()
}break;default:return false}at.preventDefault();return false};P.onText=function(aq){this.cursor.write(aq);return false}});var ai=h(C,function(P,ap){P.init=function(aq){ap.init.call(this,"$");this.cursor=aq};P.htmlTemplate='<span class="mathquill-rendered-math">&0</span>';P.createBlocks=function(){this.firstChild=this.lastChild=n();this.blocks=[this.firstChild];this.firstChild.parent=this;var aq=this.firstChild.cursor=this.cursor;this.firstChild.onText=function(ar){if(ar!=="$"||aq.parent!==this){aq.write(ar)}else{if(this.isEmpty()){aq.insertAfter(this.parent).backspace().insertNew(ab("\\$","$")).show()}else{if(!aq.next){aq.insertAfter(this.parent)}else{if(!aq.prev){aq.insertBefore(this.parent)}else{aq.write(ar)}}}}return false}};P.latex=function(){return"$"+this.firstChild.latex()+"$"}});var V=h(w,function(P){P.renderLatex=function(at){var aD=this;var aB=aD.cursor;aD.jQ.children().slice(1).remove();aD.firstChild=aD.lastChild=0;aB.show().appendTo(aD);var ay=c.regex;var aw=c.string;var aC=c.eof;
var aA=c.all;var ax=aw("$").then(T).skip(aw("$").or(aC)).map(function(aG){var aF=ai(aB);aF.createBlocks();var aE=aF.firstChild;aG.children().adopt(aE,0,0);return aF});var az=aw("\\$").result("$");var aq=az.or(ay(/^[^$]/)).map(ab);var ap=ax.or(aq).many();var ar=ap.skip(aC).or(aA.result(false)).parse(at);if(ar){for(var au=0;au<ar.length;au+=1){ar[au].adopt(aD,aD.lastChild,0)}var av=aD.join("html");E.jQize(av).appendTo(aD.jQ);this.finalizeInsert()}};P.onKey=n.prototype.onKey;P.onText=function(ap){this.cursor.prepareEdit();if(ap==="$"){this.cursor.insertNew(ai(this.cursor))}else{this.cursor.insertNew(ab(ap))}return false}});var y={},K={};var R,l=ag,ah=document.createElement("div"),an=ah.style,G={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1},a;for(var x in G){if(x in an){a=x;break}}if(a){R=function(ap,P,aq){ap.css(a,"scale("+P+","+aq+")")}}else{if("filter" in an){l=function(P){P.className=P.className};R=function(ar,P,au){P/=(1+(au-1)/2);ar.css("fontSize",au+"em");if(!ar.hasClass("matrixed-container")){ar.addClass("matrixed-container").wrapInner('<span class="matrixed"></span>')
}var at=ar.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+P+",SizingMethod='auto expand')");function aq(){ar.css("marginRight",(at.width()-1)*(P-1)/P+"px")}aq();var ap=setInterval(aq);Q(window).load(function(){clearTimeout(ap);aq()})}}else{R=function(ap,P,aq){ap.css("fontSize",aq+"em")}}}var I=h(C,function(P,ap){P.init=function(at,ar,aq){ap.init.call(this,at,"<"+ar+" "+aq+">&0</"+ar+">")}});K.mathrm=e(I,"\\mathrm","span",'class="roman font"');K.mathit=e(I,"\\mathit","i",'class="font"');K.mathbf=e(I,"\\mathbf","b",'class="font"');K.mathsf=e(I,"\\mathsf","span",'class="sans-serif font"');K.mathtt=e(I,"\\mathtt","span",'class="monospace font"');K.underline=e(I,"\\underline","span",'class="non-leaf underline"');K.overline=K.bar=e(I,"\\overline","span",'class="non-leaf overline"');K.overleftrightarrow=K.bar=e(I,"\\overleftrightarrow","span",'class="non-leaf overleftrightarrow"');K.overrightarrow=K.bar=e(I,"\\overrightarrow","span",'class="non-leaf overrightarrow"');var am=h(C,function(P,ap){P.init=function(ar,aq,at){ap.init.call(this,ar,"<"+aq+' class="non-leaf">&0</'+aq+">",[at])
};P.finalizeTree=function(){ad("SupSub is only _ and ^",this.ctrlSeq==="^"||this.ctrlSeq==="_");if(this.ctrlSeq==="_"){this.down=this.firstChild;this.firstChild.up=aq}else{this.up=this.firstChild;this.firstChild.down=aq}function aq(au){var ar=this.parent,at=au;do{if(at.next){au.insertBefore(ar);return false}at=at.parent.parent}while(at!==ar);au.insertAfter(ar);return false}};P.latex=function(){var aq=this.firstChild.latex();if(aq.length===1){return this.ctrlSeq+aq}else{return this.ctrlSeq+"{"+(aq||" ")+"}"}};P.redraw=function(){if(this.prev){this.prev.respace()}if(!(this.prev instanceof am)){this.respace();if(this.next&&!(this.next instanceof am)){this.next.respace()}}};P.respace=function(){if(this.prev.ctrlSeq==="\\int "||(this.prev instanceof am&&this.prev.ctrlSeq!=this.ctrlSeq&&this.prev.prev&&this.prev.prev.ctrlSeq==="\\int ")){if(!this.limit){this.limit=true;this.jQ.addClass("limit")}}else{if(this.limit){this.limit=false;this.jQ.removeClass("limit")}}this.respaced=this.prev instanceof am&&this.prev.ctrlSeq!=this.ctrlSeq&&!this.prev.respaced;
if(this.respaced){var ar=+this.jQ.css("fontSize").slice(0,-2),aq=this.prev.jQ.outerWidth(),at=this.jQ.outerWidth();this.jQ.css({left:(this.limit&&this.ctrlSeq==="_"?-0.25:0)-aq/ar+"em",marginRight:0.1-al(at,aq)/ar+"em"})}else{if(this.limit&&this.ctrlSeq==="_"){this.jQ.css({left:"-.25em",marginRight:""})}else{this.jQ.css({left:"",marginRight:""})}}if(this.next instanceof am){this.next.respace()}return this}});K.subscript=K._=e(am,"_","sub","_");K.superscript=K.supscript=K["^"]=e(am,"^","sup","**");var aa=K.frac=K.dfrac=K.cfrac=K.fraction=h(C,function(P,ap){P.ctrlSeq="\\frac";P.htmlTemplate='<span class="fraction non-leaf"><span class="numerator">&0</span><span class="denominator">&1</span><span style="display:inline-block;width:0">&nbsp;</span></span>';P.textTemplate=["(","/",")"];P.finalizeTree=function(){this.up=this.lastChild.up=this.firstChild;this.down=this.firstChild.down=this.lastChild}});var g=K.over=y["/"]=h(aa,function(P,ap){P.createBefore=function(ar){if(!this.replacedFragment){var aq=ar.prev;
while(aq&&!(aq instanceof aj||aq instanceof ac||aq instanceof v)){aq=aq.prev}if(aq instanceof v&&aq.next instanceof am){aq=aq.next;if(aq.next instanceof am&&aq.next.ctrlSeq!=aq.ctrlSeq){aq=aq.next}}if(aq!==ar.prev){this.replaces(Z(aq.next||ar.parent.firstChild,ar.prev));ar.prev=aq}}ap.createBefore.call(this,ar)}});var u=K.sqrt=K["√"]=h(C,function(P,ap){P.ctrlSeq="\\sqrt";P.htmlTemplate='<span class="non-leaf"><span class="scaled sqrt-prefix">&radic;</span><span class="non-leaf sqrt-stem">&0</span></span>';P.textTemplate=["sqrt(",")"];P.parser=function(){return T.optBlock.then(function(aq){return T.block.map(function(at){var ar=ak();ar.blocks=[aq,at];aq.adopt(ar,0,0);at.adopt(ar,aq,0);return ar})}).or(ap.parser.call(this))};P.redraw=function(){var aq=this.lastChild.jQ;R(aq.prev(),1,aq.innerHeight()/+aq.css("fontSize").slice(0,-2)-0.1)}});var ak=K.nthroot=h(u,function(P,ap){P.htmlTemplate='<sup class="nthroot non-leaf">&0</sup><span class="scaled"><span class="sqrt-prefix scaled">&radic;</span><span class="sqrt-stem non-leaf">&1</span></span>';
P.textTemplate=["sqrt[","](",")"];P.latex=function(){return"\\sqrt["+this.firstChild.latex()+"]{"+this.lastChild.latex()+"}"}});var B=h(C,function(P,ap){P.init=function(ar,au,at,aq){ap.init.call(this,"\\left"+at,'<span class="non-leaf"><span class="scaled paren">'+ar+'</span><span class="non-leaf">&0</span><span class="scaled paren">'+au+"</span></span>",[ar,au]);this.end="\\right"+aq};P.jQadd=function(){ap.jQadd.apply(this,arguments);var aq=this.jQ;this.bracketjQs=aq.children(":first").add(aq.children(":last"))};P.latex=function(){return this.ctrlSeq+this.firstChild.latex()+this.end};P.redraw=function(){var ar=this.firstChild.jQ;var aq=ar.outerHeight()/+ar.css("fontSize").slice(0,-2);R(this.bracketjQs,al(1+0.2*(aq-1),1.2),1.05*aq)}});K.left=h(C,function(P){P.parser=function(){var aq=c.regex;var ap=c.string;var aq=c.regex;var ar=c.succeed;var au=T.block;var at=c.optWhitespace;return at.then(aq(/^(?:[([|]|\\\{)/)).then(function(av){if(av.charAt(0)==="\\"){av=av.slice(1)}var aw=y[av]();return T.map(function(ax){aw.blocks=[ax];
ax.adopt(aw,0,0)}).then(ap("\\right")).skip(at).then(aq(/^(?:[\])|]|\\\})/)).then(function(ax){if(ax.slice(-1)!==aw.end.slice(-1)){return c.fail("open doesn't match close")}return ar(aw)})})}});K.right=h(C,function(P){P.parser=function(){return c.fail("unmatched \\right")}});K.lbrace=y["{"]=e(B,"{","}","\\{","\\}");K.langle=K.lang=e(B,"&lang;","&rang;","\\langle ","\\rangle ");var W=h(B,function(P,ap){P.createBefore=function(aq){if(!aq.next&&aq.parent.parent&&aq.parent.parent.end===this.end&&!this.replacedFragment){aq.insertAfter(aq.parent.parent)}else{ap.createBefore.call(this,aq)}};P.placeCursor=function(aq){this.firstChild.blur();aq.insertAfter(this)}});K.rbrace=y["}"]=e(W,"{","}","\\{","\\}");K.rangle=K.rang=e(W,"&lang;","&rang;","\\langle ","\\rangle ");var r=function(P,ap){P.init=function(aq,ar){ap.init.call(this,aq,ar,aq,ar)}};var M=h(B,r);K.lparen=y["("]=e(M,"(",")");K.lbrack=K.lbracket=y["["]=e(M,"[","]");var O=h(W,r);K.rparen=y[")"]=e(O,"(",")");K.rbrack=K.rbracket=y["]"]=e(O,"[","]");
var b=K.lpipe=K.rpipe=y["|"]=h(M,function(P,ap){P.init=function(){ap.init.call(this,"|","|")};P.createBefore=W.prototype.createBefore});var ac=y.$=K.text=K.textnormal=K.textrm=K.textup=K.textmd=h(C,function(P,ap){P.ctrlSeq="\\text";P.htmlTemplate='<span class="text">&0</span>';P.replaces=function(aq){if(aq instanceof Z){this.replacedText=aq.remove().jQ.text()}else{if(typeof aq==="string"){this.replacedText=aq}}};P.textTemplate=['"','"'];P.parser=function(){var aq=c.string;var ar=c.regex;var at=c.optWhitespace;return at.then(aq("{")).then(ar(/^[^}]*/)).skip(aq("}")).map(function(ay){var aw=ac();aw.createBlocks();var ax=aw.firstChild;for(var au=0;au<ay.length;au+=1){var av=ab(ay.charAt(au));av.adopt(ax,ax.lastChild,0)}return aw})};P.createBlocks=function(){this.firstChild=this.lastChild=q();this.blocks=[this.firstChild];this.firstChild.parent=this};P.finalizeInsert=function(){this.firstChild.blur=function(){delete this.blur;return this};ap.finalizeInsert.call(this)};P.createBefore=function(ar){ap.createBefore.call(this,this.cursor=ar);
if(this.replacedText){for(var aq=0;aq<this.replacedText.length;aq+=1){this.write(this.replacedText.charAt(aq))}}};P.write=function(aq){this.cursor.insertNew(ab(aq))};P.onKey=function(aq,ar){if(!this.cursor.selection&&((aq==="Backspace"&&!this.cursor.prev)||(aq==="Del"&&!this.cursor.next))){if(this.isEmpty()){this.cursor.insertAfter(this)}return false}};P.onText=function(ar){this.cursor.prepareEdit();if(ar!=="$"){this.write(ar)}else{if(this.isEmpty()){this.cursor.insertAfter(this).backspace().insertNew(ab("\\$","$"))}else{if(!this.cursor.next){this.cursor.insertAfter(this)}else{if(!this.cursor.prev){this.cursor.insertBefore(this)}else{var aq=ac(Z(this.cursor.next,this.firstChild.lastChild));aq.placeCursor=function(at){this.prev=0;delete this.placeCursor;this.placeCursor(at)};aq.firstChild.focus=function(){return this};this.cursor.insertAfter(this).insertNew(aq);aq.prev=this;this.cursor.insertBefore(aq);delete aq.firstChild.focus}}}}return false}});var q=h(w,function(P,ap){P.blur=function(){this.jQ.removeClass("hasCursor");
if(this.isEmpty()){var aq=this.parent,ar=aq.cursor;if(ar.parent===this){this.jQ.addClass("empty")}else{ar.hide();aq.remove();if(ar.next===aq){ar.next=aq.next}else{if(ar.prev===aq){ar.prev=aq.prev}}ar.show().parent.bubble("redraw")}}return this};P.focus=function(){ap.focus.call(this);var ar=this.parent;if(ar.next.ctrlSeq===ar.ctrlSeq){var au=this,at=ar.cursor,aq=ar.next.firstChild;aq.eachChild(function(av){av.parent=au;av.jQ.appendTo(au.jQ)});if(this.lastChild){this.lastChild.next=aq.firstChild}else{this.firstChild=aq.firstChild}aq.firstChild.prev=this.lastChild;this.lastChild=aq.lastChild;aq.parent.remove();if(at.prev){at.insertAfter(at.prev)}else{at.prependTo(this)}at.parent.bubble("redraw")}else{if(ar.prev.ctrlSeq===ar.ctrlSeq){var at=ar.cursor;if(at.prev){ar.prev.firstChild.focus()}else{at.appendTo(ar.prev.firstChild)}}}return this}});function o(aq,ap,P){return h(ac,{ctrlSeq:aq,htmlTemplate:"<"+ap+" "+P+">&0</"+ap+">"})}K.em=K.italic=K.italics=K.emph=K.textit=K.textsl=o("\\textit","i",'class="text"');
K.strong=K.bold=K.textbf=o("\\textbf","b",'class="text"');K.sf=K.textsf=o("\\textsf","span",'class="sans-serif text"');K.tt=K.texttt=o("\\texttt","span",'class="monospace text"');K.textsc=o("\\textsc","span",'style="font-variant:small-caps" class="text"');K.uppercase=o("\\uppercase","span",'style="text-transform:uppercase" class="text"');K.lowercase=o("\\lowercase","span",'style="text-transform:lowercase" class="text"');var Y=y["\\"]=h(C,function(P,ap){P.ctrlSeq="\\";P.replaces=function(aq){this._replacedFragment=aq.disown();this.isEmpty=function(){return false}};P.htmlTemplate='<span class="latex-command-input non-leaf">\\<span>&0</span></span>';P.textTemplate=["\\"];P.createBlocks=function(){ap.createBlocks.call(this);this.firstChild.focus=function(){this.parent.jQ.addClass("hasCursor");if(this.isEmpty()){this.parent.jQ.removeClass("empty")}return this};this.firstChild.blur=function(){this.parent.jQ.removeClass("hasCursor");if(this.isEmpty()){this.parent.jQ.addClass("empty")}return this
}};P.createBefore=function(ar){ap.createBefore.call(this,ar);this.cursor=ar.appendTo(this.firstChild);if(this._replacedFragment){var aq=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(at){Q(at.target=aq).trigger(at);return false}).insertBefore(this.jQ).add(this.jQ)}};P.latex=function(){return"\\"+this.firstChild.latex()+" "};P.onKey=function(aq,ar){if(aq==="Tab"||aq==="Enter"||aq==="Spacebar"){this.renderCommand();ar.preventDefault();return false}};P.onText=function(aq){if(aq.match(/[a-z]/i)){this.cursor.prepareEdit();this.cursor.insertNew(ab(aq));return false}this.renderCommand();if(aq==="\\"&&this.firstChild.isEmpty()){return false}};P.renderCommand=function(){this.jQ=this.jQ.last();this.remove();if(this.next){this.cursor.insertBefore(this.next)}else{this.cursor.appendTo(this.parent)}var ar=this.firstChild.latex(),aq;if(!ar){ar="backslash"}this.cursor.insertCmd(ar,this._replacedFragment)}});var N=K.binom=K.binomial=h(C,function(P,ap){P.ctrlSeq="\\binom";
P.htmlTemplate='<span class="paren scaled">(</span><span class="non-leaf"><span class="array non-leaf"><span>&0</span><span>&1</span></span></span><span class="paren scaled">)</span>';P.textTemplate=["choose(",",",")"];P.redraw=function(){var at=this.jQ.eq(1);var aq=at.outerHeight()/+at.css("fontSize").slice(0,-2);var ar=this.jQ.filter(".paren");R(ar,al(1+0.2*(aq-1),1.2),1.05*aq)}});var p=K.choose=h(N,function(P){P.createBefore=g.prototype.createBefore});var D=K.vector=h(C,function(P,ap){P.ctrlSeq="\\vector";P.htmlTemplate='<span class="array"><span>&0</span></span>';P.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(aq,ar){aq.push(ar.latex());return aq}).join("\\\\")+"\\end{matrix}"};P.text=function(){return"["+this.foldChildren([],function(aq,ar){aq.push(ar.text());return aq}).join()+"]"};P.createBefore=function(aq){ap.createBefore.call(this,this.cursor=aq)};P.onKey=function(aq,at){var ar=this.cursor.parent;if(ar.parent===this){if(aq==="Enter"){var au=w();au.parent=this;
au.jQ=Q("<span></span>").attr(k,au.id).insertAfter(ar.jQ);if(ar.next){ar.next.prev=au}else{this.lastChild=au}au.next=ar.next;ar.next=au;au.prev=ar;this.bubble("redraw").cursor.appendTo(au);at.preventDefault();return false}else{if(aq==="Tab"&&!ar.next){if(ar.isEmpty()){if(ar.prev){this.cursor.insertAfter(this);delete ar.prev.next;this.lastChild=ar.prev;ar.jQ.remove();this.bubble("redraw");at.preventDefault();return false}else{return}}var au=w();au.parent=this;au.jQ=Q("<span></span>").attr(k,au.id).appendTo(this.jQ);this.lastChild=au;ar.next=au;au.prev=ar;this.bubble("redraw").cursor.appendTo(au);at.preventDefault();return false}else{if(at.which===8){if(ar.isEmpty()){if(ar.prev){this.cursor.appendTo(ar.prev);ar.prev.next=ar.next}else{this.cursor.insertBefore(this);this.firstChild=ar.next}if(ar.next){ar.next.prev=ar.prev}else{this.lastChild=ar.prev}ar.jQ.remove();if(this.isEmpty()){this.cursor.deleteForward()}else{this.bubble("redraw")}at.preventDefault();return false}else{if(!this.cursor.prev){at.preventDefault();
return false}}}}}}}});K.editable=h(ai,function(P,ap){P.init=function(){C.prototype.init.call(this,"\\editable")};P.jQadd=function(){var aq=this;ap.jQadd.apply(aq,arguments);var ar=aq.firstChild.disown();var at=aq.jQ.children().detach();aq.firstChild=aq.lastChild=n();aq.blocks=[aq.firstChild];aq.firstChild.parent=aq;af(aq.jQ,aq.firstChild,false,true);aq.cursor=aq.firstChild.cursor;ar.children().adopt(aq.firstChild,0,0);at.appendTo(aq.firstChild.jQ);aq.firstChild.cursor.appendTo(aq.firstChild)};P.latex=function(){return this.firstChild.latex()};P.text=function(){return this.firstChild.text()}});K.f=e(X,"f",'<var class="florin">&fnof;</var><span style="display:inline-block;width:0">&nbsp;</span>');var s=h(X,function(P,ap){P.init=function(ar,aq){ap.init.call(this,ar,"<var>"+(aq||ar)+"</var>")};P.text=function(){var aq=this.ctrlSeq;if(this.prev&&!(this.prev instanceof s)&&!(this.prev instanceof aj)){aq="*"+aq}if(this.next&&!(this.next instanceof aj)&&!(this.next.ctrlSeq==="^")){aq+="*"}return aq
}});var ab=h(X,function(P,ap){P.init=function(ar,aq){ap.init.call(this,ar,"<span>"+(aq||ar)+"</span>")}});y[" "]=e(ab,"\\:"," ");K.prime=y["'"]=e(ab,"'","&prime;");var f=h(X,function(P,ap){P.init=function(ar,aq){ap.init.call(this,ar,'<span class="nonSymbola">'+(aq||ar)+"</span>")}});K["@"]=f;K["&"]=e(f,"\\&","&amp;");K["%"]=e(f,"\\%","%");K.alpha=K.beta=K.gamma=K.delta=K.zeta=K.eta=K.theta=K.iota=K.kappa=K.mu=K.nu=K.xi=K.rho=K.sigma=K.tau=K.chi=K.psi=K.omega=h(s,function(P,ap){P.init=function(aq){ap.init.call(this,"\\"+aq+" ","&"+aq+";")}});K.phi=e(s,"\\phi ","&#981;");K.phiv=K.varphi=e(s,"\\varphi ","&phi;");K.epsilon=e(s,"\\epsilon ","&#1013;");K.epsiv=K.varepsilon=e(s,"\\varepsilon ","&epsilon;");K.piv=K.varpi=e(s,"\\varpi ","&piv;");K.sigmaf=K.sigmav=K.varsigma=e(s,"\\varsigma ","&sigmaf;");K.thetav=K.vartheta=K.thetasym=e(s,"\\vartheta ","&thetasym;");K.upsilon=K.upsi=e(s,"\\upsilon ","&upsilon;");K.gammad=K.Gammad=K.digamma=e(s,"\\digamma ","&#989;");K.kappav=K.varkappa=e(s,"\\varkappa ","&#1008;");
K.rhov=K.varrho=e(s,"\\varrho ","&#1009;");K.pi=K["π"]=e(f,"\\pi ","&pi;");K.lambda=e(f,"\\lambda ","&lambda;");K.Upsilon=K.Upsi=K.upsih=K.Upsih=e(X,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>');K.Gamma=K.Delta=K.Theta=K.Lambda=K.Xi=K.Pi=K.Sigma=K.Phi=K.Psi=K.Omega=K.forall=h(ab,function(P,ap){P.init=function(aq){ap.init.call(this,"\\"+aq+" ","&"+aq+";")}});var ae=h(C,function(P){P.init=function(ap){this.latex=ap};P.createBefore=function(ap){ap.writeLatex(this.latex)};P.parser=function(){var ap=T.parse(this.latex).children();return c.succeed(ap)}});K["¹"]=e(ae,"^1");K["²"]=e(ae,"^2");K["³"]=e(ae,"^3");K["¼"]=e(ae,"\\frac14");K["½"]=e(ae,"\\frac12");K["¾"]=e(ae,"\\frac34");var aj=h(X,function(P,ap){P.init=function(ar,aq,at){ap.init.call(this,ar,'<span class="binary-operator">'+aq+"</span>",at)}});var d=h(aj,function(P){P.init=ab.prototype.init;P.respace=function(){if(!this.prev){this.jQ[0].className=""}else{if(this.prev instanceof aj&&this.next&&!(this.next instanceof aj)){this.jQ[0].className="unary-operator"
}else{this.jQ[0].className="binary-operator"}}return this}});K["+"]=e(d,"+","+");K["–"]=K["-"]=e(d,"-","&minus;");K["±"]=K.pm=K.plusmn=K.plusminus=e(d,"\\pm ","&plusmn;");K.mp=K.mnplus=K.minusplus=e(d,"\\mp ","&#8723;");y["*"]=K.sdot=K.cdot=e(aj,"\\cdot ","&middot;");K["="]=e(aj,"=","=");K["<"]=e(aj,"<","&lt;");K[">"]=e(aj,">","&gt;");K.notin=K.sim=K.cong=K.equiv=K.oplus=K.otimes=h(aj,function(P,ap){P.init=function(aq){ap.init.call(this,"\\"+aq+" ","&"+aq+";")}});K.times=e(aj,"\\times ","&times;","[x]");K["÷"]=K.div=K.divide=K.divides=e(aj,"\\div ","&divide;","[/]");K["≠"]=K.ne=K.neq=e(aj,"\\ne ","&ne;");K.ast=K.star=K.loast=K.lowast=e(aj,"\\ast ","&lowast;");K.therefor=K.therefore=e(aj,"\\therefore ","&there4;");K.cuz=K.because=e(aj,"\\because ","&#8757;");K.prop=K.propto=e(aj,"\\propto ","&prop;");K["≈"]=K.asymp=K.approx=e(aj,"\\approx ","&asymp;");K.napprox=e(aj,"\\not\\approx ","&#8777;");K.lt=e(aj,"<","&lt;");K.gt=e(aj,">","&gt;");K["≤"]=K.le=K.leq=e(aj,"\\le ","&le;");K["≥"]=K.ge=K.geq=e(aj,"\\ge ","&ge;");
K.isin=K["in"]=e(aj,"\\in ","&isin;");K.ni=K.contains=e(aj,"\\ni ","&ni;");K.notni=K.niton=K.notcontains=K.doesnotcontain=e(aj,"\\not\\ni ","&#8716;");K.sub=K.subset=e(aj,"\\subset ","&sub;");K.sup=K.supset=K.superset=e(aj,"\\supset ","&sup;");K.nsub=K.notsub=K.nsubset=K.notsubset=e(aj,"\\not\\subset ","&#8836;");K.nsup=K.notsup=K.nsupset=K.notsupset=K.nsuperset=K.notsuperset=e(aj,"\\not\\supset ","&#8837;");K.sube=K.subeq=K.subsete=K.subseteq=e(aj,"\\subseteq ","&sube;");K.supe=K.supeq=K.supsete=K.supseteq=K.supersete=K.superseteq=e(aj,"\\supseteq ","&supe;");K.nsube=K.nsubeq=K.notsube=K.notsubeq=K.nsubsete=K.nsubseteq=K.notsubsete=K.notsubseteq=e(aj,"\\not\\subseteq ","&#8840;");K.nsupe=K.nsupeq=K.notsupe=K.notsupeq=K.nsupsete=K.nsupseteq=K.notsupsete=K.notsupseteq=K.nsupersete=K.nsuperseteq=K.notsupersete=K.notsuperseteq=e(aj,"\\not\\supseteq ","&#8841;");var v=h(X,function(P,ap){P.init=function(ar,aq){ap.init.call(this,ar,"<big>"+aq+"</big>")}});K["∑"]=K.sum=K.summation=e(v,"\\sum ","&sum;");
K["∏"]=K.prod=K.product=e(v,"\\prod ","&prod;");K.coprod=K.coproduct=e(v,"\\coprod ","&#8720;");K["∫"]=K["int"]=K.integral=e(v,"\\int ","&int;");K.naturals=K.Naturals=e(ab,"\\mathbb{N}","&#8469;");K.primes=K.Primes=K.projective=K.Projective=K.probability=K.Probability=e(ab,"\\mathbb{P}","&#8473;");K.integers=K.Integers=e(ab,"\\mathbb{Z}","&#8484;");K.rationals=K.Rationals=e(ab,"\\mathbb{Q}","&#8474;");K.reals=K.Reals=e(ab,"\\mathbb{R}","&#8477;");K.complex=K.Complex=K.complexes=K.Complexes=K.complexplane=K.Complexplane=K.ComplexPlane=e(ab,"\\mathbb{C}","&#8450;");K.Hamiltonian=K.quaternions=K.Quaternions=e(ab,"\\mathbb{H}","&#8461;");K.quad=K.emsp=e(ab,"\\quad ","    ");K.qquad=e(ab,"\\qquad ","        ");K.diamond=e(ab,"\\diamond ","&#9671;");K.bigtriangleup=e(ab,"\\bigtriangleup ","&#9651;");K.ominus=e(ab,"\\ominus ","&#8854;");K.uplus=e(ab,"\\uplus ","&#8846;");K.bigtriangledown=e(ab,"\\bigtriangledown ","&#9661;");K.sqcap=e(ab,"\\sqcap ","&#8851;");K.lhd=e(ab,"\\lhd ","&#8882;");K.triangleleft=e(ab,"\\triangleleft ","&#8882;");
K.sqcup=e(ab,"\\sqcup ","&#8852;");K.rhd=e(ab,"\\rhd ","&#8883;");K.triangleright=e(ab,"\\triangleright ","&#8883;");K.odot=e(ab,"\\odot ","&#8857;");K.bigcirc=e(ab,"\\bigcirc ","&#9711;");K.dagger=e(ab,"\\dagger ","&#0134;");K.ddagger=e(ab,"\\ddagger ","&#135;");K.wr=e(ab,"\\wr ","&#8768;");K.amalg=e(ab,"\\amalg ","&#8720;");K.models=e(ab,"\\models ","&#8872;");K.prec=e(ab,"\\prec ","&#8826;");K.succ=e(ab,"\\succ ","&#8827;");K.preceq=e(ab,"\\preceq ","&#8828;");K.succeq=e(ab,"\\succeq ","&#8829;");K.simeq=e(ab,"\\simeq ","&#8771;");K.mid=e(ab,"\\mid ","&#8739;");K.ll=e(ab,"\\ll ","&#8810;");K.gg=e(ab,"\\gg ","&#8811;");K.parallel=e(ab,"\\parallel ","&#8741;");K.nparallel=e(ab,"\\nparallel ","&#8742;");K.bowtie=e(ab,"\\bowtie ","&#8904;");K.sqsubset=e(ab,"\\sqsubset ","&#8847;");K.sqsupset=e(ab,"\\sqsupset ","&#8848;");K.smile=e(ab,"\\smile ","&#8995;");K.sqsubseteq=e(ab,"\\sqsubseteq ","&#8849;");K.sqsupseteq=e(ab,"\\sqsupseteq ","&#8850;");K.doteq=e(ab,"\\doteq ","&#8784;");K.frown=e(ab,"\\frown ","&#8994;");
K.vdash=e(ab,"\\vdash ","&#8870;");K.dashv=e(ab,"\\dashv ","&#8867;");K.longleftarrow=e(ab,"\\longleftarrow ","&#8592;");K.longrightarrow=e(ab,"\\longrightarrow ","&#8594;");K.Longleftarrow=e(ab,"\\Longleftarrow ","&#8656;");K.Longrightarrow=e(ab,"\\Longrightarrow ","&#8658;");K.longleftrightarrow=e(ab,"\\longleftrightarrow ","&#8596;");K.updownarrow=e(ab,"\\updownarrow ","&#8597;");K.Longleftrightarrow=e(ab,"\\Longleftrightarrow ","&#8660;");K.Updownarrow=e(ab,"\\Updownarrow ","&#8661;");K.mapsto=e(ab,"\\mapsto ","&#8614;");K.nearrow=e(ab,"\\nearrow ","&#8599;");K.hookleftarrow=e(ab,"\\hookleftarrow ","&#8617;");K.hookrightarrow=e(ab,"\\hookrightarrow ","&#8618;");K.searrow=e(ab,"\\searrow ","&#8600;");K.leftharpoonup=e(ab,"\\leftharpoonup ","&#8636;");K.rightharpoonup=e(ab,"\\rightharpoonup ","&#8640;");K.swarrow=e(ab,"\\swarrow ","&#8601;");K.leftharpoondown=e(ab,"\\leftharpoondown ","&#8637;");K.rightharpoondown=e(ab,"\\rightharpoondown ","&#8641;");K.nwarrow=e(ab,"\\nwarrow ","&#8598;");
K.rightleftarrows=e(ab,"\\rightleftarrows ","&#8644;");K.ldots=e(ab,"\\ldots ","&#8230;");K.cdots=e(ab,"\\cdots ","&#8943;");K.vdots=e(ab,"\\vdots ","&#8942;");K.ddots=e(ab,"\\ddots ","&#8944;");K.surd=e(ab,"\\surd ","&#8730;");K.triangle=e(ab,"\\triangle ","&#9653;");K.ell=e(ab,"\\ell ","&#8467;");K.top=e(ab,"\\top ","&#8868;");K.flat=e(ab,"\\flat ","&#9837;");K.natural=e(ab,"\\natural ","&#9838;");K.sharp=e(ab,"\\sharp ","&#9839;");K.wp=e(ab,"\\wp ","&#8472;");K.bot=e(ab,"\\bot ","&#8869;");K.clubsuit=e(ab,"\\clubsuit ","&#9827;");K.diamondsuit=e(ab,"\\diamondsuit ","&#9826;");K.heartsuit=e(ab,"\\heartsuit ","&#9825;");K.spadesuit=e(ab,"\\spadesuit ","&#9824;");K.oint=e(ab,"\\oint ","&#8750;");K.bigcap=e(ab,"\\bigcap ","&#8745;");K.bigcup=e(ab,"\\bigcup ","&#8746;");K.bigsqcup=e(ab,"\\bigsqcup ","&#8852;");K.bigvee=e(ab,"\\bigvee ","&#8744;");K.bigwedge=e(ab,"\\bigwedge ","&#8743;");K.bigodot=e(ab,"\\bigodot ","&#8857;");K.bigotimes=e(ab,"\\bigotimes ","&#8855;");K.bigoplus=e(ab,"\\bigoplus ","&#8853;");
K.biguplus=e(ab,"\\biguplus ","&#8846;");K.lfloor=e(ab,"\\lfloor ","&#8970;");K.rfloor=e(ab,"\\rfloor ","&#8971;");K.lceil=e(ab,"\\lceil ","&#8968;");K.rceil=e(ab,"\\rceil ","&#8969;");K.slash=e(ab,"\\slash ","&#47;");K.opencurlybrace=e(ab,"\\opencurlybrace ","&#123;");K.closecurlybrace=e(ab,"\\closecurlybrace ","&#125;");K.caret=e(ab,"\\caret ","^");K.underscore=e(ab,"\\underscore ","_");K.backslash=e(ab,"\\backslash ","\\");K.vert=e(ab,"|");K.perp=K.perpendicular=e(ab,"\\perp ","&perp;");K.nabla=K.del=e(ab,"\\nabla ","&nabla;");K.hbar=e(ab,"\\hbar ","&#8463;");K.AA=K.Angstrom=K.angstrom=e(ab,"\\text\\AA ","&#8491;");K.ring=K.circ=K.circle=e(ab,"\\circ ","&#8728;");K.bull=K.bullet=e(ab,"\\bullet ","&bull;");K.setminus=K.smallsetminus=e(ab,"\\setminus ","&#8726;");K.not=K["¬"]=K.neg=e(ab,"\\neg ","&not;");K["…"]=K.dots=K.ellip=K.hellip=K.ellipsis=K.hellipsis=e(ab,"\\dots ","&hellip;");K.converges=K.darr=K.dnarr=K.dnarrow=K.downarrow=e(ab,"\\downarrow ","&darr;");K.dArr=K.dnArr=K.dnArrow=K.Downarrow=e(ab,"\\Downarrow ","&dArr;");
K.diverges=K.uarr=K.uparrow=e(ab,"\\uparrow ","&uarr;");K.uArr=K.Uparrow=e(ab,"\\Uparrow ","&uArr;");K.to=e(aj,"\\to ","&rarr;");K.rarr=K.rightarrow=e(ab,"\\rightarrow ","&rarr;");K.implies=e(aj,"\\Rightarrow ","&rArr;");K.rArr=K.Rightarrow=e(ab,"\\Rightarrow ","&rArr;");K.gets=e(aj,"\\gets ","&larr;");K.larr=K.leftarrow=e(ab,"\\leftarrow ","&larr;");K.impliedby=e(aj,"\\Leftarrow ","&lArr;");K.lArr=K.Leftarrow=e(ab,"\\Leftarrow ","&lArr;");K.harr=K.lrarr=K.leftrightarrow=e(ab,"\\leftrightarrow ","&harr;");K.iff=e(aj,"\\Leftrightarrow ","&hArr;");K.hArr=K.lrArr=K.Leftrightarrow=e(ab,"\\Leftrightarrow ","&hArr;");K.Re=K.Real=K.real=e(ab,"\\Re ","&real;");K.Im=K.imag=K.image=K.imagin=K.imaginary=K.Imaginary=e(ab,"\\Im ","&image;");K.part=K.partial=e(ab,"\\partial ","&part;");K.inf=K.infin=K.infty=K.infinity=e(ab,"\\infty ","&infin;");K.alef=K.alefsym=K.aleph=K.alephsym=e(ab,"\\aleph ","&alefsym;");K.xist=K.xists=K.exist=K.exists=e(ab,"\\exists ","&exist;");K.nexists=e(ab,"\\nexists","&#8708;");
K.and=K.land=K.wedge=e(ab,"\\wedge ","&and;");K.or=K.lor=K.vee=e(ab,"\\vee ","&or;");K.empty=K.emptyset=K.oslash=K.Oslash=K.nothing=K.varnothing=e(aj,"\\varnothing ","&empty;");K.cup=K.union=e(aj,"\\cup ","&cup;");K.cap=K.intersect=K.intersection=e(aj,"\\cap ","&cap;");K.deg=K.degree=e(ab,"^\\circ ","&deg;");K.ang=K.angle=e(ab,"\\angle ","&ang;");K.mang=K.measuredangle=e(ab,"\\measuredangle ","&#8737;");var U=h(X,function(P,ap){P.init=function(aq){ap.init.call(this,"\\"+aq+" ","<span>"+aq+"</span>")};P.respace=function(){this.jQ[0].className=(this.next instanceof am||this.next instanceof B)?"":"non-italicized-function"}});K.ln=K.lg=K.log=K.span=K.proj=K.det=K.dim=K.min=K.max=K.mod=K.lcm=K.gcd=K.gcf=K.hcf=K.lim=U;(function(){var ap=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(var P in ap){K[ap[P]]=K[ap[P]+"h"]=K["a"+ap[P]]=K["arc"+ap[P]]=K["a"+ap[P]+"h"]=K["arc"+ap[P]+"h"]=U}}());var T=(function(){function aE(aH){var aI=w();aH.adopt(aI,0,0);return aI}function ax(aJ){var aI=aJ[0]||w();
for(var aH=1;aH<aJ.length;aH+=1){aJ[aH].children().adopt(aI,aI.lastChild,0)}return aI}var P=c.string;var ar=c.regex;var aG=c.letter;var ay=c.any;var aD=c.optWhitespace;var aF=c.succeed;var aw=c.fail;var az=aG.map(s);var aA=ar(/^[^${}\\_^]/).map(ab);var ap=ar(/^[^\\]/).or(P("\\").then(ar(/^[a-z]+/i).or(ar(/^\s+/).result(" ")).or(ay))).then(function(aI){var aH=K[aI];if(aH){return aH(aI).parser()}else{return aw("unknown command: \\"+aI)}});var at=ap.or(az).or(aA);var av=P("{").then(function(){return aC}).skip(P("}"));var au=aD.then(av.or(at.map(aE)));var aC=au.many().map(ax).skip(aD);var aB=P("[").then(au.then(function(aH){return aH.join("latex")!=="]"?aF(aH):aw()}).many().map(ax).skip(aD)).skip(P("]"));var aq=aC;aq.block=au;aq.optBlock=aB;return aq})();var J=h(function(ap){ap.init=function(at){this.parent=this.root=at;var au=this.jQ=this._jQ=Q('<span class="cursor">&zwj;</span>');this.blink=function(){au.toggleClass("blink")};this.upDownCache={}};ap.prev=0;ap.next=0;ap.parent=0;ap.show=function(){this.jQ=this._jQ.removeClass("blink");
if("intervalId" in this){clearInterval(this.intervalId)}else{if(this.next){if(this.selection&&this.selection.first.prev===this.prev){this.jQ.insertBefore(this.selection.jQ)}else{this.jQ.insertBefore(this.next.jQ.first())}}else{this.jQ.appendTo(this.parent.jQ)}this.parent.focus()}this.intervalId=setInterval(this.blink,500);return this};ap.hide=function(){if("intervalId" in this){clearInterval(this.intervalId)}delete this.intervalId;this.jQ.detach();this.jQ=Q();return this};ap.insertAt=function(au,av,at){var aw=this.parent;this.parent=au;this.prev=av;this.next=at;aw.blur()};ap.insertBefore=function(at){this.insertAt(at.parent,at.prev,at);this.parent.jQ.addClass("hasCursor");this.jQ.insertBefore(at.jQ.first());return this};ap.insertAfter=function(at){this.insertAt(at.parent,at,at.next);this.parent.jQ.addClass("hasCursor");this.jQ.insertAfter(at.jQ.last());return this};ap.prependTo=function(at){this.insertAt(at,0,at.firstChild);if(at.textarea){this.jQ.insertAfter(at.textarea)}else{this.jQ.prependTo(at.jQ)
}at.focus();return this};ap.appendTo=function(at){this.insertAt(at,at.lastChild,0);this.jQ.appendTo(at.jQ);at.focus();return this};ap.hopLeft=function(){this.jQ.insertBefore(this.prev.jQ.first());this.next=this.prev;this.prev=this.prev.prev;return this};ap.hopRight=function(){this.jQ.insertAfter(this.next.jQ.last());this.prev=this.next;this.next=this.next.next;return this};ap.moveLeftWithin=function(at){if(this.prev){if(this.prev.lastChild){this.appendTo(this.prev.lastChild)}else{this.hopLeft()}}else{if(this.parent===at){return}if(this.parent.prev){this.appendTo(this.parent.prev)}else{this.insertBefore(this.parent.parent)}}};ap.moveRightWithin=function(at){if(this.next){if(this.next.firstChild){this.prependTo(this.next.firstChild)}else{this.hopRight()}}else{if(this.parent===at){return}if(this.parent.next){this.prependTo(this.parent.next)}else{this.insertAfter(this.parent.parent)}}};ap.moveLeft=function(){aq(this);if(this.selection){this.insertBefore(this.selection.first).clearSelection()
}else{this.moveLeftWithin(this.root)}return this.show()};ap.moveRight=function(){aq(this);if(this.selection){this.insertAfter(this.selection.last).clearSelection()}else{this.moveRightWithin(this.root)}return this.show()};ap.moveUp=function(){return P(this,"up")};ap.moveDown=function(){return P(this,"down")};function P(at,au){if(at.next[au]){at.prependTo(at.next[au])}else{if(at.prev[au]){at.appendTo(at.prev[au])}else{var ax=at.parent;do{var ay=ax[au];if(ay){if(typeof ay==="function"){ay=ax[au](at)}if(ay===false||ay instanceof w){at.upDownCache[ax.id]={parent:at.parent,prev:at.prev,next:at.next};if(ay instanceof w){var aw=at.upDownCache[ay.id];if(aw){if(aw.next){at.insertBefore(aw.next)}else{at.appendTo(aw.parent)}}else{var av=ar(at).left;at.appendTo(ay);at.seekHoriz(av,ay)}}break}}ax=ax.parent.parent}while(ax)}}return at.clearSelection().show()}ap.seek=function(aw,au,at){aq(this);var av,ay,ax=this.clearSelection().show();if(aw.hasClass("empty")){ax.prependTo(E[aw.attr(k)]);return ax}av=E[aw.attr(F)];
if(av instanceof X){if(aw.outerWidth()>2*(au-aw.offset().left)){ax.insertBefore(av)}else{ax.insertAfter(av)}return ax}if(!av){ay=E[aw.attr(k)];if(!ay){aw=aw.parent();av=E[aw.attr(F)];if(!av){ay=E[aw.attr(k)];if(!ay){ay=ax.root}}}}if(av){ax.insertAfter(av)}else{ax.appendTo(ay)}return ax.seekHoriz(au,ax.root)};ap.seekHoriz=function(au,ax){var aw=this;var av=ar(aw).left-au;var at;do{aw.moveLeftWithin(ax);at=av;av=ar(aw).left-au}while(av>0&&(aw.prev||aw.parent!==ax));if(-av>at){aw.moveRightWithin(ax)}return aw};function ar(at){var au=at.jQ.removeClass("cursor").offset();at.jQ.addClass("cursor");return au}ap.writeLatex=function(aw){var au=this;aq(au);au.show().deleteSelection();var av=c.all;var at=c.eof;var ax=T.skip(at).or(av.result(false)).parse(aw);if(ax){ax.children().adopt(au.parent,au.prev,au.next);E.jQize(ax.join("html")).insertBefore(au.jQ);au.prev=ax.lastChild;ax.finalizeInsert();au.parent.bubble("redraw")}return this.hide()};ap.write=function(at){aq(this);return this.show().insertCh(at)
};ap.insertCh=function(at){var au;if(at.match(/^[a-eg-zA-Z]$/)){au=s(at)}else{if(au=y[at]||K[at]){au=au(at)}else{au=ab(at)}}if(this.selection){this.prev=this.selection.first.prev;this.next=this.selection.last.next;au.replaces(this.selection);delete this.selection}return this.insertNew(au)};ap.insertNew=function(at){at.createBefore(this);return this};ap.insertCmd=function(at,av){var au=K[at];if(au){au=au(at);if(av){au.replaces(av)}this.insertNew(au)}else{au=ac();au.replaces(at);au.firstChild.focus=function(){delete this.focus;return this};this.insertNew(au).insertAfter(au);if(av){av.remove()}}return this};ap.unwrapGramp=function(){var au=this.parent.parent;var at=au.parent;var av=au.next;var ax=this;var aw=au.prev;au.disown().eachChild(function(ay){if(ay.isEmpty()){return}ay.children().adopt(at,aw,av).each(function(az){az.jQ.insertBefore(au.jQ.first())});aw=ay.lastChild});if(!this.next){if(this.prev){this.next=this.prev.next}else{while(!this.next){this.parent=this.parent.next;if(this.parent){this.next=this.parent.firstChild
}else{this.next=au.next;this.parent=at;break}}}}if(this.next){this.insertBefore(this.next)}else{this.appendTo(at)}au.jQ.remove();if(au.prev){au.prev.respace()}if(au.next){au.next.respace()}};ap.backspace=function(){aq(this);this.show();if(this.deleteSelection()){}else{if(this.prev){if(this.prev.isEmpty()){this.prev=this.prev.remove().prev}else{this.selectLeft()}}else{if(this.parent!==this.root){if(this.parent.parent.isEmpty()){return this.insertAfter(this.parent.parent).backspace()}else{this.unwrapGramp()}}}}if(this.prev){this.prev.respace()}if(this.next){this.next.respace()}this.parent.bubble("redraw");return this};ap.deleteForward=function(){aq(this);this.show();if(this.deleteSelection()){}else{if(this.next){if(this.next.isEmpty()){this.next=this.next.remove().next}else{this.selectRight()}}else{if(this.parent!==this.root){if(this.parent.parent.isEmpty()){return this.insertBefore(this.parent.parent).deleteForward()}else{this.unwrapGramp()}}}}if(this.prev){this.prev.respace()}if(this.next){this.next.respace()
}this.parent.bubble("redraw");return this};ap.selectFrom=function(ax){var aB=this,av=ax;loopThroughAncestors:while(true){for(var ay=this;ay!==aB.parent.parent;ay=ay.parent.parent){if(ay.parent===av.parent){au=ay;az=av;break loopThroughAncestors}}for(var aA=ax;aA!==av.parent.parent;aA=aA.parent.parent){if(aB.parent===aA.parent){au=aB;az=aA;break loopThroughAncestors}}if(aB.parent.parent){aB=aB.parent.parent}if(av.parent.parent){av=av.parent.parent}}var au,az,at;if(au.next!==az){for(var aw=au;aw;aw=aw.next){if(aw===az.prev){at=true;break}}if(!at){at=az;az=au;au=at}}this.hide().selection=S(au.prev.next||au.parent.firstChild,az.next.prev||az.parent.lastChild);this.insertAfter(az.next.prev||az.parent.lastChild);this.root.selectionChanged()};ap.selectLeft=function(){aq(this);if(this.selection){if(this.selection.first===this.next){if(this.prev){this.hopLeft().selection.extendLeft()}else{if(this.parent!==this.root){this.insertBefore(this.parent.parent).selection.levelUp()}}}else{this.hopLeft();
if(this.selection.first===this.selection.last){this.clearSelection().show();return}this.selection.retractLeft()}}else{if(this.prev){this.hopLeft()}else{if(this.parent!==this.root){this.insertBefore(this.parent.parent)}else{return}}this.hide().selection=S(this.next)}this.root.selectionChanged()};ap.selectRight=function(){aq(this);if(this.selection){if(this.selection.last===this.prev){if(this.next){this.hopRight().selection.extendRight()}else{if(this.parent!==this.root){this.insertAfter(this.parent.parent).selection.levelUp()}}}else{this.hopRight();if(this.selection.first===this.selection.last){this.clearSelection().show();return}this.selection.retractRight()}}else{if(this.next){this.hopRight()}else{if(this.parent!==this.root){this.insertAfter(this.parent.parent)}else{return}}this.hide().selection=S(this.prev)}this.root.selectionChanged()};function aq(at){at.upDownCache={}}ap.prepareMove=function(){aq(this);return this.show().clearSelection()};ap.prepareEdit=function(){aq(this);return this.show().deleteSelection()
};ap.clearSelection=function(){if(this.selection){this.selection.clear();delete this.selection;this.root.selectionChanged()}return this};ap.deleteSelection=function(){if(!this.selection){return false}this.prev=this.selection.first.prev;this.next=this.selection.last.next;this.selection.remove();this.root.selectionChanged();return delete this.selection}});var S=h(Z,function(P,ap){P.init=function(){var aq=this;ap.init.apply(aq,arguments);aq.jQwrap(aq.jQ)};P.jQwrap=function(aq){this.jQ=aq.wrapAll('<span class="selection"></span>').parent()};P.adopt=function(){this.jQ.replaceWith(this.jQ=this.jQ.children());return ap.adopt.apply(this,arguments)};P.clear=function(){this.jQ.replaceWith(this.jQ.children());return this};P.levelUp=function(){var ar=this,aq=ar.first=ar.last=ar.last.parent.parent;ar.clear().jQwrap(aq.jQ);return ar};P.extendLeft=function(){this.first=this.first.prev;this.first.jQ.prependTo(this.jQ)};P.extendRight=function(){this.last=this.last.next;this.last.jQ.appendTo(this.jQ)};P.retractRight=function(){this.first.jQ.insertBefore(this.jQ);
this.first=this.first.next};P.retractLeft=function(){this.last.jQ.insertAfter(this.jQ);this.last=this.last.prev}});Q.fn.mathquill=function(au,at){switch(au){case"redraw":return this.each(function(){var ax=Q(this).attr(k),ay=ax&&E[ax];if(ay){(function aw(az){az.eachChild(aw);if(az.redraw){az.redraw()}}(ay))}});case"revert":return this.each(function(){var aw=Q(this).attr(k),ax=aw&&E[aw];if(ax&&ax.revert){ax.revert()}});case"latex":if(arguments.length>1){return this.each(function(){var aw=Q(this).attr(k),ax=aw&&E[aw];if(ax){ax.renderLatex(at)}})}var ap=Q(this).attr(k),av=ap&&E[ap];return av&&av.latex();case"text":var ap=Q(this).attr(k),av=ap&&E[ap];return av&&av.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span class="?cursor( blink)?"?><\/span>/i,"").replace(/<span class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(arguments.length>1){return this.each(function(){var aw=Q(this).attr(k),ay=aw&&E[aw],ax=ay&&ay.cursor;
if(ax){ax.writeLatex(at).parent.blur()}})}case"cmd":if(arguments.length>1){return this.each(function(){var aw=Q(this).attr(k),az=aw&&E[aw],ay=az&&az.cursor;if(ay){ay.show();if(/^\\[a-z]+$/i.test(at)){var ax=ay.selection;if(ax){ay.prev=ax.first.prev;ay.next=ax.last.next;delete ay.selection}ay.insertCmd(at.slice(1),ax)}else{ay.insertCh(at)}ay.hide().parent.blur()}})}default:var P=au==="textbox",aq=P||au==="editable",ar=P?V:n;return this.each(function(){af(Q(this),ar(),P,aq)})}};Q(function(){Q(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable");Q(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox");Q(".mathquill-embedded-latex").mathquill()})}());Drupal.behaviors.sTinymceMathquill=function(b){$(".s-formula-editable:not(.sTinymceMathquill-processed)",b).addClass("sTinymceMathquill-processed").each(function(){sMathquill.initMathquill(this)});var a=Popups.activePopup();if(!a||!$("#"+a.id).hasClass("tinymce-mathquill-formula-popup")){return}var c=false;
$(".submit-btn",b).click(function(h){h.preventDefault();var f=tinyMCE.activeEditor.execCommand("sContentGetRealmFromUrl");var g=sMathquill.save();if(g&&g.length&&!c){var d=Base64.encode(g);c=true;$.ajax({url:"/tinymceinsertlatex",type:"POST",dataType:"json",data:{save_formula:1,realm:f[0],realm_id:f[1],formula:g},success:function(l,e,m){c=false;if(l.error){alert(l.error)}else{var j=$(document).data("s_content_saved_formula_image");if(j){$(j).remove();tinyMCE.activeEditor.execCommand("sContentSaveLastNode")}$(document).data("s_content_saved_formula_image",null);Popups.close();var k='<img src="'+l.content_path+'" formula="'+d+'" class="mathquill-formula" />';tinyMCE.activeEditor.execCommand("sContentInsert",k,{use_native_insert:true})}}})}})};if(typeof sMathquill=="undefined"){sMathquill=(function(){var b={};b.editors=[];b.activeEditor=null;b.config={};b.menuItemList={};_newMarkup=function(c){return{type:"markup",html:c.html}};_newCommandButton=function(c){var d=typeof c.cmd=="object"?c.cmd.join(""):c.cmd;
return{type:"button",extraClass:"s-mq-btn s-mq-icon",label:d,tooltip:d.replace("\\",""),fn:function(e){e.event.preventDefault();if(typeof c.cmd=="object"){$.each(c.cmd,function(f,g){e.editor.mathquill("cmd",g)})}else{e.editor.mathquill("cmd",c.cmd)}e.editor.trigger("focus")}}};_newTextButton=function(c){return{type:"button",extraClass:"s-mq-btn s-mq-icon",label:c.text,tooltip:c.text,fn:function(d){d.event.preventDefault();d.editor.mathquill("write",c.text);d.editor.trigger("focus")}}};_newMenuToggleButton=function(c){var d="s-mq-"+c.key.replace(/_/g,"-").toLowerCase();return{type:"button",extraClass:"s-mq-btn s-mq-menu-toggle",label:c.label,tooltip:c.label,fn:function(g){var j=g.event,f=g.editor;j.preventDefault();var k=$(this);if(k.hasClass("active")){k.removeClass("active");f.siblings(".s-mq-submenu."+d).addClass("hidden")}else{k.addClass("active").siblings(".s-mq-menu-toggle").removeClass("active");var h=f.siblings(".s-mq-submenu");h.not("."+d).addClass("hidden");h.filter("."+d).removeClass("hidden")
}b.resize();f.trigger("focus")}}};_newDefaultButton=function(c){var d={type:"button",label:c.label,extraClass:"s-mq-btn"};if(typeof c.fn=="function"){d.fn=c.fn}return d};b.initMathquill=function(d,f){var c=null;if(typeof f=="undefined"){var f={}}var g={editable:true,autoHeight:false};f=$.extend(g,f);var e=$(d);if(f.editable){e.index=b.editors.length;e.menuBars=[];e.hooks={};e.opts=f;_execAllHooks("onBeforeEditorCreate",[e]);e.mathquill("editable");e.initialHeight=e.innerHeight();b.activeEditor=e;e.find("textarea").bind("focus",function(){b.activeEditor=e});if(typeof b.config.menu_bars!="undefined"){$.each(b.config.menu_bars,function(j,h){h.name=j;b.addMenuBar(h)});this.resize()}b.editors.push(e);_execAllHooks("onEditorCreate",[e])}else{e.mathquill()}return e};b.addMenuBar=function(f){var c=b.activeEditor,d=[];if(!c){return}if(typeof f=="undefined"){var f={}}var g={submenu:false,multiline:false};f=$.extend(g,f);if(typeof f.menu_items=="object"){f.menu_items=f.menu_items.join(",")}if(typeof f.menu_items=="string"){$.each(f.menu_items.split(","),function(h,j){if(new_item=b.getMenuItem(j)){d.push(new_item)
}})}var e=$("<div/>").addClass("s-mq-menu-bar");if(typeof f.name=="string"){e.addClass("s-mq-menu-"+f.name.replace(/_/g,"-").toLowerCase())}if(typeof f.submenu!="undefined"&&f.submenu){e.addClass("s-mq-submenu").addClass("hidden")}if(typeof f.multiline!="undefined"&&f.multiline){e.addClass("s-mq-menu-multiline")}if(d.length){$.each(d,function(j,k){var h=null;switch(k.type){case"button":h=b.addButtonToMenuBar(e,k);break;case"markup":e.append(k.html);break}if(!f.submenu&&h){h.addClass("s-mq-menu-item")}})}if(typeof f.extraClass=="string"){e.addClass(f.extraClass)}e.insertBefore(c);c.menuBars.push(e);return e};b.addButtonToMenuBar=function(d,g){var f=null,c=b.activeEditor;if(typeof d=="object"){if(d.hasClass("s-mq-menu-bar")){f=d}}else{if(typeof d=="number"){if(c&&typeof c.menuBars[d]=="object"){f=c.menuBars[d]}}}if(!f){return null}var h={label:"",extraClass:"",size:20,fn:function(){}};g=$.extend(h,g);var j=$("<span/>").bind("click",function(k){g.fn.apply(this,[{editor:c,event:k}])});btnLabel=$("<span/>").addClass("s-mq-label").appendTo(j);
if(g.label.length){btnLabel.text(g.label)}if(g.tooltip.length){j.attr("title",g.tooltip)}if(g.extraClass.length){j.addClass(g.extraClass)}j.addClass("s-mq-size"+g.size);if(j.hasClass("s-mq-embed")){var e=$("<span/>").text(btnLabel.text()).mathquill("editable").mathquill("html");btnLabel.html(e).addClass("mathquill-rendered-math")}else{btnLabel.html(btnLabel.text())}j.appendTo(f);if(typeof g.onAdd=="function"){g.onAdd.apply(b,[j])}return j};b.getMenuItem=function(d){var e=null,c=null;if(typeof this.menuItemList[d]=="undefined"){if(d.length){c={key:d,cmd:"\\"+d}}}else{c=this.menuItemList[d]}if(c){c.key=d;if(typeof c.html!="undefined"){e=_newMarkup(c)}else{if(typeof c.cmd!="undefined"){e=_newCommandButton(c)}else{if(typeof c.text=="string"){e=_newTextButton(c)}else{if(typeof c.menu_toggle!="undefined"){e=_newMenuToggleButton(c)}else{e=_newDefaultButton(c)}}}}if(typeof e=="object"&&e){if(typeof e.extraClass=="undefined"){e.extraClass=""}e.extraClass+=" s-mq-"+c.key.replace(/_/g,"-").toLowerCase();
if(typeof c.compile_label!="boolean"||c.compile_label){e.extraClass+=" s-mq-embed"}if(typeof c.extraClass=="string"){e.extraClass+=" "+c.extraClass}if(typeof c.tooltip!="undefined"){e.tooltip=c.tooltip}else{if(typeof e.tooltip=="undefined"){e.tooltip=typeof e.label!="undefined"?e.label:d}}if(typeof c.label!="undefined"){e.label=c.label}}}return e};b.resize=function(){var d=b.activeEditor;if(d&&typeof d.initialHeight!="undefined"&&typeof d.opts.autoHeight!="undefined"&&d.opts.autoHeight){var c=d.initialHeight;if(d.menuBars.length){$.each(d.menuBars,function(e,f){if(f.is(":visible")){c-=f.outerHeight()}});d.height(c)}}};b.exec=function(){var c;if(c=this.activeEditor){var d=Array.prototype.slice.call(arguments);return c.mathquill.apply(c,d)}return null};b.write=function(c){return b.exec("write",c)};b.cmd=function(c){return b.exec("cmd",c)};b.reset=function(){return b.exec("revert")};b.getLatex=function(){return b.exec("latex")};b.getHTML=function(){return b.exec("html")};b.save=function(){var c={latex:b.getLatex()};
_execAllHooks("onSave",[b.activeEditor,c]);return c.latex};var a={};_addHook=function(d,e,c){if(typeof a[d]=="undefined"){a[d]={}}if(typeof a[d][e]=="undefined"){a[d][e]=[c]}else{a[d][e].push(c)}};_execHooks=function(e,f,d){if(typeof a[e]=="undefined"){return}if(typeof a[e][f]=="undefined"){return}var c=a[e][f];if(typeof d=="undefined"){var d=[]}$.each(c,function(g,h){h.apply(b,d)})};_execGlobalHooks=function(d,c){_execHooks("global",d,c)};_execEditorHooks=function(e,d){var c=b.activeEditor;if(c){_execHooks("editor_"+c.index,e,d)}};_execAllHooks=function(d,c){$.each(a,function(f,e){_execHooks(f,d,c)})};b.addGlobalHook=function(d,c){_addHook("global",d,c)};b.addEditorHook=function(e,d){var c=b.activeEditor;if(c){_addHook("editor_"+c.index,e,d)}};return b})();sMathquill.config={menu_bars:{}};sMathquill.menuItemList={_line_break:{html:"<br/>"},_separator:{html:'<span class="s-mq-separator"></span>'}};(function(b){var a={main:{menu_items:["menu_operators,menu_relationships,menu_equations,menu_arrows,menu_misc,menu_greek"]},greek:{submenu:true,multiline:true,menu_items:["alpha,beta,gamma,delta,epsilon,zeta,eta,theta,iota,kappa,lambda,mu,nu,xi,omicron,pi,rho,sigma,tau,upsilon,phi,chi,psi,omega","digamma,varepsilon,varkappa,varphi,varpi,varrho,varsigma,vartheta","Gamma,Delta,Theta,Lambda,Xi,Pi,Sigma,Upsilon,Phi,Psi,Omega"]},operators:{submenu:true,multiline:true,menu_items:["equal,plus,minus,ast,cdot,times,div,pm,mp,therefore,because","bigcirc,diamond,amalg,odot,ominus,oplus,otimes,wr","union,intersect,uplus,sqcap,sqcup,wedge,vee,dagger,ddagger","lhd,rhd,bigtriangledown,bigtriangleup"]},relationships:{submenu:true,multiline:true,menu_items:["equiv,cong,neq,sim,simeq,approx,napprox,doteq,models","leq,prec,preceq,lt,ll,subset,subseteq,nsubset,nsubseteq,sqsubset,sqsubseteq,dashv,in,notin","geq,succ,succeq,gt,gg,supset,supseteq,nsupset,nsupseteq,sqsupset,sqsupseteq,vdash,ni,notni","mid,parallel,nparallel,perp,bowtie,smile,frown,propto,exists,nexists,varnothing"]},equations:{submenu:true,multiline:true,menu_items:["frac,fprime,sqrt,nthroot,supscript,subscript,curly_braces,angle_brackets,lfloor,rfloor,lceil,rceil,slash","sum,prod,coprod,limit,int,oint,binomial,vector,prime"]},arrows:{submenu:true,multiline:true,menu_items:["leftarrow,Leftarrow,rightarrow,Rightarrow,leftrightarrow,Leftrightarrow","longleftarrow,Longleftarrow,longrightarrow,Longrightarrow,longleftrightarrow,Longleftrightarrow","rightleftarrows,uparrow,Uparrow,downarrow,Downarrow,updownarrow,Updownarrow","mapsto,hookleftarrow,leftharpoonup,leftharpoondown,hookrightarrow,rightharpoonup,rightharpoondown","nearrow,searrow,swarrow,nwarrow"]},misc:{submenu:true,multiline:true,menu_items:["infty,nabla,partial,clubsuit,diamondsuit,heartsuit,spadesuit,cdots,vdots,ldots,ddots,imaginary,real","forall,reals,complex,naturals,rationals,integers,ell,sharp,flat,natural,hbar,surd,wp","angle,measuredangle,overline,overrightarrow,overleftrightarrow,triangle,top,bot,caret,underscore,backslash,vert,AA","circ,bullet,setminus,neg,dots,aleph,deg"]}};
var c={menu_greek:{menu_toggle:true,label:"\\alpha \\pi \\Delta",tooltip:Drupal.t("Greek"),extraClass:"s-mq-embed"},menu_operators:{menu_toggle:true,label:"\\pm\\times=",tooltip:Drupal.t("Operators"),extraClass:"s-mq-embed"},menu_relationships:{menu_toggle:true,label:"\\leq\\ne\\in",tooltip:Drupal.t("Relationships"),extraClass:"s-mq-embed"},menu_equations:{menu_toggle:true,compile_label:false,label:'<var class="florin">ƒ</var><span>\'</span><span class="non-leaf">{ }</span><span class="non-leaf"><span class="scaled sqrt-prefix">√</span><span class="non-leaf sqrt-stem"><var>x</var></span></span>',tooltip:Drupal.t("Equations"),extraClass:"mathquill-rendered-math"},menu_arrows:{menu_toggle:true,label:"\\Leftarrow\\updownarrow\\Rightarrow",tooltip:Drupal.t("Arrows"),extraClass:"s-mq-embed"},menu_misc:{menu_toggle:true,label:"\\infty\\angle\\partial",tooltip:Drupal.t("Miscellaneous"),extraClass:"s-mq-embed"},limit:{cmd:["\\lim","_"]},abs:{cmd:"|"},plus:{cmd:"+"},minus:{cmd:"-"},equal:{cmd:"="},omicron:{text:"o",compile_label:false},frac:{cmd:"\\frac",label:"\\frac{x}{y}"},limit:{cmd:["\\lim","_"],label:"\\lim",tooltip:Drupal.t("lim")},fprime:{cmd:["f","'"]},sqrt:{cmd:"\\sqrt",compile_label:false,label:'<span class="non-leaf"><span class="scaled sqrt-prefix">√</span><span class="non-leaf sqrt-stem"><var>x</var></span></span>',extraClass:"mathquill-rendered-math"},nthroot:{cmd:"\\nthroot",compile_label:false,label:'<sup class="nthroot non-leaf"><var>x</var></sup><span class="scaled"><span class="sqrt-prefix scaled">√</span><span class="sqrt-stem non-leaf"><var>y</var></span></span>',extraClass:"mathquill-rendered-math"},subscript:{cmd:"_",label:"x_y",tooltip:Drupal.t("subscript")},supscript:{cmd:"^",label:"x^y",tooltip:Drupal.t("superscript")},curly_braces:{cmd:"{",label:"{ }",tooltip:"{ }",compile_label:false,extraClass:"mathquill-rendered-math"},angle_brackets:{cmd:"\\langle",label:"⟨ ⟩",compile_label:false,extraClass:"mathquill-rendered-math"},binomial:{cmd:"\\binomial",compile_label:false,label:'(<span class="non-leaf"><span class="array non-leaf"><span class="s-mq-var">x</span><span class="s-mq-var">y</span></span></span>)',extraClass:"mathquill-rendered-math"},vector:{cmd:"\\vector",label:"\\vector{a} \\vector{b}{c}"},overline:{cmd:"\\overline",label:"\\overline{AB}"},overrightarrow:{cmd:"\\overrightarrow",label:"\\overrightarrow{AB}"},overleftrightarrow:{cmd:"\\overleftrightarrow",label:"\\overleftrightarrow{AB}"}};
b.config.menu_bars=$.extend(b.config.menu_bars,a);b.menuItemList=$.extend(b.menuItemList,c);b.addGlobalHook("onEditorCreate",function(d){var e=d.siblings(".s-mq-menu-main");e.children(".s-mq-menu-toggle").each(function(){var f=$(this);f.tipsy({gravity:"s",title:function(){return f.attr("original-title")}})})})}(sMathquill));(function(d){var b=5;var c=[{cmd:"\\tiny",font_size:"10px"},{cmd:"\\scriptsize",font_size:"11px"},{cmd:"\\footnotesize",font_size:"12px"},{cmd:"\\small",font_size:"14px"},{font_size:"16px"},{cmd:"\\large",font_size:"18px"},{cmd:"\\Large",font_size:"24px"},{cmd:"\\LARGE",font_size:"28px"},{cmd:"\\huge",font_size:"34px"},{cmd:"\\Huge",font_size:"40px"}];var a={};$.each(c,function(f,g){if(typeof g.cmd!="undefined"){a[g.cmd.substr(1)]=f}});var e=[];_getEditorFontSize=function(f){var g=null;if(f&&typeof f.index!="undefined"){g=e[f.index]}return g};_setEditorFontSize=function(f,g){if(f&&typeof f.index!="undefined"&&typeof c[g]!="undefined"){e[f.index]=g}};_getSizeString=function(g){var f=g.match(/\\(tiny|scriptsize|small|normalsize|large|Large|LARGE|huge|Huge)/);
if(f&&typeof a[f[1]]!="undefined"){return f[1]}return null};d.updateFontSize=function(g){var f=d.activeEditor;if(!f){return null}if(typeof c[g]!="undefined"){_setEditorFontSize(f,g);f.css("font-size",c[_getEditorFontSize(f)].font_size)}return c[_getEditorFontSize(f)]};d.increaseFontSize=function(g){var f=d.activeEditor;if(!f){return null}return d.updateFontSize(_getEditorFontSize(f)+g)};d.addGlobalHook("onBeforeEditorCreate",function(g){var h=g.text();if(h.length){var f=_getSizeString(h);if(f){g.text(h.replace("\\"+f+" ",""));_setEditorFontSize(g,a[f])}}});d.addGlobalHook("onEditorCreate",function(f){if(!_getEditorFontSize(f)){_setEditorFontSize(f,b)}f.css("font-size",c[_getEditorFontSize(f)].font_size);var g=f.siblings(".s-mq-menu-main").children(".s-mq-font-size-down, .s-mq-font-size-up");g.tipsy({gravity:"s",title:function(){return $(this).attr("original-title")}})});d.addGlobalHook("onSave",function(j,h){var f=_getEditorFontSize(j);if(typeof f!="undefined"&&typeof c[f]!="undefined"){var g=c[f];
if(typeof g.cmd!="undefined"){h.latex=g.cmd+" "+h.latex}}});d.config.menu_bars.main.menu_items.push("font_size_down,font_size_up");d.menuItemList.font_size_down={label:"A-",tooltip:Drupal.t("Decrease Font Size"),compile_label:false,fn:function(){d.increaseFontSize(-1)}};d.menuItemList.font_size_up={label:"A+",tooltip:Drupal.t("Increase Font Size"),compile_label:false,fn:function(){d.increaseFontSize(1)}}}(sMathquill));(function(b){var a=Drupal.t("Select symbols or type in LaTeX code");b.addGlobalHook("onEditorCreate",function(d){var c=d.siblings(".s-mq-menu-main").children(".s-mq-help-tip");if(c.length){c.tipsy({gravity:"s",title:function(){return a}})}});b.config.menu_bars.main.menu_items.push("_help_cluetip");b.menuItemList._help_cluetip={html:'<span class="s-mq-help-tip"><span>?</span></span>'}}(sMathquill))}jQuery.extend({createUploadIframe:function(d,b){var a="jUploadFrame"+d;if(window.ActiveXObject){var c=document.createElement('<iframe id="'+a+'" name="'+a+'" />');if(typeof b=="boolean"){c.src="javascript:false"
}else{if(typeof b=="string"){c.src=b}}}else{var c=document.createElement("iframe");c.id=a;c.name=a}c.style.position="absolute";c.style.top="-1000px";c.style.left="-1000px";document.body.appendChild(c);return c},createUploadForm:function(a,l,j){var k="jUploadForm"+a;var c="jUploadFile"+a;var b=$('<form  action="" method="POST" name="'+k+'" id="'+k+'" enctype="multipart/form-data"></form>');var g=$("#"+l);var h=$(g).clone();$(g).attr("id",c);$(g).before(h);$(g).appendTo(b);var e;for(var f in j){e=$('<input type="hidden" />');e.attr("id",f);e.attr("name",f);e.val(j[f]);e.appendTo(b)}$(b).css("position","absolute");$(b).css("top","-1200px");$(b).css("left","-1200px");$(b).appendTo("body");return b},ajaxFileUpload:function(l){l=jQuery.extend({},jQuery.ajaxSettings,l);var a=new Date().getTime();var b=jQuery.createUploadForm(a,l.fileElementId,l.data);var j=jQuery.createUploadIframe(a,l.secureuri);var h="jUploadFrame"+a;var k="jUploadForm"+a;if(l.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart")
}var c=false;var f={};if(l.global){jQuery.event.trigger("ajaxSend",[f,l])}var d=function(m){var q=document.getElementById(h);try{if(q.contentWindow){f.responseText=q.contentWindow.document.body?q.contentWindow.document.body.innerHTML:null;f.responseXML=q.contentWindow.document.XMLDocument?q.contentWindow.document.XMLDocument:q.contentWindow.document}else{if(q.contentDocument){f.responseText=q.contentDocument.document.body?q.contentDocument.document.body.innerHTML:null;f.responseXML=q.contentDocument.document.XMLDocument?q.contentDocument.document.XMLDocument:q.contentDocument.document}}}catch(p){jQuery.handleError(l,f,null,p)}if(f||m=="timeout"){c=true;var n;try{n=m!="timeout"?"success":"error";if(n!="error"){var o=jQuery.uploadHttpData(f,l.dataType);if(l.success){l.success(o,n)}if(l.global){jQuery.event.trigger("ajaxSuccess",[f,l])}}else{jQuery.handleError(l,f,n)}}catch(p){n="error";jQuery.handleError(l,f,n,p)}if(l.global){jQuery.event.trigger("ajaxComplete",[f,l])}if(l.global&&!--jQuery.active){jQuery.event.trigger("ajaxStop")
}if(l.complete){l.complete(f,n)}jQuery(q).unbind();setTimeout(function(){try{$(q).remove();$(b).remove()}catch(r){jQuery.handleError(l,f,null,r)}},100);f=null}};if(l.timeout>0){setTimeout(function(){if(!c){d("timeout")}},l.timeout)}try{var b=$("#"+k);$(b).attr("action",l.url);$(b).attr("method","POST");$(b).attr("target",h);if(b.encoding){b.encoding="multipart/form-data"}else{b.enctype="multipart/form-data"}$(b).submit()}catch(g){jQuery.handleError(l,f,null,g)}if(window.attachEvent){document.getElementById(h).attachEvent("onload",d)}else{document.getElementById(h).addEventListener("load",d,false)}return{abort:function(){}}},uploadHttpData:function(b,a){var c=!a;c=a=="xml"||c?b.responseXML:b.responseText;if(a=="script"){jQuery.globalEval(c)}if(a=="json"){c=jQuery._afuParseJSON(c)}if(a=="html"){jQuery("<div>").html(c).evalScripts()}return c},_afuParseJSON:function(c){c=String(c);if(c==""){return""}var b=c.match(/\[acup-open\](.+)\[acup-close\]/);var a=$.parseJSON(b[1]);return a}});var s_ajaxFileUpload=function(){this.uploadFormAjax=function(j,b){if(typeof j=="undefined"){j={}
}var h=($("#edit-save-documents:checked").val()!==null)?"1":"0";var g=$("#edit-encode-video:checked");var f=(g.length==0||g.is(":checked"))?"1":"0";$.extend(j,{saveDocument:h,encodeVideo:f});var e=String(window.location.pathname).split("/");switch(e){default:j.upload_realm=e[1];j.upload_realmId=e[2];break}var a={};var c={url:"/s_ajaxfileupload",secureuri:false,fileElementId:"edit-upload-file",data:j,dataType:"json",success:function(l,d){if(l.status!=0){alert(Drupal.t("There was an internal error. Please try again in a few moments."));return}var k=l.message.replace(/\\/g,"");sAfu.onUpload(k)},error:function(k,d,l){alert(Drupal.t("There was an internal error. Please try again in a few moments."))}};$.extend(a,c,b);$.ajaxFileUpload(a)};this.onUpload=function(a){}};window.sAfu=new s_ajaxFileUpload();Drupal.behaviors.sCommonTextarea=function(a){$("textarea.elastic:not(.sCommonTextarea-processed)",a).each(function(){$(this).elastic()});$("textarea.title-infield:not(.sCommonTextarea-processed)",a).each(function(){var b=$(this);
var c=b.attr("defaulttext");if(b.val()==""||b.val()==c){b.val(c).addClass("pre-fill")}b.focus(function(){if(b.val()==c){b.val("");b.removeClass("pre-fill")}}).blur(function(){if(b.val()==""){b.addClass("pre-fill");b.val(c)}});b.parents("form").submit(function(){if(b.val()==c){b.val("")}})})};(function(g){var j=Array.prototype.slice;var d=Array.prototype.splice;var f={topSpacing:0,bottomSpacing:0,className:"is-sticky",wrapperClassName:"sticky-wrapper",center:false,getWidthFrom:"",bindToBottomOf:false,widthFromWrapper:true,responsiveWidth:false,scrollCallback:null},b=g(window),e=g(document),l=[],a=b.height(),h=function(){var n=b.scrollTop(),q=b.scrollLeft(),B=e.height(),z=B-a,p=(n>z)?z-n:0;for(var u=0;u<l.length;u++){var C=l[u],A=C.stickyWrapper.offset(),o=A.top,m=A.left,x=C.topSpacingComputed(),v=o-x-p,t=n>v;if(!t){if(C.currentTop!==null){C.stickyElement.css({width:"",position:"",top:"",left:""});C.stickyElement.parent().removeClass(C.className);C.stickyElement.trigger("sticky-end",[C]);
C.currentTop=null}C.currentLeft=null}else{var w=B-C.stickyElement.outerHeight()-x-C.bottomSpacing-n-p;if(w<0){w=w+x}else{w=x}if(C.currentTop!=w){var r=null;if(C.getWidthFrom){r=g(C.getWidthFrom).width()||null}else{if(C.widthFromWrapper){r=C.stickyWrapper.width()}}if(r==null){r=C.stickyElement.width()}C.stickyElement.css("width",r).css("position","fixed").css("top",w);C.stickyElement.parent().addClass(C.className);if(C.currentTop===null){C.stickyElement.trigger("sticky-start",[C])}else{C.stickyElement.trigger("sticky-update",[C])}if(C.currentTop===x&&C.currentTop>w||C.currentTop===null&&w<x){C.stickyElement.trigger("sticky-bottom-reached",[C])}else{if(C.currentTop!==null&&w===x&&C.currentTop<w){C.stickyElement.trigger("sticky-bottom-unreached",[C])}}C.currentTop=w}var y=m-q;if(y!=C.currentLeft){C.stickyElement.css("left",m-q);C.currentLeft=y}}if(C.scrollCallback){C.scrollCallback(t)}}},k=function(){a=b.height();for(var m=0;m<l.length;m++){var n=l[m];var o=null;if(n.getWidthFrom){if(n.responsiveWidth===true){o=g(n.getWidthFrom).width()
}}else{if(n.widthFromWrapper){o=n.stickyWrapper.width()}}if(o!=null){n.stickyElement.css("width",o)}}h()},c={init:function(m){var n=g.extend({},f,m);return this.each(function(){var p=g(this);if(p.parent().hasClass(n.className)){return}var r=p.attr("id");var o=p.outerHeight();var t=r?r+"-"+f.wrapperClassName:f.wrapperClassName;var u=g("<div></div>").attr("id",t).addClass(n.wrapperClassName);p.wrapAll(u);var s=p.parent();if(n.center){s.css({width:p.outerWidth(),marginLeft:"auto",marginRight:"auto"})}if(p.css("float")=="right"){p.css({"float":"none"}).parent().css({"float":"right"})}s.css("height",o);n.stickyElement=p;n.stickyWrapper=s;n.currentTop=null;n.currentLeft=null;if(n.bindToBottomOf!==false){var q=l.length;while(q-->0){if(l[q].stickyElement.get(0)===n.bindToBottomOf.get(0)){n.bindToBottomOf=l[q];break}}if(q==-1){n.bindToBottomOf=false}}n.topSpacingComputed=function(){if(n.bindToBottomOf===false){return n.topSpacing}return n.topSpacing+n.bindToBottomOf.stickyElement.outerHeight()+n.bindToBottomOf.topSpacingComputed()
};l.push(n)})},update:h,updateHeight:function(){return g(l).each(function(){this.stickyWrapper.css("height",this.stickyElement.outerHeight())})},unstick:function(m){return this.each(function(){var q=this;var o=g(q);var n=-1;var p=l.length;while(p-->0){if(l[p].stickyElement.get(0)===q){d.call(l,p,1);n=p}}if(n!=-1){o.unwrap();o.css({width:"",position:"",top:"","float":""})}})}};if(window.addEventListener){window.addEventListener("scroll",h,false);window.addEventListener("resize",k,false)}else{if(window.attachEvent){window.attachEvent("onscroll",h);window.attachEvent("onresize",k)}}g.fn.sticky=function(m){if(c[m]){return c[m].apply(this,j.call(arguments,1))}else{if(typeof m==="object"||!m){return c.init.apply(this,arguments)}else{g.error("Method "+m+" does not exist on jQuery.sticky")}}};g.fn.unstick=function(m){if(c[m]){return c[m].apply(this,j.call(arguments,1))}else{if(typeof m==="object"||!m){return c.unstick.apply(this,arguments)}else{g.error("Method "+m+" does not exist on jQuery.sticky")
}}};g(function(){setTimeout(h,0)})})(jQuery);eval(function(h,b,j,d,g,f){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(j--){f[g(j)]=d[j]||g(j)}d=[function(a){return f[a]}];g=function(){return"\\w+"};j=1}while(j--){if(d[j]){h=h.replace(new RegExp("\\b"+g(j)+"\\b","g"),d[j])}}return h}(";(5($){$.B.1s=5(u){2(!4.G){R('1b: 2M 9 2N - 2O 2P 1t');6 4}2(S u=='5')u={T:u};3 v=4.14('1c')||1d.2Q.2R;v=(v.2S(/^([^#]+)/)||[])[1];v=v||'';u=$.1n({1e:v,H:4.14('1u')||'1Q'},u||{});3 w={};4.L('C-1R-1S',[4,u,w]);2(w.1T){R('1b: 9 1U 1o C-1R-1S L');6 4}2(u.1v&&u.1v(4,u)===I){R('1b: 9 1f 1o 1v 1V');6 4}3 a=4.1w(u.2T);2(u.J){u.O=u.J;K(3 n 1x u.J){2(u.J[n]2U 15){K(3 k 1x u.J[n])a.D({7:n,8:u.J[n][k]})}E a.D({7:n,8:u.J[n]})}}2(u.1y&&u.1y(a,4,u)===I){R('1b: 9 1f 1o 1y 1V');6 4}4.L('C-9-1W',[a,4,u,w]);2(w.1T){R('1b: 9 1U 1o C-9-1W L');6 4}3 q=$.1z(a);2(u.H.2V()=='1Q'){u.1e+=(u.1e.2W('?')>=0?'&':'?')+q;u.J=F}E u.J=q;3 x=4,V=[];2(u.2X)V.D(5(){x.1X()});2(u.2Y)V.D(5(){x.1Y()});2(!u.16&&u.17){3 y=u.T||5(){};V.D(5(a){$(u.17).2Z(a).P(y,1Z)})}E 2(u.T)V.D(u.T);u.T=5(a,b){K(3 i=0,M=V.G;i<M;i++)V[i].30(u,[a,b,x])};3 z=$('W:31',4).18();3 A=I;K(3 j=0;j<z.G;j++)2(z[j])A=Q;2(u.20||A){2(u.21)$.32(u.21,1A);E 1A()}E $.33(u);4.L('C-9-34',[4,u]);6 4;5 1A(){3 h=x[0];2($(':W[7=9]',h).G){35('36: 37 22 38 39 3a 3b \"9\".');6}3 i=$.1n({},$.23,u);3 s=$.1n(Q,{},$.1n(Q,{},$.23),i);3 j='3c'+(1B 3d().3e());3 k=$('<20 3f=\"'+j+'\" 7=\"'+j+'\" 24=\"25:26\" />');3 l=k[0];k.3g({3h:'3i',27:'-28',29:'-28'});3 m={1f:0,19:F,1g:F,3j:0,3k:'n/a',3l:5(){},2a:5(){},3m:5(){},3n:5(){4.1f=1;k.14('24','25:26')}};3 g=i.2b;2(g&&!$.1C++)$.1h.L(\"3o\");2(g)$.1h.L(\"3p\",[m,i]);2(s.2c&&s.2c(m,s)===I){s.2b&&$.1C--;6}2(m.1f)6;3 o=0;3 p=0;3 q=h.U;2(q){3 n=q.7;2(n&&!q.1i){u.O=u.O||{};u.O[n]=q.8;2(q.H==\"X\"){u.O[7+'.x']=h.Y;u.O[7+'.y']=h.Z}}}1j(5(){3 t=x.14('17'),a=x.14('1c');h.1k('17',j);2(h.2d('1u')!='2e')h.1k('1u','2e');2(h.2d('1c')!=i.1e)h.1k('1c',i.1e);2(!u.3q){x.14({3r:'2f/C-J',3s:'2f/C-J'})}2(i.1D)1j(5(){p=Q;11()},i.1D);3 b=[];2g{2(u.O)K(3 n 1x u.O)b.D($('<W H=\"3t\" 7=\"'+n+'\" 8=\"'+u.O[n]+'\" />').2h(h)[0]);k.2h('1l');l.2i?l.2i('2j',11):l.3u('2k',11,I);h.9()}3v{h.1k('1c',a);t?h.1k('17',t):x.3w('17');$(b).2l()}},10);3 r=0;5 11(){2(o++)6;l.2m?l.2m('2j',11):l.3x('2k',11,I);3 c=Q;2g{2(p)3y'1D';3 d,N;N=l.2n?l.2n.2o:l.2p?l.2p:l.2o;2((N.1l==F||N.1l.2q=='')&&!r){r=1;o--;1j(11,2r);6}m.19=N.1l?N.1l.2q:F;m.1g=N.2s?N.2s:N;m.2a=5(a){3 b={'3z-H':i.16};6 b[a]};2(i.16=='3A'||i.16=='3B'){3 f=N.1E('1F')[0];m.19=f?f.8:m.19}E 2(i.16=='2t'&&!m.1g&&m.19!=F){m.1g=2u(m.19)}d=$.3C(m,i.16)}3D(e){c=I;$.3E(i,m,'2v',e)}2(c){i.T(d,'T');2(g)$.1h.L(\"3F\",[m,i])}2(g)$.1h.L(\"3G\",[m,i]);2(g&&!--$.1C)$.1h.L(\"3H\");2(i.2w)i.2w(m,c?'T':'2v');1j(5(){k.2l();m.1g=F},2r)};5 2u(s,a){2(1d.2x){a=1B 2x('3I.3J');a.3K='I';a.3L(s)}E a=(1B 3M()).3N(s,'1G/2t');6(a&&a.2y&&a.2y.1p!='3O')?a:F}}};$.B.3P=5(c){6 4.2z().2A('9.C-1q',5(){$(4).1s(c);6 I}).P(5(){$(\":9,W:X\",4).2A('2B.C-1q',5(e){3 a=4.C;a.U=4;2(4.H=='X'){2(e.2C!=12){a.Y=e.2C;a.Z=e.3Q}E 2(S $.B.2D=='5'){3 b=$(4).2D();a.Y=e.2E-b.29;a.Z=e.2F-b.27}E{a.Y=e.2E-4.3R;a.Z=e.2F-4.3S}}1j(5(){a.U=a.Y=a.Z=F},10)})})};$.B.2z=5(){4.2G('9.C-1q');6 4.P(5(){$(\":9,W:X\",4).2G('2B.C-1q')})};$.B.1w=5(b){3 a=[];2(4.G==0)6 a;3 c=4[0];3 d=b?c.1E('*'):c.22;2(!d)6 a;K(3 i=0,M=d.G;i<M;i++){3 e=d[i];3 n=e.7;2(!n)1H;2(b&&c.U&&e.H==\"X\"){2(!e.1i&&c.U==e)a.D({7:n+'.x',8:c.Y},{7:n+'.y',8:c.Z});1H}3 v=$.18(e,Q);2(v&&v.1r==15){K(3 j=0,2H=v.G;j<2H;j++)a.D({7:n,8:v[j]})}E 2(v!==F&&S v!='12')a.D({7:n,8:v})}2(!b&&c.U){3 f=c.1E(\"W\");K(3 i=0,M=f.G;i<M;i++){3 g=f[i];3 n=g.7;2(n&&!g.1i&&g.H==\"X\"&&c.U==g)a.D({7:n+'.x',8:c.Y},{7:n+'.y',8:c.Z})}}6 a};$.B.3T=5(a){6 $.1z(4.1w(a))};$.B.3U=5(b){3 a=[];4.P(5(){3 n=4.7;2(!n)6;3 v=$.18(4,b);2(v&&v.1r==15){K(3 i=0,M=v.G;i<M;i++)a.D({7:n,8:v[i]})}E 2(v!==F&&S v!='12')a.D({7:4.7,8:v})});6 $.1z(a)};$.B.18=5(a){K(3 b=[],i=0,M=4.G;i<M;i++){3 c=4[i];3 v=$.18(c,a);2(v===F||S v=='12'||(v.1r==15&&!v.G))1H;v.1r==15?$.3V(b,v):b.D(v)}6 b};$.18=5(b,c){3 n=b.7,t=b.H,1a=b.1p.1I();2(S c=='12')c=Q;2(c&&(!n||b.1i||t=='1m'||t=='3W'||(t=='1J'||t=='1K')&&!b.1L||(t=='9'||t=='X')&&b.C&&b.C.U!=b||1a=='13'&&b.1M==-1))6 F;2(1a=='13'){3 d=b.1M;2(d<0)6 F;3 a=[],1N=b.3X;3 e=(t=='13-2I');3 f=(e?d+1:1N.G);K(3 i=(e?d:0);i<f;i++){3 g=1N[i];2(g.1t){3 v=g.8;2(!v)v=(g.1O&&g.1O['8']&&!(g.1O['8'].3Y))?g.1G:g.8;2(e)6 v;a.D(v)}}6 a}6 b.8};$.B.1Y=5(){6 4.P(5(){$('W,13,1F',4).2J()})};$.B.2J=$.B.3Z=5(){6 4.P(5(){3 t=4.H,1a=4.1p.1I();2(t=='1G'||t=='40'||1a=='1F')4.8='';E 2(t=='1J'||t=='1K')4.1L=I;E 2(1a=='13')4.1M=-1})};$.B.1X=5(){6 4.P(5(){2(S 4.1m=='5'||(S 4.1m=='41'&&!4.1m.42))4.1m()})};$.B.43=5(b){2(b==12)b=Q;6 4.P(5(){4.1i=!b})};$.B.2K=5(b){2(b==12)b=Q;6 4.P(5(){3 t=4.H;2(t=='1J'||t=='1K')4.1L=b;E 2(4.1p.1I()=='2L'){3 a=$(4).44('13');2(b&&a[0]&&a[0].H=='13-2I'){a.45('2L').2K(I)}4.1t=b}})};5 R(){2($.B.1s.46&&1d.1P&&1d.1P.R)1d.1P.R('[47.C] '+15.48.49.4a(1Z,''))}})(4b);",62,260,"||if|var|this|function|return|name|value|submit||||||||||||||||||||||||||||fn|form|push|else|null|length|type|false|data|for|trigger|max|doc|extraData|each|true|log|typeof|success|clk|callbacks|input|image|clk_x|clk_y||cb|undefined|select|attr|Array|dataType|target|a_fieldValue|responseText|tag|ajaxSubmit|action|window|url|aborted|responseXML|event|disabled|setTimeout|setAttribute|body|reset|extend|via|tagName|plugin|constructor|a_ajaxSubmit|selected|method|beforeSerialize|a_formToArray|in|beforeSubmit|param|fileUpload|new|active|timeout|getElementsByTagName|textarea|text|continue|toLowerCase|checkbox|radio|checked|selectedIndex|ops|attributes|console|GET|pre|serialize|veto|vetoed|callback|validate|a_resetForm|a_clearForm|arguments|iframe|closeKeepAlive|elements|ajaxSettings|src|about|blank|top|1000px|left|getResponseHeader|global|beforeSend|getAttribute|POST|multipart|try|appendTo|attachEvent|onload|load|remove|detachEvent|contentWindow|document|contentDocument|innerHTML|100|XMLDocument|xml|toXml|error|complete|ActiveXObject|documentElement|a_ajaxFormUnbind|bind|click|offsetX|offset|pageX|pageY|unbind|jmax|one|a_clearFields|a_selected|option|skipping|process|no|element|location|href|match|semantic|instanceof|toUpperCase|indexOf|resetForm|clearForm|html|apply|file|get|ajax|notify|alert|Error|Form|must|not|be|named|jqFormIO|Date|getTime|id|css|position|absolute|status|statusText|getAllResponseHeaders|setRequestHeader|abort|ajaxStart|ajaxSend|skipEncodingOverride|encoding|enctype|hidden|addEventListener|finally|removeAttr|removeEventListener|throw|content|json|script|httpData|catch|handleError|ajaxSuccess|ajaxComplete|ajaxStop|Microsoft|XMLDOM|async|loadXML|DOMParser|parseFromString|parsererror|a_ajaxForm|offsetY|offsetLeft|offsetTop|a_formSerialize|a_fieldSerialize|merge|button|options|specified|a_clearInputs|password|object|nodeType|a_enable|parent|find|debug|jquery|prototype|join|call|jQuery".split("|"),0,{}));
Drupal.Ajax=new Object;Drupal.Ajax.plugins={};Drupal.Ajax.firstRun=false;Drupal.Ajax.init=function(a){var c,b;if(c=$(".ajax-form:not(.AjaxProcessed)",a).addClass("AjaxProcessed")){if(!Drupal.Ajax.firstRun){Drupal.Ajax.invoke("init");Drupal.Ajax.firstRun=true}b=$('input[type="submit"]',c);b.click(function(f){var g=$(this);this.form.ajax_activator=g;var d=g.data("beforeSubmitHandler");if(typeof d==="function"){d(f)}return true});c.each(function(){this.ajax_activator=null;$(this).submit(function(){if(this.ajax_activator===null){this.ajax_activator=$(".form-submit",this)}if(this.ajax_activator.hasClass("ajax-trigger")){Drupal.Ajax.go($(this),this.ajax_activator);return false}else{return true}});return true})}return true};Drupal.Ajax.invoke=function(e,b){var d,c,a;a=true;for(d in Drupal.Ajax.plugins){c=Drupal.Ajax.plugins[d](e,b);if(c===false){a=false}}return a};Drupal.Ajax.go=function(a,e){var c,b,d;Drupal.Ajax.invoke("submit",{submitter:e});c=e.val();b=e.attr("name");d={};d[b]=c;d.drupal_ajax="1";
a.a_ajaxSubmit({extraData:d,beforeSubmit:function(f){f[f.length]={name:b,value:c};f[f.length]={name:"drupal_ajax",value:"1"};return true},dataType:"json",error:function(f,h,g){window.alert(Drupal.t("ajax.module: An unknown error has occurred."));$.post("/popups_error",{error:h,status:f.status,response:f.responseText,error_type:"ajax",});if(window.console){console.log("error",arguments)}return true},success:function(f){e.val(c);Drupal.Ajax.response(e,a,f);return true}});return false};Drupal.Ajax.message=function(a,e,d,c){var b;d.local={submitter:e,form:a};if(Drupal.Ajax.invoke("message",d)){Drupal.Ajax.writeMessage(d.local.form,d.local.submitter,c);Drupal.Ajax.invoke("afterMessage",d)}return true};Drupal.Ajax.writeMessage=function(j,b,l){var f,c,a,d,k,g,e;if(l.action==="notify"){$(".messages, .ajax-preview",j).remove();$("input, textarea").removeClass("error status warning required");if(l.type==="preview"){d=$("<div>").addClass("ajax-preview");d.html(l.messages);j.prepend(d)}else{d=$("<ul>");
k=$(".messages."+l.type,j[0]);for(f=0,c=l.messages.length;f<c;f++){a=$("#"+l.messages[f].id,j[0]);a.addClass(l.type);if(l.messages[f].required){a.addClass("required")}d.append("<li>"+l.messages[f].value+"</li>")}if(k.length===0){k=$("<div class='messages "+l.type+"'>");j.prepend(k)}k.html(d)}}else{if(l.action==="clear"){$(".messages, .ajax-preview",j).remove()}}return true};Drupal.Ajax.updater=function(b){var a,c,d;for(a=0,c=b.length;a<c;a++){d=$(b[a].selector);if(b[a].type==="html_in"){d.html(b[a].value)}else{if(b[a].type==="html_out"){d.replaceWith(b[a].value)}else{if(b[a].type==="field"){d.val(b[a].value)}else{if(b[a].type==="remove"){d.remove()}}}}}return true};Drupal.Ajax.response=function(d,a,c){var b;c.local={submitter:d,form:a};if(c.status===false){Drupal.Ajax.updater(c.updaters);Drupal.Ajax.message(a,d,c,{action:"notify",messages:c.messages_error,type:"error"})}else{if(c.preview!==null){Drupal.Ajax.updater(c.updaters);Drupal.Ajax.message(a,d,c,{action:"notify",messages:decodeURIComponent(c.preview),type:"preview"})
}else{if(c.redirect===null){if(c.messages_status.length>0){Drupal.Ajax.message(a,d,c,{action:"notify",messages:c.messages_status,type:"status"})}if(c.messages_warning.length>0){Drupal.Ajax.message(a,d,c,{action:"notify",messages:c.messages_warning,type:"warning"})}if(c.messages_status.length===0&&c.messages_warning.length===0){Drupal.Ajax.message(a,d,c,{action:"clear"})}}else{if(Drupal.Ajax.invoke("redirect",c)){Drupal.Ajax.redirect(c.redirect)}else{Drupal.Ajax.updater(c.updaters);if(c.messages_status.length===0&&c.messages_warning.length===0){Drupal.Ajax.message(a,d,c,{action:"clear"})}else{Drupal.Ajax.message(a,d,c,{action:"notify",messages:c.messages_status,type:"status"})}}}}}return true};Drupal.Ajax.redirect=function(a){window.location.href=a};Drupal.behaviors.Ajax=Drupal.Ajax.init;Drupal.behaviors.sAppLogout=function(a){$("a.logout:not(.sAppLogout-processed)").addClass("sAppLogout-processed").bind("click",function(b){$.ajax({type:"GET",url:"/apps/logout/saml",cache:false,dataType:"json",success:function(e){if(!Drupal.settings.hasOwnProperty("s_app")){Drupal.settings.s_app={};
Drupal.settings.s_app.num_assocs=e.num_associations}var d={};var c=new Popups.Popup();c.extraClass="popups-small app-logout no-buttons";if(e.num_associations>0){Popups.open(c,Drupal.t("App Logout"),e.html,d);sAppLogoutTimer("#"+$(".popups-box").attr("id"));Drupal.attachBehaviors()}else{window.location="/logout?force&ltoken="+sAppLogoutGetLogoutToken()}},error:function(c){window.location="/logout?force&ltoken="+sAppLogoutGetLogoutToken()}});return false})};function sAppLogoutSuccess(a){var b=$("tr#app-"+a);if(b.hasClass("done")){return}$(".pending",b).hide();$(".success",b).show();b.addClass("done");Drupal.settings.s_app.num_assocs--;if(Drupal.settings.s_app.num_assocs<=0){window.location="/logout?ltoken="+sAppLogoutGetLogoutToken()}}function sAppLogoutTimer(a){$("#app-logout-wrapper:not(.sAppLogout-processed)",a).addClass("sAppLogout-processed").each(function(){var c=$(this);var b=10;setTimeout(function(){$("table tr:not(.done)",c).each(function(){var d=$(this);$(".pending",d).hide();$(".error",d).show();
d.addClass("done")});$("#logout-force").show();$(".popups-box").removeClass("no-buttons");sPopupsResizeCenter()},b*1000)})}function sAppLogoutGetLogoutToken(){return Drupal.settings.s_common.hasOwnProperty("logout_token")?Drupal.settings.s_common.logout_token:""};